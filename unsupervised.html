<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Discovering Behaviors with Unsupervised Learning | Behavior Analysis with Machine Learning Using R</title>
  <meta name="description" content="Chapter 6 Discovering Behaviors with Unsupervised Learning | Behavior Analysis with Machine Learning Using R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Discovering Behaviors with Unsupervised Learning | Behavior Analysis with Machine Learning Using R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.png" />
  <meta property="og:description" content="Chapter 6 Discovering Behaviors with Unsupervised Learning | Behavior Analysis with Machine Learning Using R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Discovering Behaviors with Unsupervised Learning | Behavior Analysis with Machine Learning Using R" />
  
  <meta name="twitter:description" content="Chapter 6 Discovering Behaviors with Unsupervised Learning | Behavior Analysis with Machine Learning Using R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  <meta name="twitter:image" content="/images/cover.png" />

<meta name="author" content="Enrique Garcia Ceja" />


<meta name="date" content="2025-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="preprocessing.html"/>
<link rel="next" href="representations.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/d3/d3.min.js"></script>
<link href="libs/d3panels/d3panels.min.css" rel="stylesheet" />
<script src="libs/d3panels/d3panels.min.js"></script>
<script src="libs/qtlcharts_iplotCorr/iplotCorr.js"></script>
<script src="libs/qtlcharts_iplotCorr/iplotCorr_noscat.js"></script>
<script src="libs/iplotCorr-binding/iplotCorr.js"></script>
<link href="libs/dygraphs/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs/dygraph-combined.js"></script>
<script src="libs/dygraphs/shapes.js"></script>
<script src="libs/moment/moment.js"></script>
<script src="libs/moment-timezone/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding/dygraphs.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-178679335-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-178679335-1', { 'anonymize_ip': true });
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="#">Behavior Analysis with Machine Learning Using R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-front-cover"><i class="fa fa-check"></i>About the Front Cover</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the Author</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#new-book"><i class="fa fa-check"></i>New Book!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#supplemental-material"><i class="fa fa-check"></i>Supplemental Material</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to Behavior and Machine Learning</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what-is-behavior"><i class="fa fa-check"></i><b>1.1</b> What Is Behavior?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#what-is-machine-learning"><i class="fa fa-check"></i><b>1.2</b> What Is Machine Learning?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#taxonomy"><i class="fa fa-check"></i><b>1.3</b> Types of Machine Learning</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#terminology"><i class="fa fa-check"></i><b>1.4</b> Terminology</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#tables"><i class="fa fa-check"></i><b>1.4.1</b> Tables</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#variable-types"><i class="fa fa-check"></i><b>1.4.2</b> Variable Types</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#predictive-models"><i class="fa fa-check"></i><b>1.4.3</b> Predictive Models</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#pipeline"><i class="fa fa-check"></i><b>1.5</b> Data Analysis Pipeline</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#trainingeval"><i class="fa fa-check"></i><b>1.6</b> Evaluating Predictive Models</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#simple-classification-example"><i class="fa fa-check"></i><b>1.7</b> Simple Classification Example</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="intro.html"><a href="intro.html#k-fold-cross-validation-example"><i class="fa fa-check"></i><b>1.7.1</b> <span class="math inline">\(k\)</span>-fold Cross-validation Example</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#simple-regression-example"><i class="fa fa-check"></i><b>1.8</b> Simple Regression Example</a></li>
<li class="chapter" data-level="1.9" data-path="intro.html"><a href="intro.html#underfitting-and-overfitting"><i class="fa fa-check"></i><b>1.9</b> Underfitting and Overfitting</a></li>
<li class="chapter" data-level="1.10" data-path="intro.html"><a href="intro.html#bias-and-variance"><i class="fa fa-check"></i><b>1.10</b> Bias and Variance</a></li>
<li class="chapter" data-level="1.11" data-path="intro.html"><a href="intro.html#SummaryIntro"><i class="fa fa-check"></i><b>1.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>2</b> Predicting Behavior with Classification Models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="classification.html"><a href="classification.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>2.1</b> <em>k</em>-Nearest Neighbors</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="classification.html"><a href="classification.html#indoor-location-with-wi-fi-signals"><i class="fa fa-check"></i><b>2.1.1</b> Indoor Location with Wi-Fi Signals</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="classification.html"><a href="classification.html#performance-metrics"><i class="fa fa-check"></i><b>2.2</b> Performance Metrics</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="classification.html"><a href="classification.html#confusion-matrix"><i class="fa fa-check"></i><b>2.2.1</b> Confusion Matrix</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="classification.html"><a href="classification.html#decision-trees"><i class="fa fa-check"></i><b>2.3</b> Decision Trees</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="classification.html"><a href="classification.html#activityRecognition"><i class="fa fa-check"></i><b>2.3.1</b> Activity Recognition with Smartphones</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="classification.html"><a href="classification.html#naive-bayes"><i class="fa fa-check"></i><b>2.4</b> Naive Bayes</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="classification.html"><a href="classification.html#activity-recognition-with-naive-bayes"><i class="fa fa-check"></i><b>2.4.1</b> Activity Recognition with Naive Bayes</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="classification.html"><a href="classification.html#dynamic-time-warping"><i class="fa fa-check"></i><b>2.5</b> Dynamic Time Warping</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="classification.html"><a href="classification.html#sechandgestures"><i class="fa fa-check"></i><b>2.5.1</b> Hand Gesture Recognition</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="classification.html"><a href="classification.html#dummy-models"><i class="fa fa-check"></i><b>2.6</b> Dummy Models</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="classification.html"><a href="classification.html#most-frequent-class-classifier"><i class="fa fa-check"></i><b>2.6.1</b> Most-frequent-class Classifier</a></li>
<li class="chapter" data-level="2.6.2" data-path="classification.html"><a href="classification.html#uniform-classifier"><i class="fa fa-check"></i><b>2.6.2</b> Uniform Classifier</a></li>
<li class="chapter" data-level="2.6.3" data-path="classification.html"><a href="classification.html#frequency-based-classifier"><i class="fa fa-check"></i><b>2.6.3</b> Frequency-based Classifier</a></li>
<li class="chapter" data-level="2.6.4" data-path="classification.html"><a href="classification.html#other-dummy-classifiers"><i class="fa fa-check"></i><b>2.6.4</b> Other Dummy Classifiers</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="classification.html"><a href="classification.html#summaryClassification"><i class="fa fa-check"></i><b>2.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ensemble.html"><a href="ensemble.html"><i class="fa fa-check"></i><b>3</b> Predicting Behavior with Ensemble Learning</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ensemble.html"><a href="ensemble.html#bagging"><i class="fa fa-check"></i><b>3.1</b> Bagging</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ensemble.html"><a href="ensemble.html#activity-recognition-with-bagging"><i class="fa fa-check"></i><b>3.1.1</b> Activity Recognition with Bagging</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ensemble.html"><a href="ensemble.html#random-forest"><i class="fa fa-check"></i><b>3.2</b> Random Forest</a></li>
<li class="chapter" data-level="3.3" data-path="ensemble.html"><a href="ensemble.html#stacked-generalization"><i class="fa fa-check"></i><b>3.3</b> Stacked Generalization</a></li>
<li class="chapter" data-level="3.4" data-path="ensemble.html"><a href="ensemble.html#multiviewhometasks"><i class="fa fa-check"></i><b>3.4</b> Multi-view Stacking for Home Tasks Recognition</a></li>
<li class="chapter" data-level="3.5" data-path="ensemble.html"><a href="ensemble.html#SummaryEnsemble"><i class="fa fa-check"></i><b>3.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="edavis.html"><a href="edavis.html"><i class="fa fa-check"></i><b>4</b> Exploring and Visualizing Behavioral Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="edavis.html"><a href="edavis.html#talking-with-field-experts"><i class="fa fa-check"></i><b>4.1</b> Talking with Field Experts</a></li>
<li class="chapter" data-level="4.2" data-path="edavis.html"><a href="edavis.html#summary-statistics"><i class="fa fa-check"></i><b>4.2</b> Summary Statistics</a></li>
<li class="chapter" data-level="4.3" data-path="edavis.html"><a href="edavis.html#class-distributions"><i class="fa fa-check"></i><b>4.3</b> Class Distributions</a></li>
<li class="chapter" data-level="4.4" data-path="edavis.html"><a href="edavis.html#user-class-sparsity-matrix"><i class="fa fa-check"></i><b>4.4</b> User-class Sparsity Matrix</a></li>
<li class="chapter" data-level="4.5" data-path="edavis.html"><a href="edavis.html#boxplots"><i class="fa fa-check"></i><b>4.5</b> Boxplots</a></li>
<li class="chapter" data-level="4.6" data-path="edavis.html"><a href="edavis.html#correlation-plots"><i class="fa fa-check"></i><b>4.6</b> Correlation Plots</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="edavis.html"><a href="edavis.html#interactive-correlation-plots"><i class="fa fa-check"></i><b>4.6.1</b> Interactive Correlation Plots</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="edavis.html"><a href="edavis.html#timeseries"><i class="fa fa-check"></i><b>4.7</b> Timeseries</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="edavis.html"><a href="edavis.html#interactive-timeseries"><i class="fa fa-check"></i><b>4.7.1</b> Interactive Timeseries</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="edavis.html"><a href="edavis.html#multidimensional-scaling-mds"><i class="fa fa-check"></i><b>4.8</b> Multidimensional Scaling (MDS)</a></li>
<li class="chapter" data-level="4.9" data-path="edavis.html"><a href="edavis.html#heatmaps"><i class="fa fa-check"></i><b>4.9</b> Heatmaps</a></li>
<li class="chapter" data-level="4.10" data-path="edavis.html"><a href="edavis.html#automated-eda"><i class="fa fa-check"></i><b>4.10</b> Automated EDA</a></li>
<li class="chapter" data-level="4.11" data-path="edavis.html"><a href="edavis.html#SummaryExploratory"><i class="fa fa-check"></i><b>4.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="preprocessing.html"><a href="preprocessing.html"><i class="fa fa-check"></i><b>5</b> Preprocessing Behavioral Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="preprocessing.html"><a href="preprocessing.html#missing-values"><i class="fa fa-check"></i><b>5.1</b> Missing Values</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="preprocessing.html"><a href="preprocessing.html#imputation"><i class="fa fa-check"></i><b>5.1.1</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="preprocessing.html"><a href="preprocessing.html#smoothing"><i class="fa fa-check"></i><b>5.2</b> Smoothing</a></li>
<li class="chapter" data-level="5.3" data-path="preprocessing.html"><a href="preprocessing.html#normalization"><i class="fa fa-check"></i><b>5.3</b> Normalization</a></li>
<li class="chapter" data-level="5.4" data-path="preprocessing.html"><a href="preprocessing.html#imbalanced-classes"><i class="fa fa-check"></i><b>5.4</b> Imbalanced Classes</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="preprocessing.html"><a href="preprocessing.html#random-oversampling"><i class="fa fa-check"></i><b>5.4.1</b> Random Oversampling</a></li>
<li class="chapter" data-level="5.4.2" data-path="preprocessing.html"><a href="preprocessing.html#smote"><i class="fa fa-check"></i><b>5.4.2</b> SMOTE</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="preprocessing.html"><a href="preprocessing.html#infoinjection"><i class="fa fa-check"></i><b>5.5</b> Information Injection</a></li>
<li class="chapter" data-level="5.6" data-path="preprocessing.html"><a href="preprocessing.html#one-hot-encoding"><i class="fa fa-check"></i><b>5.6</b> One-hot Encoding</a></li>
<li class="chapter" data-level="5.7" data-path="preprocessing.html"><a href="preprocessing.html#SummaryPreprocessing"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="unsupervised.html"><a href="unsupervised.html"><i class="fa fa-check"></i><b>6</b> Discovering Behaviors with Unsupervised Learning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="unsupervised.html"><a href="unsupervised.html#k-means-clustering"><i class="fa fa-check"></i><b>6.1</b> <span class="math inline">\(k\)</span>-means Clustering</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="unsupervised.html"><a href="unsupervised.html#studentresponses"><i class="fa fa-check"></i><b>6.1.1</b> Grouping Student Responses</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="unsupervised.html"><a href="unsupervised.html#the-silhouette-index"><i class="fa fa-check"></i><b>6.2</b> The Silhouette Index</a></li>
<li class="chapter" data-level="6.3" data-path="unsupervised.html"><a href="unsupervised.html#associationrules"><i class="fa fa-check"></i><b>6.3</b> Mining Association Rules</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="unsupervised.html"><a href="unsupervised.html#finding-rules-for-criminal-behavior"><i class="fa fa-check"></i><b>6.3.1</b> Finding Rules for Criminal Behavior</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="unsupervised.html"><a href="unsupervised.html#SummaryUnsupervised"><i class="fa fa-check"></i><b>6.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="representations.html"><a href="representations.html"><i class="fa fa-check"></i><b>7</b> Encoding Behavioral Data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="representations.html"><a href="representations.html#feature-vectors"><i class="fa fa-check"></i><b>7.1</b> Feature Vectors</a></li>
<li class="chapter" data-level="7.2" data-path="representations.html"><a href="representations.html#sectimeseries"><i class="fa fa-check"></i><b>7.2</b> Timeseries</a></li>
<li class="chapter" data-level="7.3" data-path="representations.html"><a href="representations.html#transactions"><i class="fa fa-check"></i><b>7.3</b> Transactions</a></li>
<li class="chapter" data-level="7.4" data-path="representations.html"><a href="representations.html#images"><i class="fa fa-check"></i><b>7.4</b> Images</a></li>
<li class="chapter" data-level="7.5" data-path="representations.html"><a href="representations.html#recurrence-plots"><i class="fa fa-check"></i><b>7.5</b> Recurrence Plots</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="representations.html"><a href="representations.html#computing-recurrence-plots"><i class="fa fa-check"></i><b>7.5.1</b> Computing Recurrence Plots</a></li>
<li class="chapter" data-level="7.5.2" data-path="representations.html"><a href="representations.html#recurrence-plots-of-hand-gestures"><i class="fa fa-check"></i><b>7.5.2</b> Recurrence Plots of Hand Gestures</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="representations.html"><a href="representations.html#bag-of-words"><i class="fa fa-check"></i><b>7.6</b> Bag-of-Words</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="representations.html"><a href="representations.html#bow-for-complex-activities."><i class="fa fa-check"></i><b>7.6.1</b> BoW for Complex Activities.</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="representations.html"><a href="representations.html#graphs"><i class="fa fa-check"></i><b>7.7</b> Graphs</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="representations.html"><a href="representations.html#complex-activities-as-graphs"><i class="fa fa-check"></i><b>7.7.1</b> Complex Activities as Graphs</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="representations.html"><a href="representations.html#SummaryRepresentations"><i class="fa fa-check"></i><b>7.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="deeplearning.html"><a href="deeplearning.html"><i class="fa fa-check"></i><b>8</b> Predicting Behavior with Deep Learning</a>
<ul>
<li class="chapter" data-level="8.1" data-path="deeplearning.html"><a href="deeplearning.html#ann"><i class="fa fa-check"></i><b>8.1</b> Introduction to Artificial Neural Networks</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="deeplearning.html"><a href="deeplearning.html#sigmoid-and-relu-units"><i class="fa fa-check"></i><b>8.1.1</b> Sigmoid and ReLU Units</a></li>
<li class="chapter" data-level="8.1.2" data-path="deeplearning.html"><a href="deeplearning.html#assembling-units-into-layers"><i class="fa fa-check"></i><b>8.1.2</b> Assembling Units into Layers</a></li>
<li class="chapter" data-level="8.1.3" data-path="deeplearning.html"><a href="deeplearning.html#deep-neural-networks"><i class="fa fa-check"></i><b>8.1.3</b> Deep Neural Networks</a></li>
<li class="chapter" data-level="8.1.4" data-path="deeplearning.html"><a href="deeplearning.html#learning-the-parameters"><i class="fa fa-check"></i><b>8.1.4</b> Learning the Parameters</a></li>
<li class="chapter" data-level="8.1.5" data-path="deeplearning.html"><a href="deeplearning.html#parameter-learning-example-in-r"><i class="fa fa-check"></i><b>8.1.5</b> Parameter Learning Example in R</a></li>
<li class="chapter" data-level="8.1.6" data-path="deeplearning.html"><a href="deeplearning.html#stochastic-gradient-descent"><i class="fa fa-check"></i><b>8.1.6</b> Stochastic Gradient Descent</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="deeplearning.html"><a href="deeplearning.html#keras-and-tensorflow-with-r"><i class="fa fa-check"></i><b>8.2</b> Keras and TensorFlow with R</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="deeplearning.html"><a href="deeplearning.html#keras-example"><i class="fa fa-check"></i><b>8.2.1</b> Keras Example</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="deeplearning.html"><a href="deeplearning.html#classification-with-neural-networks"><i class="fa fa-check"></i><b>8.3</b> Classification with Neural Networks</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="deeplearning.html"><a href="deeplearning.html#classification-of-electromyography-signals"><i class="fa fa-check"></i><b>8.3.1</b> Classification of Electromyography Signals</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="deeplearning.html"><a href="deeplearning.html#overfitting"><i class="fa fa-check"></i><b>8.4</b> Overfitting</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="deeplearning.html"><a href="deeplearning.html#early-stopping"><i class="fa fa-check"></i><b>8.4.1</b> Early Stopping</a></li>
<li class="chapter" data-level="8.4.2" data-path="deeplearning.html"><a href="deeplearning.html#dropout"><i class="fa fa-check"></i><b>8.4.2</b> Dropout</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="deeplearning.html"><a href="deeplearning.html#fine-tuning-a-neural-network"><i class="fa fa-check"></i><b>8.5</b> Fine-tuning a Neural Network</a></li>
<li class="chapter" data-level="8.6" data-path="deeplearning.html"><a href="deeplearning.html#cnns"><i class="fa fa-check"></i><b>8.6</b> Convolutional Neural Networks</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="deeplearning.html"><a href="deeplearning.html#convolutions"><i class="fa fa-check"></i><b>8.6.1</b> Convolutions</a></li>
<li class="chapter" data-level="8.6.2" data-path="deeplearning.html"><a href="deeplearning.html#pooling-operations"><i class="fa fa-check"></i><b>8.6.2</b> Pooling Operations</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="deeplearning.html"><a href="deeplearning.html#cnns-with-keras"><i class="fa fa-check"></i><b>8.7</b> CNNs with Keras</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="deeplearning.html"><a href="deeplearning.html#example-1"><i class="fa fa-check"></i><b>8.7.1</b> Example 1</a></li>
<li class="chapter" data-level="8.7.2" data-path="deeplearning.html"><a href="deeplearning.html#example-2"><i class="fa fa-check"></i><b>8.7.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="deeplearning.html"><a href="deeplearning.html#cnnSmile"><i class="fa fa-check"></i><b>8.8</b> Smiles Detection with a CNN</a></li>
<li class="chapter" data-level="8.9" data-path="deeplearning.html"><a href="deeplearning.html#SummaryDeepLearning"><i class="fa fa-check"></i><b>8.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multiuser.html"><a href="multiuser.html"><i class="fa fa-check"></i><b>9</b> Multi-user Validation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="multiuser.html"><a href="multiuser.html#mixed-models"><i class="fa fa-check"></i><b>9.1</b> Mixed Models</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="multiuser.html"><a href="multiuser.html#skeleton-action-recognition-with-mixed-models"><i class="fa fa-check"></i><b>9.1.1</b> Skeleton Action Recognition with Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="multiuser.html"><a href="multiuser.html#user-independent-models"><i class="fa fa-check"></i><b>9.2</b> User-independent Models</a></li>
<li class="chapter" data-level="9.3" data-path="multiuser.html"><a href="multiuser.html#user-dependent-models"><i class="fa fa-check"></i><b>9.3</b> User-dependent Models</a></li>
<li class="chapter" data-level="9.4" data-path="multiuser.html"><a href="multiuser.html#user-adaptive-models"><i class="fa fa-check"></i><b>9.4</b> User-adaptive Models</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="multiuser.html"><a href="multiuser.html#transfer-learning"><i class="fa fa-check"></i><b>9.4.1</b> Transfer Learning</a></li>
<li class="chapter" data-level="9.4.2" data-path="multiuser.html"><a href="multiuser.html#a-user-adaptive-model-for-activity-recognition"><i class="fa fa-check"></i><b>9.4.2</b> A User-adaptive Model for Activity Recognition</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="multiuser.html"><a href="multiuser.html#SummaryMultiUser"><i class="fa fa-check"></i><b>9.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="abnormalbehaviors.html"><a href="abnormalbehaviors.html"><i class="fa fa-check"></i><b>10</b> Detecting Abnormal Behaviors</a>
<ul>
<li class="chapter" data-level="10.1" data-path="abnormalbehaviors.html"><a href="abnormalbehaviors.html#isolation-forests"><i class="fa fa-check"></i><b>10.1</b> Isolation Forests</a></li>
<li class="chapter" data-level="10.2" data-path="abnormalbehaviors.html"><a href="abnormalbehaviors.html#detecting-abnormal-fish-behaviors"><i class="fa fa-check"></i><b>10.2</b> Detecting Abnormal Fish Behaviors</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="abnormalbehaviors.html"><a href="abnormalbehaviors.html#exploring-and-visualizing-trajectories"><i class="fa fa-check"></i><b>10.2.1</b> Exploring and Visualizing Trajectories</a></li>
<li class="chapter" data-level="10.2.2" data-path="abnormalbehaviors.html"><a href="abnormalbehaviors.html#preprocessing-and-feature-extraction"><i class="fa fa-check"></i><b>10.2.2</b> Preprocessing and Feature Extraction</a></li>
<li class="chapter" data-level="10.2.3" data-path="abnormalbehaviors.html"><a href="abnormalbehaviors.html#training-the-model"><i class="fa fa-check"></i><b>10.2.3</b> Training the Model</a></li>
<li class="chapter" data-level="10.2.4" data-path="abnormalbehaviors.html"><a href="abnormalbehaviors.html#roc-curve-and-auc"><i class="fa fa-check"></i><b>10.2.4</b> ROC Curve and AUC</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="abnormalbehaviors.html"><a href="abnormalbehaviors.html#autoencoders"><i class="fa fa-check"></i><b>10.3</b> Autoencoders</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="abnormalbehaviors.html"><a href="abnormalbehaviors.html#autoencoders-for-anomaly-detection"><i class="fa fa-check"></i><b>10.3.1</b> Autoencoders for Anomaly Detection</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="abnormalbehaviors.html"><a href="abnormalbehaviors.html#SummaryAnomalyDetection"><i class="fa fa-check"></i><b>10.4</b> Summary</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendixInstall.html"><a href="appendixInstall.html"><i class="fa fa-check"></i><b>A</b> Setup Your Environment</a>
<ul>
<li class="chapter" data-level="A.1" data-path="appendixInstall.html"><a href="appendixInstall.html#installing-the-datasets"><i class="fa fa-check"></i><b>A.1</b> Installing the Datasets</a></li>
<li class="chapter" data-level="A.2" data-path="appendixInstall.html"><a href="appendixInstall.html#installing-the-examples-source-code"><i class="fa fa-check"></i><b>A.2</b> Installing the Examples Source Code</a></li>
<li class="chapter" data-level="A.3" data-path="appendixInstall.html"><a href="appendixInstall.html#running-shiny-apps"><i class="fa fa-check"></i><b>A.3</b> Running Shiny Apps</a></li>
<li class="chapter" data-level="A.4" data-path="appendixInstall.html"><a href="appendixInstall.html#installing-keras-and-tensorflow"><i class="fa fa-check"></i><b>A.4</b> Installing Keras and TensorFlow</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendixDatasets.html"><a href="appendixDatasets.html"><i class="fa fa-check"></i><b>B</b> Datasets</a>
<ul>
<li class="chapter" data-level="B.1" data-path="appendixDatasets.html"><a href="appendixDatasets.html#complex-activities"><i class="fa fa-check"></i><b>B.1</b> COMPLEX ACTIVITIES</a></li>
<li class="chapter" data-level="B.2" data-path="appendixDatasets.html"><a href="appendixDatasets.html#depresjon"><i class="fa fa-check"></i><b>B.2</b> DEPRESJON</a></li>
<li class="chapter" data-level="B.3" data-path="appendixDatasets.html"><a href="appendixDatasets.html#electromyography"><i class="fa fa-check"></i><b>B.3</b> ELECTROMYOGRAPHY</a></li>
<li class="chapter" data-level="B.4" data-path="appendixDatasets.html"><a href="appendixDatasets.html#fish-trajectories"><i class="fa fa-check"></i><b>B.4</b> FISH TRAJECTORIES</a></li>
<li class="chapter" data-level="B.5" data-path="appendixDatasets.html"><a href="appendixDatasets.html#hand-gestures"><i class="fa fa-check"></i><b>B.5</b> HAND GESTURES</a></li>
<li class="chapter" data-level="B.6" data-path="appendixDatasets.html"><a href="appendixDatasets.html#home-tasks"><i class="fa fa-check"></i><b>B.6</b> HOME TASKS</a></li>
<li class="chapter" data-level="B.7" data-path="appendixDatasets.html"><a href="appendixDatasets.html#homicide-reports"><i class="fa fa-check"></i><b>B.7</b> HOMICIDE REPORTS</a></li>
<li class="chapter" data-level="B.8" data-path="appendixDatasets.html"><a href="appendixDatasets.html#indoor-location"><i class="fa fa-check"></i><b>B.8</b> INDOOR LOCATION</a></li>
<li class="chapter" data-level="B.9" data-path="appendixDatasets.html"><a href="appendixDatasets.html#sheep-goats"><i class="fa fa-check"></i><b>B.9</b> SHEEP GOATS</a></li>
<li class="chapter" data-level="B.10" data-path="appendixDatasets.html"><a href="appendixDatasets.html#skeleton-actions"><i class="fa fa-check"></i><b>B.10</b> SKELETON ACTIONS</a></li>
<li class="chapter" data-level="B.11" data-path="appendixDatasets.html"><a href="appendixDatasets.html#smartphone-activities"><i class="fa fa-check"></i><b>B.11</b> SMARTPHONE ACTIVITIES</a></li>
<li class="chapter" data-level="B.12" data-path="appendixDatasets.html"><a href="appendixDatasets.html#smiles"><i class="fa fa-check"></i><b>B.12</b> SMILES</a></li>
<li class="chapter" data-level="B.13" data-path="appendixDatasets.html"><a href="appendixDatasets.html#students-mental-health"><i class="fa fa-check"></i><b>B.13</b> STUDENTS’ MENTAL HEALTH</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="citing-this-book.html"><a href="citing-this-book.html"><i class="fa fa-check"></i>Citing this Book</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Behavior Analysis with Machine Learning Using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="unsupervised" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Discovering Behaviors with Unsupervised Learning<a href="unsupervised.html#unsupervised" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>So far, we have been working with supervised learning methods, that is, models for which the training instances have two elements: (1) a set of input values (features) and (2) the expected output (label). As mentioned in chapter <a href="intro.html#intro">1</a>, there are other types of machine learning methods and one of those is <strong>unsupervised learning</strong> which is the topic of this chapter. In unsupervised learning, the training instances do not have a response variable (e.g., a label). Thus, the objective is to extract knowledge from the available data without any type of guidance (supervision). For example, given a set of variables that characterize a person, we would like to find groups of people with similar behaviors. For physical activity behaviors, this could be done by finding groups of very active people versus finding groups of people with low physical activity. Those groups can be useful for delivering targeted suggestions or services thus, enhancing and personalizing the user experience.</p>
<p>This chapter starts with one of the most popular unsupervised learning algorithms: <strong><span class="math inline">\(k\)</span>-means clustering</strong>. Next, an example of how this technique can be applied to find groups of students with similar characteristics is presented. Then, <strong>association rules mining</strong> is presented, which is another type of unsupervised learning method. Finally, association rules are used to find criminal patterns from a homicide database.</p>
<div id="k-means-clustering" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> <span class="math inline">\(k\)</span>-means Clustering<a href="unsupervised.html#k-means-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div class="rmdfolder">
<code>kmeans_steps.R</code>
</div>
<p>This is one of the most commonly used unsupervised methods due to its simplicity and efficacy. Its objective is to find groups of points such that points in the same group are similar and points from different groups are as dissimilar as possible. The number of groups <span class="math inline">\(k\)</span> needs to be defined a priori. The method is based on computing distances to <strong>centroids</strong>. The centroid of a set of points is computed by taking the mean of each of their features. The <span class="math inline">\(k\)</span>-means algorithm is as follows:</p>
<pre class="text"><code>Generate k centroids at random.
  Repeat until no change or max iterations:
      Assign each data point to the closest centroid.
      Update centroids.</code></pre>
<p>To measure the distance between a data point and a centroid, the Euclidean distance is typically used, but other distances can be used as well depending on the application. As an example, let’s cluster user responses from the <em>STUDENTS’ MENTAL HEALTH</em> dataset. This database contains questionnaire responses about depression, acculturative stress, social connectedness, and help-seeking behaviors from students at a University in Japan. To demonstrate how <span class="math inline">\(k\)</span>-means work, we will only choose two variables so we can plot the results. The variables are <em>ToAS</em> (Total Acculturative Stress) and <em>ToSC</em> (Total Social Connectedness). The <em>ToAS</em> measures the emotional challenges when adapting to a new culture while <em>ToSC</em> measures emotional distance with oneself and other people. For the clustering, the parameter <span class="math inline">\(k\)</span> will be set to <span class="math inline">\(3\)</span>, that is, we want to group the points into <span class="math inline">\(3\)</span> disjoint groups. The code that implements the <span class="math inline">\(k\)</span>-means algorithm can be found in the script <code>kmeans_steps.R</code>. The algorithm begins by selecting <span class="math inline">\(3\)</span> centroids at random. Figure <a href="unsupervised.html#fig:clustIt0">6.1</a> shows a scatterplot of the variables <em>ToAS</em> and <em>ToSC</em> along with the random centroids.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:clustIt0"></span>
<img src="images/clust_it0.png" alt="Three centroids chosen randomly. " width="90%" />
<p class="caption">
FIGURE 6.1: Three centroids chosen randomly.
</p>
</div>
<p>Next, at the first iteration, each point is assigned to the closest centroid. This is depicted in Figure <a href="unsupervised.html#fig:clustIts">6.2</a> (top left). Then, the centroids are updated (moved) based on the new assignments. In the next iteration, the points are reassigned to the closest centroids and so on. Figure <a href="unsupervised.html#fig:clustIts">6.2</a> shows the first <span class="math inline">\(4\)</span> iterations of the algorithm.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:clustIts"></span>
<img src="images/clust_its.png" alt="First \(4\) iterations of \(k\)-means." width="100%" />
<p class="caption">
FIGURE 6.2: First <span class="math inline">\(4\)</span> iterations of <span class="math inline">\(k\)</span>-means.
</p>
</div>
<p>From iteration <span class="math inline">\(1\)</span> to <span class="math inline">\(2\)</span> the centroids moved considerably. After that, they began to stabilize. Formally, the algorithm tries to minimize the total within cluster variation of all clusters. The cluster variation of a single cluster <span class="math inline">\(C_k\)</span> is defined as:</p>
<p><span class="math display" id="eq:wcv">\[\begin{equation}
  W(C_k) = \sum_{x_i \in C_k}{(x_i - \mu_k)^2}
  \tag{6.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(x_i\)</span> is a data point and <span class="math inline">\(\mu_k\)</span> is the centroid of cluster <span class="math inline">\(C_k\)</span>. Thus, the total within cluster variation <span class="math inline">\(TWCV\)</span> is:</p>
<p><span class="math display" id="eq:twcv">\[\begin{equation}
  TWCV = \sum_{i=1}^k{W(C_i)}
  \tag{6.2}
\end{equation}\]</span></p>
<p>that is, the sum of all within-cluster variations across all clusters. The objective is to find the <span class="math inline">\(\mu_k\)</span> centroids that make <span class="math inline">\(TWCV\)</span> minimal. Finding the global optimum is a difficult problem. However, the iterative algorithm described above often produces good approximations.</p>
<div id="studentresponses" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Grouping Student Responses<a href="unsupervised.html#studentresponses" class="anchor-section" aria-label="Anchor link to header"></a></h3>

<div class="rmdfolder">
<code>group_students.R</code>
</div>
<p>In the previous example, we only used two variables to perform the clustering. Let’s now use more variables from the <em>STUDENTS’ MENTAL HEALTH</em> dataset to find groups. The full code can be found in <code>group_students.R</code>. After removing missing values, one-hot encoding categorical variables, and some additional cleaning, the following <span class="math inline">\(10\)</span> variables were selected:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="unsupervised.html#cb122-1" tabindex="-1"></a><span class="co"># Select which variables are going to be used for clustering.</span></span>
<span id="cb122-2"><a href="unsupervised.html#cb122-2" tabindex="-1"></a>selvars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Stay&quot;</span>,<span class="st">&quot;English_cate&quot;</span>,<span class="st">&quot;Intimate&quot;</span></span>
<span id="cb122-3"><a href="unsupervised.html#cb122-3" tabindex="-1"></a>             ,<span class="st">&quot;APD&quot;</span>,<span class="st">&quot;AHome&quot;</span>,<span class="st">&quot;APH&quot;</span>,<span class="st">&quot;Afear&quot;</span>,</span>
<span id="cb122-4"><a href="unsupervised.html#cb122-4" tabindex="-1"></a>             <span class="st">&quot;ACS&quot;</span>,<span class="st">&quot;AGuilt&quot;</span>,<span class="st">&quot;ToAS&quot;</span>)</span></code></pre></div>
<p>Additionally, it is advisable to normalize the data between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> since we are dealing with distance computations and we want to put the same weight on each variable. To plot the <span class="math inline">\(10\)</span> variables, we can use <strong>MDS</strong> (described in chapter <a href="edavis.html#edavis">4</a>) to project the data into <span class="math inline">\(2\)</span> dimensions (Figure <a href="unsupervised.html#fig:cluster1">6.3</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cluster1"></span>
<img src="images/cluster1.png" alt="Students responses projected into 2D with MDS." width="90%" />
<p class="caption">
FIGURE 6.3: Students responses projected into 2D with MDS.
</p>
</div>
<p>Visually, it seems that there are <span class="math inline">\(4\)</span> distinct groups of points. Based on this initial guess, we can set <span class="math inline">\(k=4\)</span> and use the <code>kmeans()</code> function included in base R to find the groups automatically.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="unsupervised.html#cb123-1" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(normdf, <span class="dv">4</span>)</span></code></pre></div>
<p>The first argument of <code>kmeans()</code> is a data frame or a matrix and the second argument the number of clusters. Figure <a href="unsupervised.html#fig:cluster2">6.4</a> shows the resulting clustering. The <code>kmeans()</code> method returns an object that contains several components including <code>cluster</code> that stores the assigned cluster for each data point and <code>centers</code> that stores the centroids.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cluster2"></span>
<img src="images/cluster2.png" alt="Students responses groups when \(k=4\)." width="90%" />
<p class="caption">
FIGURE 6.4: Students responses groups when <span class="math inline">\(k=4\)</span>.
</p>
</div>
<p>The <span class="math inline">\(k\)</span>-means algorithm found the same clusters as we would intuitively expect. We can check how different the groups are by inspecting some of the variables. For example, by plotting a boxplot of the <em>Intimate</em> variable (Figure <a href="unsupervised.html#fig:intyes">6.5</a>). This variable is <span class="math inline">\(1\)</span> if the student has an intimate partner or <span class="math inline">\(0\)</span> otherwise. Since there are only two possible values the boxplot looks flat. This shows that <em>cluster_1</em> and <em>cluster_3</em> are different from <em>cluster_2</em> and <em>cluster_4</em>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:intyes"></span>
<img src="images/bp_intimate.png" alt="Boxplot of Intimate variable." width="90%" />
<p class="caption">
FIGURE 6.5: Boxplot of Intimate variable.
</p>
</div>
<p>Additionally, let’s plot the <em>ACS</em> variable which represents the total score of culture shock (see Figure <a href="unsupervised.html#fig:bpacs">6.6</a>). This one has a minimum value of <span class="math inline">\(3\)</span> and a max value of <span class="math inline">\(13\)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:bpacs"></span>
<img src="images/bp_ACS.png" alt="Boxplot of ACS variable." width="90%" />
<p class="caption">
FIGURE 6.6: Boxplot of ACS variable.
</p>
</div>
<p><em>cluster_2</em> and <em>cluster_4</em> were similar based on the <em>Intimate</em> variable, but if we take a look at the difference in medians based on <em>ACS</em>, <em>cluster_2</em> and <em>cluster_4</em> are the most dissimilar clusters which gives an intuitive idea of why those two clusters were split into two different ones by the algorithm.</p>
<p>So far, the number of groups <span class="math inline">\(k\)</span> has been chosen arbitrarily or by visual inspection. But, <em>is there an automatic way to select the best k?</em> As always… this depends on the task at hand but there is a method called <strong>Silhouette index</strong> that can be used to select the optimal <span class="math inline">\(k\)</span> based on an optimality criterion. This index is presented in the next section.</p>
</div>
</div>
<div id="the-silhouette-index" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> The Silhouette Index<a href="unsupervised.html#the-silhouette-index" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As opposed to supervised learning, in unsupervised learning there is <strong>no ground truth</strong> to validate the results. In clustering, one way to validate the resulting groups is to plot them and manually explore the clusters’ data points and look for similarities and/or differences. But sometimes we may also want to automate the process and have a quantitative way to measure how well the clustering algorithm grouped the points with the given set of parameters. If we had such a method we could do parameter optimization, for example, to find the best <span class="math inline">\(k\)</span>. Well, there is something called <em>the silhouette index</em> <span class="citation">(<a href="#ref-rousseeuw1987">Rousseeuw 1987</a>)</span> and it can be used to measure the correctness of the clusters.</p>
<p>This index is computed for each data point and tells us how well they are clustered. The total silhouette index is the mean of all points’ indices and gives us an idea of how well the points were clustered overall. This index goes from <span class="math inline">\(-1\)</span> to <span class="math inline">\(1\)</span> and I’ll explain in a moment how to interpret it, but first let’s see how it is computed.</p>
<p>To compute the silhouette index two things are needed: the already created groups and the distances between points. Let:</p>
<p><span class="math inline">\(a(i)=\)</span> average dissimilarity (distance) of point <span class="math inline">\(i\)</span> to all other points in <span class="math inline">\(A\)</span>, where <span class="math inline">\(A\)</span> is the cluster to which <span class="math inline">\(i\)</span> has been assigned to (Figure <a href="unsupervised.html#fig:3clust">6.7</a>).</p>
<p><span class="math inline">\(d(i,C)=\)</span> average dissimilarity between <span class="math inline">\(i\)</span> and all points in some cluster <span class="math inline">\(C\)</span>.</p>
<p><span class="math inline">\(b(i)=\min_{C \neq A}d(i,C)\)</span>. The cluster <span class="math inline">\(B\)</span> for which the minimum is obtained is the neighbor of point <span class="math inline">\(i\)</span>. (The second best choice for <span class="math inline">\(i\)</span>).</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:3clust"></span>
<img src="images/3clusters.png" alt="Three resulting clusters: A, B, and C. (Reprinted from Journal of computational and applied mathematics Vol. 20, Rousseeuw, P. J., “Silhouettes: a graphical aid to the interpretation and validation of cluster analysis” pp. 53-65, Copyright 1987, with permission from Elsevier. doi:https://doi.org/10.1016/0377-0427(87)90125-7)." width="80%" />
<p class="caption">
FIGURE 6.7: Three resulting clusters: A, B, and C. (Reprinted from <em>Journal of computational and applied mathematics</em> Vol. 20, Rousseeuw, P. J., “Silhouettes: a graphical aid to the interpretation and validation of cluster analysis” pp. 53-65, Copyright 1987, with permission from Elsevier. <a href="doi:https://doi.org/10.1016/0377-0427(87)90125-7" class="uri">doi:https://doi.org/10.1016/0377-0427(87)90125-7</a>).
</p>
</div>
<p>Thus, <span class="math inline">\(s(i)\)</span> (the silhouette index of point <span class="math inline">\(i\)</span>) is obtained with the formula:</p>
<p><span class="math display" id="eq:silindex">\[\begin{equation}
s(i) = \frac{{b(i) - a(i)}}{{\max \{ a(i),b(i)\} }}
\tag{6.3}
\end{equation}\]</span></p>
<p>When <span class="math inline">\(s(i)\)</span> is close to <span class="math inline">\(1\)</span>, it means that the <em>within</em> dissimilarity <span class="math inline">\(a(i)\)</span> is much smaller than the smallest <em>between</em> dissimilarity <span class="math inline">\(b(i)\)</span> thus, <span class="math inline">\(i\)</span> can be considered to be well clustered. When <span class="math inline">\(s(i)\)</span> is close to <span class="math inline">\(0\)</span> it is not clear whether <span class="math inline">\(i\)</span> belongs to <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span>. When <span class="math inline">\(s(i)\)</span> is close to <span class="math inline">\(-1\)</span>, <span class="math inline">\(a(i)\)</span> is larger than <span class="math inline">\(b(i)\)</span> meaning that <span class="math inline">\(i\)</span> may have been misgrouped. The total silhouette index <span class="math inline">\(S\)</span> is the average of all indices <span class="math inline">\(s(i)\)</span> of all points.</p>
<p>In R, the <code>cluster</code> package has the function <code>silhouette()</code> that computes the silhouette index. The following code snippet clusters the student responses into <span class="math inline">\(4\)</span> groups and computes the index of each point with the <code>silhouette()</code> function. Its first argument is the cluster assignments as returned by <code>kmeans()</code>, and the second argument is a <code>dist</code> object that contains the distances between each pair of points. We can compute this information from our data frame with the <code>dist()</code> function. The <code>silhouette()</code> function returns an object with the silhouette index of each data point. We can compute the total index by taking the average which in this case was <span class="math inline">\(0.346\)</span>.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="unsupervised.html#cb124-1" tabindex="-1"></a><span class="fu">library</span>(cluster) <span class="co"># Load the required package.</span></span>
<span id="cb124-2"><a href="unsupervised.html#cb124-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb124-3"><a href="unsupervised.html#cb124-3" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(normdf, <span class="dv">4</span>) <span class="co"># Try with k=4</span></span>
<span id="cb124-4"><a href="unsupervised.html#cb124-4" tabindex="-1"></a></span>
<span id="cb124-5"><a href="unsupervised.html#cb124-5" tabindex="-1"></a><span class="co"># Compute silhouette indices for all points.</span></span>
<span id="cb124-6"><a href="unsupervised.html#cb124-6" tabindex="-1"></a>si <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(clusters<span class="sc">$</span>cluster, <span class="fu">dist</span>(normdf))</span>
<span id="cb124-7"><a href="unsupervised.html#cb124-7" tabindex="-1"></a></span>
<span id="cb124-8"><a href="unsupervised.html#cb124-8" tabindex="-1"></a><span class="co"># Print first rows.</span></span>
<span id="cb124-9"><a href="unsupervised.html#cb124-9" tabindex="-1"></a><span class="fu">head</span>(si)</span>
<span id="cb124-10"><a href="unsupervised.html#cb124-10" tabindex="-1"></a><span class="co">#&gt;      cluster neighbor sil_width</span></span>
<span id="cb124-11"><a href="unsupervised.html#cb124-11" tabindex="-1"></a><span class="co">#&gt; [1,]       1        4 0.3482364</span></span>
<span id="cb124-12"><a href="unsupervised.html#cb124-12" tabindex="-1"></a><span class="co">#&gt; [2,]       2        4 0.3718735</span></span>
<span id="cb124-13"><a href="unsupervised.html#cb124-13" tabindex="-1"></a><span class="co">#&gt; [3,]       3        1 0.3322198</span></span>
<span id="cb124-14"><a href="unsupervised.html#cb124-14" tabindex="-1"></a><span class="co">#&gt; [4,]       1        4 0.3998996</span></span>
<span id="cb124-15"><a href="unsupervised.html#cb124-15" tabindex="-1"></a><span class="co">#&gt; [5,]       1        4 0.3662811</span></span>
<span id="cb124-16"><a href="unsupervised.html#cb124-16" tabindex="-1"></a><span class="co">#&gt; [6,]       3        1 0.1463607</span></span>
<span id="cb124-17"><a href="unsupervised.html#cb124-17" tabindex="-1"></a></span>
<span id="cb124-18"><a href="unsupervised.html#cb124-18" tabindex="-1"></a><span class="co"># Compute total Silhouette index by averaging the individual indices.</span></span>
<span id="cb124-19"><a href="unsupervised.html#cb124-19" tabindex="-1"></a><span class="fu">mean</span>(si[,<span class="dv">3</span>])</span>
<span id="cb124-20"><a href="unsupervised.html#cb124-20" tabindex="-1"></a><span class="co"># [1] 0.3466427</span></span></code></pre></div>
<p>One nice thing about this index is that it can be presented visually. To generate a silhouette plot, use the generic <code>plot()</code> function and pass the object returned by <code>silhouette()</code>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="unsupervised.html#cb125-1" tabindex="-1"></a><span class="fu">plot</span>(si, <span class="at">cex.names=</span><span class="fl">0.6</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb125-2"><a href="unsupervised.html#cb125-2" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Silhouette plot, k=4&quot;</span>,</span>
<span id="cb125-3"><a href="unsupervised.html#cb125-3" tabindex="-1"></a>     <span class="at">border=</span><span class="cn">NA</span>)</span></code></pre></div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:si4"></span>
<img src="images/si_4.png" alt="Silhouette plot when \(k=4\)." width="80%" />
<p class="caption">
FIGURE 6.8: Silhouette plot when <span class="math inline">\(k=4\)</span>.
</p>
</div>
<p>Figure <a href="unsupervised.html#fig:si4">6.8</a> shows the silhouette plot when <span class="math inline">\(k=4\)</span>. The horizontal lines represent the individual silhouette indices. In this plot, all of them are positive. The height of each cluster gives a visual idea of the number of data points contained in it with respect to other clusters. We can see for example that cluster <span class="math inline">\(2\)</span> is the smallest one. On the right side, is the number of points in each cluster and their average silhouette index. At the bottom, the total silhouette index is printed (<span class="math inline">\(0.35\)</span>). We can try to cluster the points into <span class="math inline">\(7\)</span> groups instead of <span class="math inline">\(4\)</span> and see what happens.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="unsupervised.html#cb126-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb126-2"><a href="unsupervised.html#cb126-2" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(normdf, <span class="dv">7</span>)</span>
<span id="cb126-3"><a href="unsupervised.html#cb126-3" tabindex="-1"></a>si <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(clusters<span class="sc">$</span>cluster, <span class="fu">dist</span>(normdf))</span>
<span id="cb126-4"><a href="unsupervised.html#cb126-4" tabindex="-1"></a><span class="fu">plot</span>(si, <span class="at">cex.names=</span><span class="fl">0.6</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,</span>
<span id="cb126-5"><a href="unsupervised.html#cb126-5" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Silhouette plot, k=7&quot;</span>,</span>
<span id="cb126-6"><a href="unsupervised.html#cb126-6" tabindex="-1"></a>     <span class="at">border=</span><span class="cn">NA</span>)</span></code></pre></div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:si7"></span>
<img src="images/si_7.png" alt="Silhouette plot when \(k=7\)." width="80%" />
<p class="caption">
FIGURE 6.9: Silhouette plot when <span class="math inline">\(k=7\)</span>.
</p>
</div>
<p>Here, cluster <span class="math inline">\(2\)</span> and <span class="math inline">\(4\)</span> have data points with negative indices and the overall score is <span class="math inline">\(0.26\)</span>. This suggests that <span class="math inline">\(k=4\)</span> produces more coherent clusters as compared to <span class="math inline">\(k=7\)</span>.</p>

<div class="rmdinfo">
In this section, we used the Silhouette index to validate the clustering results. Over the years, several other clustering validation methods have been developed. In their paper, <span class="citation">Halkidi, Batistakis, and Vazirgiannis (<a href="#ref-Halkidi2001">2001</a>)</span> present an overview of other clustering validation methods.
</div>
</div>
<div id="associationrules" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Mining Association Rules<a href="unsupervised.html#associationrules" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Association rule mining consists of a set of methods to extract patterns (rules) from transactional data. For example, shopping behavior can be analyzed by finding rules from customers’ shopping transactions. A <strong>transaction</strong> is an event that involves a set of items. For example, when someone buys a soda, a bag of chips, and a chocolate bar the purchase is registered as <em>one</em> transaction containing <span class="math inline">\(3\)</span> items. I apologize for using this example for those of you with healthy diets. Based on a database that contains many transactions, it is possible to uncover item relationships. Those relationships are usually expressed as implication rules of the form <span class="math inline">\(X \implies Y\)</span> where <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are sets of items. Both sets are disjoint, this means that items in <span class="math inline">\(X\)</span> are not in <span class="math inline">\(Y\)</span> and vice-versa which can be formally represented as <span class="math inline">\(X \cap Y = \emptyset\)</span>. That is, the intersection of the two sets is the empty set. <span class="math inline">\(X \implies Y\)</span> is read as: if <span class="math inline">\(X\)</span> then <span class="math inline">\(Y\)</span>. The left-hand-side (lhs) <span class="math inline">\(X\)</span> is called the <strong>antecedent</strong> and the right-hand-side (rhs) <span class="math inline">\(Y\)</span> is called the <strong>consequent</strong>.</p>
<p>In the unhealthy supermarket example, a rule like <span class="math inline">\(\{chips, chocolate\} \implies \{soda\}\)</span> can be interpreted as <em>if someone buys chips and chocolate then, it is likely that this same person will also buy soda</em>. These types of rules can be used for targeted advertisements, product placement decisions, etc.</p>
<p>The possible number of rules that can be generated grows exponentially as the number of items increases. Furthermore, not all rules may be interesting. The most well-known algorithm to find interesting association rules is called <strong>Apriori</strong> <span class="citation">(<a href="#ref-agrawal1994">Agrawal and Srikant 1994</a>)</span>. To quantify if a rule is interesting or not, this algorithm uses two importance measures: <strong>support</strong> and <strong>confidence</strong>.</p>
<ul>
<li><p><strong>Support.</strong> The support <span class="math inline">\(\text{supp}(X)\)</span> of an itemset <span class="math inline">\(X\)</span> is the proportion of transactions that contain all the items in <span class="math inline">\(X\)</span>. This quantifies how frequent the itemset is.</p></li>
<li><p><strong>Confidence.</strong> The confidence of a rule <span class="math inline">\(\text{conf}(X \implies Y)=\text{supp}(X \cup Y)/\text{supp}(X)\)</span> and can be interpreted as the conditional probability that <span class="math inline">\(Y\)</span> occurs given that <span class="math inline">\(X\)</span> is present. This can also be thought of as the probability that a transaction that contains <span class="math inline">\(X\)</span> also contains <span class="math inline">\(Y\)</span>. The <span class="math inline">\(\cup\)</span> operator is the union of two sets. This means taking all elements from both sets and removing repeated elements.</p></li>
</ul>
<p>Now that there is a way to measure the importance of the rules, the Apriori algorithm first finds itemsets that satisfy a minimum support and generates rules from those itemsets that satisfy a minimum confidence. Those minimum thresholds are set by the user. The lower the thresholds, the more rules returned by the algorithm. One thing to note is that Apriori only generates rules with itemsets of size <span class="math inline">\(1\)</span> on the right-hand side. Another common metric to measure the importance of a rule is the <strong>lift</strong>. Lift is typically used after Apriori has generated the rules to further filter and/or rank the results.</p>
<ul>
<li><strong>Lift.</strong> The lift of a rule <span class="math inline">\(\text{lift}(X \implies Y) = \text{supp}(X \cup Y) / (\text{supp}(X)\text{supp}(Y))\)</span> is similar to the confidence but it also takes into consideration the frequency of <span class="math inline">\(Y\)</span>. A lift of <span class="math inline">\(1\)</span> means that there is no association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. A lift greater than <span class="math inline">\(1\)</span> means that <span class="math inline">\(Y\)</span> is likely to occur if <span class="math inline">\(X\)</span> occurs and a lift less than <span class="math inline">\(1\)</span> means that <span class="math inline">\(Y\)</span> is unlikely to occur when <span class="math inline">\(X\)</span> occurs.</li>
</ul>
<p>Let’s compute all those metrics using an example. The following table shows a synthetic example database of transactions from shoppers with unhealthy behaviors.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:transactionsTab"></span>
<img src="images/transactions_tab.png" alt="Example database with 10 transactions." width="50%" />
<p class="caption">
FIGURE 6.10: Example database with 10 transactions.
</p>
</div>
<p>The support of the itemset consisting of a single item <em>‘chocolate’</em> is <span class="math inline">\(\text{supp}(\{chocolate\}) = 5/10 = 0.5\)</span> because <em>‘chocolate’</em> appears in <span class="math inline">\(5\)</span> out of the <span class="math inline">\(10\)</span> transactions. The support of <span class="math inline">\(\{chips, soda\}\)</span> is <span class="math inline">\(3/10 = 0.3\)</span>.</p>
<p>The confidence of the rule <span class="math inline">\(\{chocolate, chips\} \implies \{soda\}\)</span> is:</p>
<p><span class="math display">\[\begin{align*}
\text{conf}(\{chocolate, chips\} \implies \{soda\})&amp;=\frac{\text{supp}(\{chocolate, chips, soda\})}{\text{supp}(\{chocolate,chips\})} \\
&amp;=(2/10) / (3/10) \\
&amp;=0.66
\end{align*}\]</span></p>
<p>The lift of <span class="math inline">\(\{soda\} \implies \{ice cream\}\)</span> is:</p>
<p><span class="math display">\[\begin{align*}
\text{lift}(\{soda\} \implies \{ice cream\})&amp;=\frac{\text{supp}(\{soda, ice cream\})}{\text{supp}(\{soda\})\text{supp}(\{ice cream\})} \\
&amp;=(2/10) / ((7/10)(3/10)) \\
&amp;=0.95.
\end{align*}\]</span></p>
<p>Association rules mining is unsupervised in the sense that there are no labels or ground truth. Many applications of association rules are targeted to market basket analysis to gain insights into shoppers’ behavior and take actions to increase sales. To find such rules it is necessary to have ‘transactions’ (sets of items), for example, supermarket products. However, this is not the only application of association rules. There are other problems that can be structured as transactions of items. For example in medicine, <em>diseases</em> can be seen as transactions and <em>symptoms</em> as items. Thus, one can apply association rules algorithms to find symptoms and disease relationships. Another application is in recommender systems. Take, for example, movies. Transactions can be the set of movies watched by every user. If you watched a movie <span class="math inline">\(m\)</span> then, the recommender system can suggest another movie that co-occurred frequently with <span class="math inline">\(m\)</span> and that you have not watched yet. Furthermore, other types of relational data can be transformed into transaction-like structures to find patterns and this is precisely what we are going to do in the next section to mine criminal patterns.</p>
<div id="finding-rules-for-criminal-behavior" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Finding Rules for Criminal Behavior<a href="unsupervised.html#finding-rules-for-criminal-behavior" class="anchor-section" aria-label="Anchor link to header"></a></h3>

<div class="rmdfolder">
<code>crimes_process.R</code> <code>crimes_rules.R</code>
</div>
<p>In this section, we will use association rules mining to find patterns in the <em>HOMICIDE REPORTS</em><a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> dataset. This database contains homicide reports from 1980 to 2014 in the United States. The database is structured as a table with <span class="math inline">\(24\)</span> columns and <span class="math inline">\(638454\)</span> rows. Each row corresponds to a homicide report that includes city, state, year, month, sex of victim, sex of perpetrator, if the crime was solved or not, weapon used, age of the victim and perpetrator, the relationship type between the victim and the perpetrator, and some other information.</p>
<p>Before trying to find rules, the data needs to be preprocessed and converted into transactions. Each homicide report will be a transaction and the items are the possible values of <span class="math inline">\(3\)</span> of the columns: <strong>Relationship</strong>, <strong>Weapon</strong>, and <strong>Perpetrator.Age</strong>. The <strong>Relationship</strong> variable can take values like <em>Stranger</em>, <em>Neighbor</em>, <em>Friend</em>, etc. In total, there are <span class="math inline">\(28\)</span> possible relationship values including <em>Unknown</em>. For the purpose of our analysis, we will remove rows with unknown values in <strong>Relationship</strong> and <strong>Weapon</strong>. Since <strong>Perpetrator.Age</strong> is an integer, we need to convert it into categories. The following age groups are created: child (&lt; <span class="math inline">\(13\)</span> years), teen (<span class="math inline">\(13\)</span> to <span class="math inline">\(17\)</span> years), adult (<span class="math inline">\(18\)</span> to <span class="math inline">\(45\)</span> years), and lateAdulthood (&gt; <span class="math inline">\(45\)</span> years). After these cleaning and preprocessing steps, the dataset has <span class="math inline">\(3\)</span> columns and <span class="math inline">\(328238\)</span> rows (see Figure <a href="unsupervised.html#fig:tabcrimes">6.11</a>). The script used to perform the preprocessing is <code>crimes_process.R</code>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tabcrimes"></span>
<img src="images/table_crimes.png" alt="First rows of preprocessed crimes data frame. Source: Data from the Murder Accountability Project, founded by Thomas Hargrove (CC BY-SA 4.0) [https://creativecommons.org/licenses/by-sa/4.0/legalcode]." width="50%" />
<p class="caption">
FIGURE 6.11: First rows of preprocessed crimes data frame. Source: Data from the Murder Accountability Project, founded by Thomas Hargrove (CC BY-SA 4.0) [<a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" class="uri">https://creativecommons.org/licenses/by-sa/4.0/legalcode</a>].
</p>
</div>
<p>Now, we have a data frame that contains only the relevant information. Each row will be used to generate one transaction. An example transaction may be <em>{R.Wife, Knife, Adult}</em>. This one represents the case where the perpetrator is an <em>adult</em> who used a <em>knife</em> to kill his <em>wife</em>. Note the ‘R.’ at the beginning of ‘Wife’. This ‘R.’ was added for clarity in order to identify that this item is a relationship. One thing to note is that every transaction will consist of exactly <span class="math inline">\(3\)</span> items. This is a bit different than the market basket case in which every transaction can include a varying number of products. Although this item-size constraint was a design decision based on the structure of the original data, this will not prevent us from performing the analysis to find interesting rules.</p>
<p>To find the association rules, the <code>arules</code> package <span class="citation">(<a href="#ref-arules">Hahsler et al. 2019</a>)</span> will be used. This package has an interface to an efficient implementation in C of the Apriori algorithm. This package needs the transactions to be stored as an object of type ‘transactions’. One way to create this object is to use a <strong>logical matrix</strong> and cast it into a transactions object. The rows of the logical matrix represent transactions and columns represent items. The number of columns equals the total number of possible items. A <code>TRUE</code> value indicates that the item is present in the transaction and <code>FALSE</code> otherwise. In our case, the matrix has <span class="math inline">\(46\)</span> columns. The <code>crimes_process.R</code> script has code to generate this matrix <code>M</code>. The <span class="math inline">\(46\)</span> items (columns of <code>M</code>) are:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="unsupervised.html#cb127-1" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">colnames</span>(M))</span>
<span id="cb127-2"><a href="unsupervised.html#cb127-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;R.Acquaintance&quot;         &quot;R.Wife&quot;                 &quot;R.Stranger&quot;            </span></span>
<span id="cb127-3"><a href="unsupervised.html#cb127-3" tabindex="-1"></a><span class="co">#&gt; [4] &quot;R.Girlfriend&quot;           &quot;R.Ex-Husband&quot;           &quot;R.Brother&quot;             </span></span>
<span id="cb127-4"><a href="unsupervised.html#cb127-4" tabindex="-1"></a><span class="co">#&gt; [7] &quot;R.Stepdaughter&quot;         &quot;R.Husband&quot;              &quot;R.Friend&quot;              </span></span>
<span id="cb127-5"><a href="unsupervised.html#cb127-5" tabindex="-1"></a><span class="co">#&gt; [10] &quot;R.Family&quot;               &quot;R.Neighbor&quot;             &quot;R.Father&quot;              </span></span>
<span id="cb127-6"><a href="unsupervised.html#cb127-6" tabindex="-1"></a><span class="co">#&gt; [13] &quot;R.In-Law&quot;               &quot;R.Son&quot;                  &quot;R.Ex-Wife&quot;             </span></span>
<span id="cb127-7"><a href="unsupervised.html#cb127-7" tabindex="-1"></a><span class="co">#&gt; [16] &quot;R.Boyfriend&quot;            &quot;R.Mother&quot;               &quot;R.Sister&quot;              </span></span>
<span id="cb127-8"><a href="unsupervised.html#cb127-8" tabindex="-1"></a><span class="co">#&gt; [19] &quot;R.Common-Law Husband&quot;   &quot;R.Common-Law Wife&quot;      &quot;R.Stepfather&quot;          </span></span>
<span id="cb127-9"><a href="unsupervised.html#cb127-9" tabindex="-1"></a><span class="co">#&gt; [22] &quot;R.Stepson&quot;              &quot;R.Stepmother&quot;           &quot;R.Daughter&quot;            </span></span>
<span id="cb127-10"><a href="unsupervised.html#cb127-10" tabindex="-1"></a><span class="co">#&gt; [25] &quot;R.Boyfriend/Girlfriend&quot; &quot;R.Employer&quot;             &quot;R.Employee&quot;            </span></span>
<span id="cb127-11"><a href="unsupervised.html#cb127-11" tabindex="-1"></a><span class="co">#&gt; [28] &quot;Blunt Object&quot;           &quot;Strangulation&quot;          &quot;Rifle&quot;                 </span></span>
<span id="cb127-12"><a href="unsupervised.html#cb127-12" tabindex="-1"></a><span class="co">#&gt; [31] &quot;Knife&quot;                  &quot;Shotgun&quot;                &quot;Handgun&quot;               </span></span>
<span id="cb127-13"><a href="unsupervised.html#cb127-13" tabindex="-1"></a><span class="co">#&gt; [34] &quot;Drowning&quot;               &quot;Firearm&quot;                &quot;Suffocation&quot;           </span></span>
<span id="cb127-14"><a href="unsupervised.html#cb127-14" tabindex="-1"></a><span class="co">#&gt; [37] &quot;Fire&quot;                   &quot;Drugs&quot;                  &quot;Explosives&quot;            </span></span>
<span id="cb127-15"><a href="unsupervised.html#cb127-15" tabindex="-1"></a><span class="co">#&gt; [40] &quot;Fall&quot;                   &quot;Gun&quot;                    &quot;Poison&quot;                </span></span>
<span id="cb127-16"><a href="unsupervised.html#cb127-16" tabindex="-1"></a><span class="co">#&gt; [43] &quot;teen&quot;                   &quot;adult&quot;                  &quot;lateAdulthood&quot;         </span></span>
<span id="cb127-17"><a href="unsupervised.html#cb127-17" tabindex="-1"></a><span class="co">#&gt; [46] &quot;child&quot;</span></span></code></pre></div>
<p>The following snippet shows how to convert the matrix into an <code>arules</code> transactions object. Before the conversion, the package <code>arules</code> needs to be loaded. For convenience, the transactions are saved in a file <code>transactions.RData</code>.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="unsupervised.html#cb128-1" tabindex="-1"></a><span class="fu">library</span>(arules)</span>
<span id="cb128-2"><a href="unsupervised.html#cb128-2" tabindex="-1"></a></span>
<span id="cb128-3"><a href="unsupervised.html#cb128-3" tabindex="-1"></a><span class="co"># Convert into a transactions object.</span></span>
<span id="cb128-4"><a href="unsupervised.html#cb128-4" tabindex="-1"></a>transactions <span class="ot">&lt;-</span> <span class="fu">as</span>(M, <span class="st">&quot;transactions&quot;</span>)</span>
<span id="cb128-5"><a href="unsupervised.html#cb128-5" tabindex="-1"></a></span>
<span id="cb128-6"><a href="unsupervised.html#cb128-6" tabindex="-1"></a><span class="co"># Save transactions file.</span></span>
<span id="cb128-7"><a href="unsupervised.html#cb128-7" tabindex="-1"></a><span class="fu">save</span>(transactions, <span class="at">file=</span><span class="st">&quot;transactions.RData&quot;</span>)</span></code></pre></div>
<p>Now that the database is in the required format we can start the analysis. The <code>crimes_rules.R</code> script has the code to perform the analysis. First, the transactions file that we generated before is loaded:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="unsupervised.html#cb129-1" tabindex="-1"></a><span class="fu">library</span>(arules)</span>
<span id="cb129-2"><a href="unsupervised.html#cb129-2" tabindex="-1"></a><span class="fu">library</span>(arulesViz)</span>
<span id="cb129-3"><a href="unsupervised.html#cb129-3" tabindex="-1"></a></span>
<span id="cb129-4"><a href="unsupervised.html#cb129-4" tabindex="-1"></a><span class="co"># Load preprocessed data.</span></span>
<span id="cb129-5"><a href="unsupervised.html#cb129-5" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;transactions.RData&quot;</span>)</span></code></pre></div>
<p>Note that additionally to the <code>arules</code> package, we also loaded the <code>arulesViz</code> package <span class="citation">(<a href="#ref-ParulesViz">Hahsler 2019</a>)</span>. This package has several functions to generate cool plots of the learned rules! A summary of the transactions can be printed with the <code>summary()</code> function:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="unsupervised.html#cb130-1" tabindex="-1"></a><span class="co"># Print summary.</span></span>
<span id="cb130-2"><a href="unsupervised.html#cb130-2" tabindex="-1"></a><span class="fu">summary</span>(transactions)</span>
<span id="cb130-3"><a href="unsupervised.html#cb130-3" tabindex="-1"></a></span>
<span id="cb130-4"><a href="unsupervised.html#cb130-4" tabindex="-1"></a><span class="co">#&gt; transactions as itemMatrix in sparse format with</span></span>
<span id="cb130-5"><a href="unsupervised.html#cb130-5" tabindex="-1"></a><span class="co">#&gt; 328238 rows (elements/itemsets/transactions) and</span></span>
<span id="cb130-6"><a href="unsupervised.html#cb130-6" tabindex="-1"></a><span class="co">#&gt; 46 columns (items) and a density of 0.06521739 </span></span>
<span id="cb130-7"><a href="unsupervised.html#cb130-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb130-8"><a href="unsupervised.html#cb130-8" tabindex="-1"></a><span class="co">#&gt; most frequent items:</span></span>
<span id="cb130-9"><a href="unsupervised.html#cb130-9" tabindex="-1"></a><span class="co">#&gt;   adult        Handgun R.Acquaintance     R.Stranger </span></span>
<span id="cb130-10"><a href="unsupervised.html#cb130-10" tabindex="-1"></a><span class="co">#&gt; 257026         160586         117305          77725 </span></span>
<span id="cb130-11"><a href="unsupervised.html#cb130-11" tabindex="-1"></a><span class="co">#&gt; Knife        (Other) </span></span>
<span id="cb130-12"><a href="unsupervised.html#cb130-12" tabindex="-1"></a><span class="co">#&gt; 61936         310136 </span></span>
<span id="cb130-13"><a href="unsupervised.html#cb130-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb130-14"><a href="unsupervised.html#cb130-14" tabindex="-1"></a><span class="co">#&gt; element (itemset/transaction) length distribution:</span></span>
<span id="cb130-15"><a href="unsupervised.html#cb130-15" tabindex="-1"></a><span class="co">#&gt;   sizes</span></span>
<span id="cb130-16"><a href="unsupervised.html#cb130-16" tabindex="-1"></a><span class="co">#&gt; 3 </span></span>
<span id="cb130-17"><a href="unsupervised.html#cb130-17" tabindex="-1"></a><span class="co">#&gt; 328238 </span></span>
<span id="cb130-18"><a href="unsupervised.html#cb130-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb130-19"><a href="unsupervised.html#cb130-19" tabindex="-1"></a><span class="co">#&gt; Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb130-20"><a href="unsupervised.html#cb130-20" tabindex="-1"></a><span class="co">#&gt; 3       3       3       3       3       3 </span></span>
<span id="cb130-21"><a href="unsupervised.html#cb130-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb130-22"><a href="unsupervised.html#cb130-22" tabindex="-1"></a><span class="co">#&gt; includes extended item information - examples:</span></span>
<span id="cb130-23"><a href="unsupervised.html#cb130-23" tabindex="-1"></a><span class="co">#&gt;   labels</span></span>
<span id="cb130-24"><a href="unsupervised.html#cb130-24" tabindex="-1"></a><span class="co">#&gt; Relationship1 R.Acquaintance</span></span>
<span id="cb130-25"><a href="unsupervised.html#cb130-25" tabindex="-1"></a><span class="co">#&gt; Relationship2         R.Wife</span></span>
<span id="cb130-26"><a href="unsupervised.html#cb130-26" tabindex="-1"></a><span class="co">#&gt; Relationship3     R.Stranger</span></span></code></pre></div>
<p>The summary shows the total number of rows (transactions) and the number of columns. It also prints the most frequent items, in this case, <em>adult</em> with <span class="math inline">\(257026\)</span> occurrences, <em>Handgun</em> with <span class="math inline">\(160586\)</span>, and so on. The itemset sizes are also displayed. Here, all itemsets have a size of <span class="math inline">\(3\)</span> (by design). Some other summary statistics are also printed.</p>
<p>We can use the <code>itemFrequencyPlot()</code> function from the <code>arulesViz</code> package to plot the frequency of items.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="unsupervised.html#cb131-1" tabindex="-1"></a><span class="fu">itemFrequencyPlot</span>(transactions,</span>
<span id="cb131-2"><a href="unsupervised.html#cb131-2" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&quot;relative&quot;</span>,</span>
<span id="cb131-3"><a href="unsupervised.html#cb131-3" tabindex="-1"></a>                  <span class="at">topN =</span> <span class="dv">15</span>,</span>
<span id="cb131-4"><a href="unsupervised.html#cb131-4" tabindex="-1"></a>                  <span class="at">main =</span> <span class="st">&#39;Item frequecies&#39;</span>)</span></code></pre></div>
<p>The <code>type</code> argument specifies that we want to plot the relative frequencies. Use <code>"absolute"</code> instead to plot the total counts. <code>topN</code> is used to select how many items are plotted. Figure <a href="unsupervised.html#fig:rulesfreqs">6.12</a> shows the output.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rulesfreqs"></span>
<img src="images/item_freqs.png" alt="Frequences of the top 15 items." width="100%" />
<p class="caption">
FIGURE 6.12: Frequences of the top 15 items.
</p>
</div>
<p>Now it is time to find some interesting rules! This can be done with the <code>apriori()</code> function as follows:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="unsupervised.html#cb132-1" tabindex="-1"></a><span class="co"># Run apriori algorithm.</span></span>
<span id="cb132-2"><a href="unsupervised.html#cb132-2" tabindex="-1"></a>resrules <span class="ot">&lt;-</span> <span class="fu">apriori</span>(transactions,</span>
<span id="cb132-3"><a href="unsupervised.html#cb132-3" tabindex="-1"></a>                    <span class="at">parameter =</span> <span class="fu">list</span>(<span class="at">support =</span> <span class="fl">0.001</span>,</span>
<span id="cb132-4"><a href="unsupervised.html#cb132-4" tabindex="-1"></a>                                     <span class="at">confidence =</span> <span class="fl">0.5</span>,</span>
<span id="cb132-5"><a href="unsupervised.html#cb132-5" tabindex="-1"></a>                                     <span class="co"># Find rules with at least 2 items.</span></span>
<span id="cb132-6"><a href="unsupervised.html#cb132-6" tabindex="-1"></a>                                     <span class="at">minlen =</span> <span class="dv">2</span>,</span>
<span id="cb132-7"><a href="unsupervised.html#cb132-7" tabindex="-1"></a>                                     <span class="at">target =</span> <span class="st">&#39;rules&#39;</span>))</span></code></pre></div>
<p>The first argument is the transactions object. The second argument <code>parameter</code> specifies a list of algorithm parameters. In this case we want rules with a minimum support of <span class="math inline">\(0.001\)</span> and a confidence of at least <span class="math inline">\(0.5\)</span>. The <code>minlen</code> argument specifies the minimum number of allowed items in a rule (antecedent + consequent). We set it to <span class="math inline">\(2\)</span> since we want rules with at least one element in the antecedent and one element in the consequent, for example, <em>{item1 =&gt; item2}</em>. This Apriori algorithm creates rules with only one item in the consequent. Finally, the <code>target</code> parameter is used to specify that we want to find rules because the function can also return item sets of different types (see the documentation for more details). The returned rules are saved in the <code>resrules</code> variable that can be used later to explore the results. We can also print a summary of the returned results.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="unsupervised.html#cb133-1" tabindex="-1"></a><span class="co"># Print a summary of the results.</span></span>
<span id="cb133-2"><a href="unsupervised.html#cb133-2" tabindex="-1"></a><span class="fu">summary</span>(resrules)</span>
<span id="cb133-3"><a href="unsupervised.html#cb133-3" tabindex="-1"></a></span>
<span id="cb133-4"><a href="unsupervised.html#cb133-4" tabindex="-1"></a><span class="co">#&gt; set of 141 rules</span></span>
<span id="cb133-5"><a href="unsupervised.html#cb133-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb133-6"><a href="unsupervised.html#cb133-6" tabindex="-1"></a><span class="co">#&gt; rule length distribution (lhs + rhs):sizes</span></span>
<span id="cb133-7"><a href="unsupervised.html#cb133-7" tabindex="-1"></a><span class="co">#&gt; 2  3 </span></span>
<span id="cb133-8"><a href="unsupervised.html#cb133-8" tabindex="-1"></a><span class="co">#&gt; 45 96 </span></span>
<span id="cb133-9"><a href="unsupervised.html#cb133-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb133-10"><a href="unsupervised.html#cb133-10" tabindex="-1"></a><span class="co">#&gt; Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb133-11"><a href="unsupervised.html#cb133-11" tabindex="-1"></a><span class="co">#&gt; 2.000   2.000   3.000   2.681   3.000   3.000 </span></span>
<span id="cb133-12"><a href="unsupervised.html#cb133-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb133-13"><a href="unsupervised.html#cb133-13" tabindex="-1"></a><span class="co">#&gt; summary of quality measures:</span></span>
<span id="cb133-14"><a href="unsupervised.html#cb133-14" tabindex="-1"></a><span class="co">#&gt;   support           confidence          lift            count       </span></span>
<span id="cb133-15"><a href="unsupervised.html#cb133-15" tabindex="-1"></a><span class="co">#&gt; Min.   :0.001030   Min.   :0.5045   Min.   :0.6535   Min.   :   338  </span></span>
<span id="cb133-16"><a href="unsupervised.html#cb133-16" tabindex="-1"></a><span class="co">#&gt; 1st Qu.:0.001767   1st Qu.:0.6478   1st Qu.:0.9158   1st Qu.:   580  </span></span>
<span id="cb133-17"><a href="unsupervised.html#cb133-17" tabindex="-1"></a><span class="co">#&gt; Median :0.004424   Median :0.7577   Median :1.0139   Median :  1452  </span></span>
<span id="cb133-18"><a href="unsupervised.html#cb133-18" tabindex="-1"></a><span class="co">#&gt; Mean   :0.021271   Mean   :0.7269   Mean   :1.0906   Mean   :  6982  </span></span>
<span id="cb133-19"><a href="unsupervised.html#cb133-19" tabindex="-1"></a><span class="co">#&gt; 3rd Qu.:0.012960   3rd Qu.:0.8131   3rd Qu.:1.0933   3rd Qu.:  4254  </span></span>
<span id="cb133-20"><a href="unsupervised.html#cb133-20" tabindex="-1"></a><span class="co">#&gt; Max.   :0.376836   Max.   :0.9539   Max.   :4.2777   Max.   :123692  </span></span>
<span id="cb133-21"><a href="unsupervised.html#cb133-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb133-22"><a href="unsupervised.html#cb133-22" tabindex="-1"></a><span class="co">#&gt; mining info:</span></span>
<span id="cb133-23"><a href="unsupervised.html#cb133-23" tabindex="-1"></a><span class="co">#&gt;   data ntransactions support confidence</span></span>
<span id="cb133-24"><a href="unsupervised.html#cb133-24" tabindex="-1"></a><span class="co">#&gt; transactions        328238   0.001        0.5</span></span></code></pre></div>
<p>By looking at the summary, we see that the algorithm found <span class="math inline">\(141\)</span> rules that satisfy the support and confidence thresholds. The rule length distribution is also printed. Here, <span class="math inline">\(45\)</span> rules are of size <span class="math inline">\(2\)</span> and <span class="math inline">\(96\)</span> rules are of size <span class="math inline">\(3\)</span>. Then, some standard statistics are shown for support, confidence, and lift. The <code>inspect()</code> function can be used to print the actual rules. Rules can be sorted by one of the importance measures. The following code sorts by lift and prints the first <span class="math inline">\(20\)</span> rules. Figure <a href="unsupervised.html#fig:resrules">6.13</a> shows the output.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="unsupervised.html#cb134-1" tabindex="-1"></a><span class="co"># Print the first n (20) rules with highest lift in decreasing order.</span></span>
<span id="cb134-2"><a href="unsupervised.html#cb134-2" tabindex="-1"></a><span class="fu">inspect</span>(<span class="fu">sort</span>(resrules, <span class="at">by=</span><span class="st">&#39;lift&#39;</span>, <span class="at">decreasing =</span> T)[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:resrules"></span>
<img src="images/resrules.png" alt="Output of the inspect() function." width="100%" />
<p class="caption">
FIGURE 6.13: Output of the inspect() function.
</p>
</div>
<p>The first rule with a lift of <span class="math inline">\(4.27\)</span> says that if a homicide was committed by an <em>adult</em> and the victim was the <em>stepson</em>, then is it likely that a <em>blunt object</em> was used for the crime. By looking at the rules, one can also note that whenever <em>blunt object</em> appears either in the lhs or rhs, the victim was most likely an infant. Another thing to note is that when the victim was <em>boyfriend</em>, the crime was likely committed with a <em>knife</em>. This is also mentioned in the reports ‘Homicide trends in the United States’ <span class="citation">(<a href="#ref-cooper2012">Cooper, Smith, et al. 2012</a>)</span>:</p>
<blockquote>
<p>From 1980 through 2008 ‘Boyfriends were more likely to be killed by knives than any other group of intimates’.</p>
</blockquote>
<p>According to rule <span class="math inline">\(20\)</span>, crimes involving <em>girlfriend</em> have a strong relationship with <em>strangulation</em>. This can also be confirmed in <span class="citation">(<a href="#ref-cooper2012">Cooper, Smith, et al. 2012</a>)</span>:</p>
<blockquote>
<p>From 1980 through 2008 ‘Girlfriends were more likely to be killed by force…’.</p>
</blockquote>
<p>The resulting rules can be plotted with the <code>plot()</code> function (see Figure <a href="unsupervised.html#fig:rulesScatter">6.14</a>). By default, it generates a scatterplot with the <em>support</em> in the <span class="math inline">\(x\)</span> axis and <em>confidence</em> in the <span class="math inline">\(y\)</span> axis colored by <em>lift</em>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="unsupervised.html#cb135-1" tabindex="-1"></a><span class="co"># Plot a default scatterplot of support vs. confidence colored by lift.</span></span>
<span id="cb135-2"><a href="unsupervised.html#cb135-2" tabindex="-1"></a><span class="fu">plot</span>(resrules)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rulesScatter"></span>
<img src="images/rules_scatter.png" alt="Scatterplot of rules support vs. confidence colored by lift." width="90%" />
<p class="caption">
FIGURE 6.14: Scatterplot of rules support vs. confidence colored by lift.
</p>
</div>
<p>The plot shows that rules with a high <em>lift</em> also have a low <em>support</em> and <em>confidence</em>. <span class="citation">Hahsler (<a href="#ref-Hahsler2017">2017</a>)</span> mentioned that rules with high <em>lift</em> typically have low <em>support</em>. The plot can be customized for example to show the <em>support</em> and <em>lift</em> in the axes and color them by confidence. The axes can be set with the <code>measure</code> parameter and the coloring with the <code>shading</code> parameter. The function also supports different plotting engines including static and interactive. The following code generates a customized interactive plot by setting <code>engine = "htmlwidget"</code>. This is very handy if you want to know which points correspond to which rules. By hovering the mouse on the desired point the corresponding rule is shown as a tooltip box (Figure <a href="unsupervised.html#fig:rulesScatterInt">6.15</a>). The interactive plots also allow to zoom in regions by clicking and dragging.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="unsupervised.html#cb136-1" tabindex="-1"></a><span class="co"># Customize scatterplot to make it interactive</span></span>
<span id="cb136-2"><a href="unsupervised.html#cb136-2" tabindex="-1"></a><span class="co"># and plot support vs. lift colored by confidence.</span></span>
<span id="cb136-3"><a href="unsupervised.html#cb136-3" tabindex="-1"></a><span class="fu">plot</span>(resrules, <span class="at">engine =</span> <span class="st">&quot;htmlwidget&quot;</span>,</span>
<span id="cb136-4"><a href="unsupervised.html#cb136-4" tabindex="-1"></a>     <span class="at">measure =</span> <span class="fu">c</span>(<span class="st">&quot;support&quot;</span>, <span class="st">&quot;lift&quot;</span>), <span class="at">shading =</span> <span class="st">&quot;confidence&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rulesScatterInt"></span>
<img src="images/rules_scatter_int.png" alt="Interactive scatterplot of rules." width="90%" />
<p class="caption">
FIGURE 6.15: Interactive scatterplot of rules.
</p>
</div>
<p>The <code>arulesViz</code> package has a nice option to plot rules as a graph. This is done by setting <code>method = "graph"</code>. We can also make the graph interactive for easier exploration by setting <code>engine="htmlwidget"</code>. For clarity, the font size is reduced with <code>cex=0.9</code>. Here we plot the first <span class="math inline">\(25\)</span> rules.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="unsupervised.html#cb137-1" tabindex="-1"></a><span class="co"># Plot rules as a graph.</span></span>
<span id="cb137-2"><a href="unsupervised.html#cb137-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">head</span>(<span class="fu">sort</span>(resrules, <span class="at">by =</span> <span class="st">&quot;lift&quot;</span>), <span class="at">n=</span><span class="dv">25</span>),</span>
<span id="cb137-3"><a href="unsupervised.html#cb137-3" tabindex="-1"></a>     <span class="at">method =</span> <span class="st">&quot;graph&quot;</span>,</span>
<span id="cb137-4"><a href="unsupervised.html#cb137-4" tabindex="-1"></a>     <span class="at">control=</span><span class="fu">list</span>(<span class="at">cex=</span>.<span class="dv">9</span>),</span>
<span id="cb137-5"><a href="unsupervised.html#cb137-5" tabindex="-1"></a>     <span class="at">engine=</span><span class="st">&quot;htmlwidget&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rulesGraphInt"></span>
<img src="images/rules_graph.png" alt="Interactive graph of rules." width="90%" />
<p class="caption">
FIGURE 6.16: Interactive graph of rules.
</p>
</div>
<p>Figure <a href="unsupervised.html#fig:rulesGraphInt">6.16</a> shows a zoomed-in portion of the entire graph. Circles represent rules and rounded squares items. The size of the circle is relative to the <em>support</em> and color relative to the <em>lift</em>. Incoming arrows represent the items in the antecedent and the outgoing arrow of a circle points to the item in the consequent part of the rule. From this graph, some interesting patterns can be seen. First, when the age category of the perpetrator is <em>lateAdulthood</em>, the victims were the <em>husband</em> or <em>ex-wife</em>. When the perpetrator is a <em>teen</em>, the victim was likely a <em>friend</em> or <em>stranger</em>.</p>
<p>The <code>arulesViz</code> package has a cool function <code>ruleExplorer()</code> that generates a shiny app with interactive controls and several plot types. When running the following code (output not shown) you may be asked to install additional shiny related packages.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="unsupervised.html#cb138-1" tabindex="-1"></a><span class="co"># Opens a shiny app with several interactive plots.</span></span>
<span id="cb138-2"><a href="unsupervised.html#cb138-2" tabindex="-1"></a><span class="fu">ruleExplorer</span>(resrules)</span></code></pre></div>
<p>Sometimes Apriori returns thousands of rules. There is a convenient <code>subset()</code> function to extract rules of interest. For example, we can select only the rules that contain <em>R.Girlfriend</em> in the antecedent (lhs) and print the top three with highest lift (Figure <a href="unsupervised.html#fig:resrulesGirlfriend">6.17</a> shows the result):</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="unsupervised.html#cb139-1" tabindex="-1"></a><span class="co"># Subset transactions.</span></span>
<span id="cb139-2"><a href="unsupervised.html#cb139-2" tabindex="-1"></a>rulesGirlfriend <span class="ot">&lt;-</span> <span class="fu">subset</span>(resrules, <span class="at">subset =</span> lhs <span class="sc">%in%</span> <span class="st">&quot;R.Girlfriend&quot;</span>)</span>
<span id="cb139-3"><a href="unsupervised.html#cb139-3" tabindex="-1"></a></span>
<span id="cb139-4"><a href="unsupervised.html#cb139-4" tabindex="-1"></a><span class="co"># Print rules with highest lift.</span></span>
<span id="cb139-5"><a href="unsupervised.html#cb139-5" tabindex="-1"></a><span class="fu">inspect</span>(<span class="fu">head</span>(rulesGirlfriend, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">by =</span> <span class="st">&quot;lift&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:resrulesGirlfriend"></span>
<img src="images/inspectGirlfriend.png" alt="Output of the inspect() function." width="100%" />
<p class="caption">
FIGURE 6.17: Output of the inspect() function.
</p>
</div>
<p>In this section, we showed how interesting rules can be extracted from a crimes database. Several preprocessing steps were required to transform the tabular data into transactional data. This example already demonstrated how the same data can be represented in different ways (tabular and transactional). The next chapter will cover more details about how data can be transformed into <strong>different representations</strong> suitable for different types of learning algorithms.</p>
</div>
</div>
<div id="SummaryUnsupervised" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Summary<a href="unsupervised.html#SummaryUnsupervised" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the types of machine learning is <strong>unsupervised learning</strong> in which there are no labels. This chapter introduced some unsupervised methods such as clustering and association rules.</p>
<ul>
<li>The objective of <strong><span class="math inline">\(k\)</span>-means clustering</strong> is to find groups of points such that points in the same group are similar and points from different groups are as dissimilar as possible.</li>
<li>The <strong>centroid</strong> of a group is calculated by taking the mean value of each feature.</li>
<li>In <strong><span class="math inline">\(k\)</span>-means</strong>, one needs to specify the number of groups <span class="math inline">\(k\)</span> before running the algorithm.</li>
<li>The <strong>Silhouette Index</strong> is a measure that tells us how well a set of points were clustered. This measure can be used to find the optimal number of groups <span class="math inline">\(k\)</span>.</li>
<li><strong>Association rules</strong> can find patterns in an unsupervised manner.</li>
<li>The <strong>Apriori algorithm</strong> is the most well-known method for finding association rules.</li>
<li>Before using the <em>Apriori algorithm</em>, one needs to format the data as <strong>transactions</strong>.</li>
<li>A <strong>transaction</strong> is an event that involves a set of items.</li>
</ul>
<p><img src="images/comic_K-Miss.png" width="100%" style="display: block; margin: auto;" />
</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-agrawal1994" class="csl-entry">
Agrawal, Rakesh, and Ramakrishnan Srikant. 1994. <span>“Fast Algorithms for Mining Association Rules.”</span> In <em>Proc. 20th Int. Conf. Very Large Data Bases, VLDB</em>, 1215:487–99.
</div>
<div id="ref-cooper2012" class="csl-entry">
Cooper, Alexia, Erica L Smith, et al. 2012. <em>Homicide Trends in the United States, 1980-2008</em>. BiblioGov.
</div>
<div id="ref-Hahsler2017" class="csl-entry">
Hahsler, Michael. 2017. <span>“Arules<span>V</span>iz: <span>I</span>nteractive Visualization of Association Rules with <span>R</span>.”</span> <em>R Journal</em> 9 (2): 163–75. <a href="https://journal.r-project.org/archive/2017/RJ-2017-047/RJ-2017-047.pdf">https://journal.r-project.org/archive/2017/RJ-2017-047/RJ-2017-047.pdf</a>.
</div>
<div id="ref-ParulesViz" class="csl-entry">
———. 2019. <em>arulesViz: Visualizing Association Rules and Frequent Itemsets</em>. <a href="https://CRAN.R-project.org/package=arulesViz">https://CRAN.R-project.org/package=arulesViz</a>.
</div>
<div id="ref-arules" class="csl-entry">
Hahsler, Michael, Christian Buchta, Bettina Gruen, and Kurt Hornik. 2019. <em>Arules: Mining Association Rules and Frequent Itemsets</em>. <a href="https://CRAN.R-project.org/package=arules">https://CRAN.R-project.org/package=arules</a>.
</div>
<div id="ref-Halkidi2001" class="csl-entry">
Halkidi, Maria, Yannis Batistakis, and Michalis Vazirgiannis. 2001. <span>“On Clustering Validation Techniques.”</span> <em>Journal of Intelligent Information Systems</em> 17 (2): 107–45.
</div>
<div id="ref-rousseeuw1987" class="csl-entry">
Rousseeuw, Peter J. 1987. <span>“Silhouettes: A Graphical Aid to the Interpretation and Validation of Cluster Analysis.”</span> <em>Journal of Computational and Applied Mathematics</em> 20: 53–65.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p><a href="https://www.kaggle.com/murderaccountability/homicide-reports" class="uri">https://www.kaggle.com/murderaccountability/homicide-reports</a><a href="unsupervised.html#fnref14" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="preprocessing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="representations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
