<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9.1 Mixed Models | Behavior Analysis with Machine Learning and R</title>
  <meta name="description" content="9.1 Mixed Models | Behavior Analysis with Machine Learning and R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="9.1 Mixed Models | Behavior Analysis with Machine Learning and R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="9.1 Mixed Models | Behavior Analysis with Machine Learning and R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9.1 Mixed Models | Behavior Analysis with Machine Learning and R" />
  
  <meta name="twitter:description" content="9.1 Mixed Models | Behavior Analysis with Machine Learning and R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Enrique Garcia Ceja" />


<meta name="date" content="2020-09-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiuser.html"/>
<link rel="next" href="user-independent-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/d3-4.9.0/d3.min.js"></script>
<script src="libs/d3-tip-0.7.1/index-min.js"></script>
<link href="libs/d3panels-1.4.9/d3panels.min.css" rel="stylesheet" />
<script src="libs/d3panels-1.4.9/d3panels.min.js"></script>
<script src="libs/qtlcharts_iplotCorr-0.11.6/iplotCorr.js"></script>
<script src="libs/qtlcharts_iplotCorr-0.11.6/iplotCorr_noscat.js"></script>
<script src="libs/iplotCorr-binding-0.11.6/iplotCorr.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-178679335-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-178679335-1', { 'anonymize_ip': true });
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="#">Behavior Analysis with Machine Learning and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#supplemental-material"><i class="fa fa-check"></i>Supplemental Material</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html"><i class="fa fa-check"></i><b>1.1</b> What is Machine Learning?</a></li>
<li class="chapter" data-level="1.2" data-path="taxonomy.html"><a href="taxonomy.html"><i class="fa fa-check"></i><b>1.2</b> Types of Machine Learning</a></li>
<li class="chapter" data-level="1.3" data-path="terminology.html"><a href="terminology.html"><i class="fa fa-check"></i><b>1.3</b> Terminology</a><ul>
<li class="chapter" data-level="1.3.1" data-path="terminology.html"><a href="terminology.html#tables"><i class="fa fa-check"></i><b>1.3.1</b> Tables</a></li>
<li class="chapter" data-level="1.3.2" data-path="terminology.html"><a href="terminology.html#variable-types"><i class="fa fa-check"></i><b>1.3.2</b> Variable Types</a></li>
<li class="chapter" data-level="1.3.3" data-path="terminology.html"><a href="terminology.html#predictive-models"><i class="fa fa-check"></i><b>1.3.3</b> Predictive Models</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="pipeline.html"><a href="pipeline.html"><i class="fa fa-check"></i><b>1.4</b> Data Analysis Pipeline</a></li>
<li class="chapter" data-level="1.5" data-path="trainingeval.html"><a href="trainingeval.html"><i class="fa fa-check"></i><b>1.5</b> Evaluating Predictive Models</a></li>
<li class="chapter" data-level="1.6" data-path="simple-classification-example.html"><a href="simple-classification-example.html"><i class="fa fa-check"></i><b>1.6</b> Simple Classification Example</a><ul>
<li class="chapter" data-level="1.6.1" data-path="simple-classification-example.html"><a href="simple-classification-example.html#k-fold-cross-validation-example"><i class="fa fa-check"></i><b>1.6.1</b> K-fold Cross-Validation Example</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="simple-regression-example.html"><a href="simple-regression-example.html"><i class="fa fa-check"></i><b>1.7</b> Simple Regression Example</a></li>
<li class="chapter" data-level="1.8" data-path="underfitting-and-overfitting.html"><a href="underfitting-and-overfitting.html"><i class="fa fa-check"></i><b>1.8</b> Underfitting and Overfitting</a></li>
<li class="chapter" data-level="1.9" data-path="bias-and-variance.html"><a href="bias-and-variance.html"><i class="fa fa-check"></i><b>1.9</b> Bias and Variance</a></li>
<li class="chapter" data-level="1.10" data-path="SummaryIntro.html"><a href="SummaryIntro.html"><i class="fa fa-check"></i><b>1.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>2</b> Predicting Behavior with Classification Models</a><ul>
<li class="chapter" data-level="2.1" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html"><i class="fa fa-check"></i><b>2.1</b> <em>k</em>-nearest Neighbors</a><ul>
<li class="chapter" data-level="2.1.1" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#indoor-location-with-wi-fi-signals"><i class="fa fa-check"></i><b>2.1.1</b> Indoor Location with Wi-Fi Signals</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="performance-metrics.html"><a href="performance-metrics.html"><i class="fa fa-check"></i><b>2.2</b> Performance Metrics</a></li>
<li class="chapter" data-level="2.3" data-path="decision-trees.html"><a href="decision-trees.html"><i class="fa fa-check"></i><b>2.3</b> Decision Trees</a><ul>
<li class="chapter" data-level="2.3.1" data-path="decision-trees.html"><a href="decision-trees.html#activityRecognition"><i class="fa fa-check"></i><b>2.3.1</b> Activity Recognition with Smartphones</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="dynamic-time-warping.html"><a href="dynamic-time-warping.html"><i class="fa fa-check"></i><b>2.4</b> Dynamic Time Warping</a><ul>
<li class="chapter" data-level="2.4.1" data-path="dynamic-time-warping.html"><a href="dynamic-time-warping.html#sechandgestures"><i class="fa fa-check"></i><b>2.4.1</b> Hand Gesture Recognition</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summaryClassification.html"><a href="summaryClassification.html"><i class="fa fa-check"></i><b>2.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ensemble.html"><a href="ensemble.html"><i class="fa fa-check"></i><b>3</b> Predicting Behavior with Ensemble Learning</a><ul>
<li class="chapter" data-level="3.1" data-path="bagging.html"><a href="bagging.html"><i class="fa fa-check"></i><b>3.1</b> Bagging</a><ul>
<li class="chapter" data-level="3.1.1" data-path="bagging.html"><a href="bagging.html#activity-recognition-with-bagging"><i class="fa fa-check"></i><b>3.1.1</b> Activity recognition with Bagging</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>3.2</b> Random Forest</a></li>
<li class="chapter" data-level="3.3" data-path="stacked-generalization.html"><a href="stacked-generalization.html"><i class="fa fa-check"></i><b>3.3</b> Stacked Generalization</a></li>
<li class="chapter" data-level="3.4" data-path="multiviewhometasks.html"><a href="multiviewhometasks.html"><i class="fa fa-check"></i><b>3.4</b> Multi-view Stacking for Home Tasks Recognition</a></li>
<li class="chapter" data-level="3.5" data-path="SummaryEnsemble.html"><a href="SummaryEnsemble.html"><i class="fa fa-check"></i><b>3.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="edavis.html"><a href="edavis.html"><i class="fa fa-check"></i><b>4</b> Exploring and Visualizing Behavioral Data</a><ul>
<li class="chapter" data-level="4.1" data-path="talking-with-field-experts.html"><a href="talking-with-field-experts.html"><i class="fa fa-check"></i><b>4.1</b> Talking with Field Experts</a></li>
<li class="chapter" data-level="4.2" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>4.2</b> Summary Statistics</a></li>
<li class="chapter" data-level="4.3" data-path="class-distributions.html"><a href="class-distributions.html"><i class="fa fa-check"></i><b>4.3</b> Class Distributions</a></li>
<li class="chapter" data-level="4.4" data-path="user-class-sparsity-matrix.html"><a href="user-class-sparsity-matrix.html"><i class="fa fa-check"></i><b>4.4</b> User-Class Sparsity Matrix</a></li>
<li class="chapter" data-level="4.5" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>4.5</b> Boxplots</a></li>
<li class="chapter" data-level="4.6" data-path="correlation-plots.html"><a href="correlation-plots.html"><i class="fa fa-check"></i><b>4.6</b> Correlation Plots</a><ul>
<li class="chapter" data-level="4.6.1" data-path="correlation-plots.html"><a href="correlation-plots.html#interactive-correlation-plots"><i class="fa fa-check"></i><b>4.6.1</b> Interactive Correlation Plots</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="timeseries.html"><a href="timeseries.html"><i class="fa fa-check"></i><b>4.7</b> Timeseries</a><ul>
<li class="chapter" data-level="4.7.1" data-path="timeseries.html"><a href="timeseries.html#interactive-timeseries"><i class="fa fa-check"></i><b>4.7.1</b> Interactive Timeseries</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html"><i class="fa fa-check"></i><b>4.8</b> Multidimensional Scaling (MDS)</a></li>
<li class="chapter" data-level="4.9" data-path="heatmaps.html"><a href="heatmaps.html"><i class="fa fa-check"></i><b>4.9</b> Heatmaps</a></li>
<li class="chapter" data-level="4.10" data-path="automated-eda.html"><a href="automated-eda.html"><i class="fa fa-check"></i><b>4.10</b> Automated EDA</a></li>
<li class="chapter" data-level="4.11" data-path="SummaryExploratory.html"><a href="SummaryExploratory.html"><i class="fa fa-check"></i><b>4.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="preprocessing.html"><a href="preprocessing.html"><i class="fa fa-check"></i><b>5</b> Preprocessing Behavioral Data</a><ul>
<li class="chapter" data-level="5.1" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>5.1</b> Missing Values</a><ul>
<li class="chapter" data-level="5.1.1" data-path="missing-values.html"><a href="missing-values.html#imputation"><i class="fa fa-check"></i><b>5.1.1</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="smoothing.html"><a href="smoothing.html"><i class="fa fa-check"></i><b>5.2</b> Smoothing</a></li>
<li class="chapter" data-level="5.3" data-path="normalization.html"><a href="normalization.html"><i class="fa fa-check"></i><b>5.3</b> Normalization</a></li>
<li class="chapter" data-level="5.4" data-path="imbalanced-classes.html"><a href="imbalanced-classes.html"><i class="fa fa-check"></i><b>5.4</b> Imbalanced Classes</a><ul>
<li class="chapter" data-level="5.4.1" data-path="imbalanced-classes.html"><a href="imbalanced-classes.html#random-oversampling"><i class="fa fa-check"></i><b>5.4.1</b> Random Oversampling</a></li>
<li class="chapter" data-level="5.4.2" data-path="imbalanced-classes.html"><a href="imbalanced-classes.html#smote"><i class="fa fa-check"></i><b>5.4.2</b> SMOTE</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="infoinjection.html"><a href="infoinjection.html"><i class="fa fa-check"></i><b>5.5</b> Information Injection</a></li>
<li class="chapter" data-level="5.6" data-path="one-hot-encoding.html"><a href="one-hot-encoding.html"><i class="fa fa-check"></i><b>5.6</b> One-hot Encoding</a></li>
<li class="chapter" data-level="5.7" data-path="SummaryPreprocessing.html"><a href="SummaryPreprocessing.html"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="unsupervised.html"><a href="unsupervised.html"><i class="fa fa-check"></i><b>6</b> Discovering Behaviors with Unsupervised Learning</a><ul>
<li class="chapter" data-level="6.1" data-path="k-means-clustering.html"><a href="k-means-clustering.html"><i class="fa fa-check"></i><b>6.1</b> K-means clustering</a><ul>
<li class="chapter" data-level="6.1.1" data-path="k-means-clustering.html"><a href="k-means-clustering.html#studentresponses"><i class="fa fa-check"></i><b>6.1.1</b> Grouping Student Responses</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="the-silhouette-index.html"><a href="the-silhouette-index.html"><i class="fa fa-check"></i><b>6.2</b> The Silhouette Index</a></li>
<li class="chapter" data-level="6.3" data-path="associationrules.html"><a href="associationrules.html"><i class="fa fa-check"></i><b>6.3</b> Mining Association Rules</a><ul>
<li class="chapter" data-level="6.3.1" data-path="associationrules.html"><a href="associationrules.html#finding-rules-for-criminal-behavior"><i class="fa fa-check"></i><b>6.3.1</b> Finding Rules for Criminal Behavior</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="SummaryUnsupervised.html"><a href="SummaryUnsupervised.html"><i class="fa fa-check"></i><b>6.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="representations.html"><a href="representations.html"><i class="fa fa-check"></i><b>7</b> Encoding Behavioral Data</a><ul>
<li class="chapter" data-level="7.1" data-path="feature-vectors.html"><a href="feature-vectors.html"><i class="fa fa-check"></i><b>7.1</b> Feature Vectors</a></li>
<li class="chapter" data-level="7.2" data-path="sectimeseries.html"><a href="sectimeseries.html"><i class="fa fa-check"></i><b>7.2</b> Timeseries</a></li>
<li class="chapter" data-level="7.3" data-path="transactions.html"><a href="transactions.html"><i class="fa fa-check"></i><b>7.3</b> Transactions</a></li>
<li class="chapter" data-level="7.4" data-path="images.html"><a href="images.html"><i class="fa fa-check"></i><b>7.4</b> Images</a></li>
<li class="chapter" data-level="7.5" data-path="recurrence-plots.html"><a href="recurrence-plots.html"><i class="fa fa-check"></i><b>7.5</b> Recurrence Plots</a><ul>
<li class="chapter" data-level="7.5.1" data-path="recurrence-plots.html"><a href="recurrence-plots.html#computing-recurence-plots"><i class="fa fa-check"></i><b>7.5.1</b> Computing Recurence Plots</a></li>
<li class="chapter" data-level="7.5.2" data-path="recurrence-plots.html"><a href="recurrence-plots.html#recurrence-plots-of-hand-gestures"><i class="fa fa-check"></i><b>7.5.2</b> Recurrence Plots of Hand Gestures</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="bag-of-words.html"><a href="bag-of-words.html"><i class="fa fa-check"></i><b>7.6</b> Bag-of-Words</a><ul>
<li class="chapter" data-level="7.6.1" data-path="bag-of-words.html"><a href="bag-of-words.html#bow-for-complex-activities."><i class="fa fa-check"></i><b>7.6.1</b> BoW for Complex Activities.</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="graphs.html"><a href="graphs.html"><i class="fa fa-check"></i><b>7.7</b> Graphs</a><ul>
<li class="chapter" data-level="7.7.1" data-path="graphs.html"><a href="graphs.html#complex-activities-as-graphs"><i class="fa fa-check"></i><b>7.7.1</b> Complex Activities as Graphs</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="SummaryRepresentations.html"><a href="SummaryRepresentations.html"><i class="fa fa-check"></i><b>7.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="deeplearning.html"><a href="deeplearning.html"><i class="fa fa-check"></i><b>8</b> Predicting Behavior with Deep Learning</a><ul>
<li class="chapter" data-level="8.1" data-path="ann.html"><a href="ann.html"><i class="fa fa-check"></i><b>8.1</b> Introduction to Artificial Neural Networks</a><ul>
<li class="chapter" data-level="8.1.1" data-path="ann.html"><a href="ann.html#sigmoid-and-relu-units"><i class="fa fa-check"></i><b>8.1.1</b> Sigmoid and ReLU Units</a></li>
<li class="chapter" data-level="8.1.2" data-path="ann.html"><a href="ann.html#assembling-units-into-layers"><i class="fa fa-check"></i><b>8.1.2</b> Assembling Units into Layers</a></li>
<li class="chapter" data-level="8.1.3" data-path="ann.html"><a href="ann.html#deep-neural-networks"><i class="fa fa-check"></i><b>8.1.3</b> Deep Neural Networks</a></li>
<li class="chapter" data-level="8.1.4" data-path="ann.html"><a href="ann.html#learning-the-parameters"><i class="fa fa-check"></i><b>8.1.4</b> Learning the Parameters</a></li>
<li class="chapter" data-level="8.1.5" data-path="ann.html"><a href="ann.html#parameter-learning-example-in-r"><i class="fa fa-check"></i><b>8.1.5</b> Parameter Learning Example in R</a></li>
<li class="chapter" data-level="8.1.6" data-path="ann.html"><a href="ann.html#stochastic-gradient-descent"><i class="fa fa-check"></i><b>8.1.6</b> Stochastic Gradient Descent</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="keras-and-tensorflow-with-r.html"><a href="keras-and-tensorflow-with-r.html"><i class="fa fa-check"></i><b>8.2</b> Keras and TensorFlow with R</a><ul>
<li class="chapter" data-level="8.2.1" data-path="keras-and-tensorflow-with-r.html"><a href="keras-and-tensorflow-with-r.html#keras-example"><i class="fa fa-check"></i><b>8.2.1</b> Keras Example</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="classification-with-neural-networks.html"><a href="classification-with-neural-networks.html"><i class="fa fa-check"></i><b>8.3</b> Classification with Neural Networks</a><ul>
<li class="chapter" data-level="8.3.1" data-path="classification-with-neural-networks.html"><a href="classification-with-neural-networks.html#classification-of-electromyography-signals"><i class="fa fa-check"></i><b>8.3.1</b> Classification of Electromyography Signals</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>8.4</b> Overfitting</a><ul>
<li class="chapter" data-level="8.4.1" data-path="overfitting.html"><a href="overfitting.html#early-stopping"><i class="fa fa-check"></i><b>8.4.1</b> Early Stopping</a></li>
<li class="chapter" data-level="8.4.2" data-path="overfitting.html"><a href="overfitting.html#dropout"><i class="fa fa-check"></i><b>8.4.2</b> Dropout</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="fine-tuning-a-neural-network.html"><a href="fine-tuning-a-neural-network.html"><i class="fa fa-check"></i><b>8.5</b> Fine-Tuning a Neural Network</a></li>
<li class="chapter" data-level="8.6" data-path="cnns.html"><a href="cnns.html"><i class="fa fa-check"></i><b>8.6</b> Convolutional Neural Networks</a><ul>
<li class="chapter" data-level="8.6.1" data-path="cnns.html"><a href="cnns.html#convolutions"><i class="fa fa-check"></i><b>8.6.1</b> Convolutions</a></li>
<li class="chapter" data-level="8.6.2" data-path="cnns.html"><a href="cnns.html#pooling-operations"><i class="fa fa-check"></i><b>8.6.2</b> Pooling Operations</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="cnns-with-keras.html"><a href="cnns-with-keras.html"><i class="fa fa-check"></i><b>8.7</b> CNNs with Keras</a><ul>
<li class="chapter" data-level="8.7.1" data-path="cnns-with-keras.html"><a href="cnns-with-keras.html#example-1"><i class="fa fa-check"></i><b>8.7.1</b> Example 1</a></li>
<li class="chapter" data-level="8.7.2" data-path="cnns-with-keras.html"><a href="cnns-with-keras.html#example-2"><i class="fa fa-check"></i><b>8.7.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="cnnSmile.html"><a href="cnnSmile.html"><i class="fa fa-check"></i><b>8.8</b> Smiles Detection with a CNN</a></li>
<li class="chapter" data-level="8.9" data-path="SummaryDeepLearning.html"><a href="SummaryDeepLearning.html"><i class="fa fa-check"></i><b>8.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multiuser.html"><a href="multiuser.html"><i class="fa fa-check"></i><b>9</b> Multi-User Validation</a><ul>
<li class="chapter" data-level="9.1" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i><b>9.1</b> Mixed Models</a><ul>
<li class="chapter" data-level="9.1.1" data-path="mixed-models.html"><a href="mixed-models.html#skeleton-action-recognition-with-mixed-models"><i class="fa fa-check"></i><b>9.1.1</b> Skeleton Action Recognition with Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="user-independent-models.html"><a href="user-independent-models.html"><i class="fa fa-check"></i><b>9.2</b> User-Independent Models</a></li>
<li class="chapter" data-level="9.3" data-path="user-dependent-models.html"><a href="user-dependent-models.html"><i class="fa fa-check"></i><b>9.3</b> User-Dependent Models</a></li>
<li class="chapter" data-level="9.4" data-path="user-adaptive-models.html"><a href="user-adaptive-models.html"><i class="fa fa-check"></i><b>9.4</b> User-Adaptive Models</a><ul>
<li class="chapter" data-level="9.4.1" data-path="user-adaptive-models.html"><a href="user-adaptive-models.html#transfer-learning"><i class="fa fa-check"></i><b>9.4.1</b> Transfer Learning</a></li>
<li class="chapter" data-level="9.4.2" data-path="user-adaptive-models.html"><a href="user-adaptive-models.html#a-user-adaptive-model-for-activity-recognition"><i class="fa fa-check"></i><b>9.4.2</b> A User-Adaptive Model for Activity Recognition</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="SummaryMultiUser.html"><a href="SummaryMultiUser.html"><i class="fa fa-check"></i><b>9.5</b> Summary</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendixInstall.html"><a href="appendixInstall.html"><i class="fa fa-check"></i><b>A</b> Setup Your Environment</a><ul>
<li class="chapter" data-level="A.1" data-path="installing-the-datasets.html"><a href="installing-the-datasets.html"><i class="fa fa-check"></i><b>A.1</b> Installing the Datasets</a></li>
<li class="chapter" data-level="A.2" data-path="installing-the-examples-source-code.html"><a href="installing-the-examples-source-code.html"><i class="fa fa-check"></i><b>A.2</b> Installing the Examples Source Code</a></li>
<li class="chapter" data-level="A.3" data-path="installing-keras-and-tensorflow-.html"><a href="installing-keras-and-tensorflow-.html"><i class="fa fa-check"></i><b>A.3</b> Installing Keras and TensorFlow.</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendixDatasets.html"><a href="appendixDatasets.html"><i class="fa fa-check"></i><b>B</b> Datasets</a><ul>
<li class="chapter" data-level="B.1" data-path="complex-activities.html"><a href="complex-activities.html"><i class="fa fa-check"></i><b>B.1</b> COMPLEX ACTIVITIES</a></li>
<li class="chapter" data-level="B.2" data-path="depresjon.html"><a href="depresjon.html"><i class="fa fa-check"></i><b>B.2</b> DEPRESJON</a></li>
<li class="chapter" data-level="B.3" data-path="electromyography.html"><a href="electromyography.html"><i class="fa fa-check"></i><b>B.3</b> ELECTROMYOGRAPHY</a></li>
<li class="chapter" data-level="B.4" data-path="hand-gestures.html"><a href="hand-gestures.html"><i class="fa fa-check"></i><b>B.4</b> HAND GESTURES</a></li>
<li class="chapter" data-level="B.5" data-path="home-tasks.html"><a href="home-tasks.html"><i class="fa fa-check"></i><b>B.5</b> HOME TASKS</a></li>
<li class="chapter" data-level="B.6" data-path="homicide-reports.html"><a href="homicide-reports.html"><i class="fa fa-check"></i><b>B.6</b> HOMICIDE REPORTS</a></li>
<li class="chapter" data-level="B.7" data-path="indoor-location.html"><a href="indoor-location.html"><i class="fa fa-check"></i><b>B.7</b> INDOOR LOCATION</a></li>
<li class="chapter" data-level="B.8" data-path="sheep-goats.html"><a href="sheep-goats.html"><i class="fa fa-check"></i><b>B.8</b> SHEEP GOATS</a></li>
<li class="chapter" data-level="B.9" data-path="skeleton-actions.html"><a href="skeleton-actions.html"><i class="fa fa-check"></i><b>B.9</b> SKELETON ACTIONS</a></li>
<li class="chapter" data-level="B.10" data-path="smartphone-activities.html"><a href="smartphone-activities.html"><i class="fa fa-check"></i><b>B.10</b> SMARTPHONE ACTIVITIES</a></li>
<li class="chapter" data-level="B.11" data-path="smiles.html"><a href="smiles.html"><i class="fa fa-check"></i><b>B.11</b> SMILES</a></li>
<li class="chapter" data-level="B.12" data-path="students-mental-health.html"><a href="students-mental-health.html"><i class="fa fa-check"></i><b>B.12</b> STUDENTS’ MENTAL HEALTH</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="citing-this-book.html"><a href="citing-this-book.html"><i class="fa fa-check"></i>Citing this Book</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Behavior Analysis with Machine Learning and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mixed-models" class="section level2">
<h2><span class="header-section-number">9.1</span> Mixed Models</h2>
<p>Mixed models are trained and validated as usual without considering information about mappings between data points and users. Suppose we have a dataset as shown in Figure <a href="mixed-models.html#fig:tblMixModel">9.1</a>. The first column is the user id, the second column the label we want to predict and the last two columns are two arbitrary features.</p>
<div class="figure" style="text-align: center"><span id="fig:tblMixModel"></span>
<img src="images/table_mix_model.png" alt="Example dataset with a binary label and 2 features." width="30%" />
<p class="caption">
Figure 9.1: Example dataset with a binary label and 2 features.
</p>
</div>
<p>With a mixed model we would just remove the <em>userid</em> column and perform <span class="math inline">\(k\)</span>-fold cross-validation or hold-out validation as usual. In fact, this is what we have been doing so far. By doing so, some random data points will end up in the train set and others in the test set regardless of which data point was generated by which user. The user rows are just <em>mixed</em>, thus the <em>mixed model</em> name. This model assumes that the data was generated by a single user. One of the disadvantages of validating a system using a mixed model is that the performance results could be overestimated. When randomly splitting into train and test sets, some data points for a given user will end up in each of the splits. At inference time, when showing a test sample belonging to a particular user to the model, it is likely that the training set of that model included some data from that particular user. Thus, the model already knows a little bit about that user so we can expect an accurate prediction. However, this assumption not always holds true. If the model is to be used on a <strong>new user</strong> that the model has never seen before, then, it may not produce very accurate predictions.</p>
<p><strong>When should a mixed model be used to validate a system?</strong></p>
<ol style="list-style-type: decimal">
<li>When you know that you will have some available data to train the model for all the users that are intended to use the system.</li>
<li>In many cases, a dataset has already missing information about the mapping between rows and users. That is, a <em>userid</em> column is not present. In those cases, the best performance estimation would be through the use of a mixed model.</li>
</ol>
<p>To demonstrate the differences between the different types of models (mixed, user-independent, and user-dependent) I will use the <em>SKELETON ACTIONS</em> dataset. First, a brief description of the dataset is presented including details about how the features were extracted. Then, the dataset is used to train a mixed model and in the following subsections, it is used to train user-independent and user-dependent models.</p>
<div id="skeleton-action-recognition-with-mixed-models" class="section level3">
<h3><span class="header-section-number">9.1.1</span> Skeleton Action Recognition with Mixed Models</h3>

<div class="rmdfolder">
<code>preprocess_skeleton_actions.R</code> <code>classify_skeleton_actions.R</code>
</div>

<p>To demonstrate the <span class="math inline">\(3\)</span> different types of models I chose the <strong>UTD-MHAD dataset</strong> <span class="citation">(Chen, Jafari, and Kehtarnavaz <a href="#ref-chen2015utd" role="doc-biblioref">2015</a>)</span> and from now on, I will refer to it as the <em>SKELETON ACTIONS</em> dataset. This database is suitable because it was collected by <span class="math inline">\(8\)</span> persons (<span class="math inline">\(4\)</span> females/<span class="math inline">\(4\)</span> males) and each file has a subject id, thus, we know which actions were collected by which users. The number of actions is <span class="math inline">\(27\)</span> and some of the actions are: <em>‘right-hand wave’</em>, <em>‘two hand front clap’</em>, <em>‘basketball shoot’</em>, <em>‘front boxing’</em>, etc.</p>
<p>The data was recorded using a Kinect camera and an inertial sensor unit and each subject repeated each of the <span class="math inline">\(27\)</span> actions <span class="math inline">\(4\)</span> times. More information about the collection process and pictures can be consulted on the original dataset website <a href="https://personal.utdallas.edu/~kehtar/UTD-MHAD.html" class="uri">https://personal.utdallas.edu/~kehtar/UTD-MHAD.html</a>.</p>
<p>For our examples, I will only focus on the <em>skeleton data</em> generated by the Kinect camera. These data consists of human body joints (<span class="math inline">\(20\)</span> joints). Each file contains one action for one user and one repetition. The file names have the structure <code>aA_sS_tT_skeleton.mat</code>. The <code>A</code> is the action id, the <code>S</code> is the subject id and the <code>T</code> is the trial (repetition) number. For each time frame, the <span class="math inline">\(3\)</span>D positions of the <span class="math inline">\(20\)</span> joints are recorded.</p>
<p>The script <code>preprocess_skeleton_actions.R</code> shows how to read the files and plot the actions. The files are stored in Matlab format. The library <code>R.matlab</code> <span class="citation">(Bengtsson <a href="#ref-rmatlab" role="doc-biblioref">2018</a>)</span> can be used to read the files.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="mixed-models.html#cb166-1"></a><span class="co"># Path to one of the files.</span></span>
<span id="cb166-2"><a href="mixed-models.html#cb166-2"></a>filepath &lt;-<span class="st"> &quot;/skeleton_actions/a7_s1_t1_skeleton.mat&quot;</span></span>
<span id="cb166-3"><a href="mixed-models.html#cb166-3"></a></span>
<span id="cb166-4"><a href="mixed-models.html#cb166-4"></a><span class="co"># Read skeleton file.</span></span>
<span id="cb166-5"><a href="mixed-models.html#cb166-5"></a>df &lt;-<span class="st"> </span><span class="kw">readMat</span>(filepath)<span class="op">$</span>d.skel</span>
<span id="cb166-6"><a href="mixed-models.html#cb166-6"></a></span>
<span id="cb166-7"><a href="mixed-models.html#cb166-7"></a><span class="co"># Print dimensions.</span></span>
<span id="cb166-8"><a href="mixed-models.html#cb166-8"></a><span class="kw">dim</span>(df)</span>
<span id="cb166-9"><a href="mixed-models.html#cb166-9"></a><span class="co">#&gt; [1] 20  3 66</span></span></code></pre></div>
<p>From the file name, we can see that this corresponds to action <span class="math inline">\(7\)</span> (basketball shoot), from subject <span class="math inline">\(1\)</span> and trial <span class="math inline">\(1\)</span>. The <code>readMat()</code> function is used to read the file contents and store them as a <span class="math inline">\(3\)</span>D array in <code>df</code>. If we print the dimensions we see that the first one corresponds to the number of joints, the second one are the positions (<em>x</em>, <em>y</em>, <em>z</em>), and the last dimension is the number of frames, in this case <span class="math inline">\(66\)</span> frames.</p>
<p>We can extract the first time-frame as follows:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="mixed-models.html#cb167-1"></a><span class="co"># Select the first frame.</span></span>
<span id="cb167-2"><a href="mixed-models.html#cb167-2"></a>frame &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df[, , <span class="dv">1</span>])</span>
<span id="cb167-3"><a href="mixed-models.html#cb167-3"></a></span>
<span id="cb167-4"><a href="mixed-models.html#cb167-4"></a><span class="co"># Print dimensions.</span></span>
<span id="cb167-5"><a href="mixed-models.html#cb167-5"></a><span class="kw">dim</span>(frame)</span>
<span id="cb167-6"><a href="mixed-models.html#cb167-6"></a><span class="co">#&gt; [1] 20  3</span></span></code></pre></div>
<p>Each frame can then be plotted. The plotting code is included in the script. The Figure below shows how the skeleton looks like for <span class="math inline">\(6\)</span> of the time frames. The script also has code to play the action as an animation.</p>
<div class="figure" style="text-align: center"><span id="fig:sklBasket"></span>
<img src="images/skl_basket.png" alt="Skeleton of basketball shoot action. 6 frames sampled from the entire sequence." width="100%" />
<p class="caption">
Figure 9.2: Skeleton of basketball shoot action. 6 frames sampled from the entire sequence.
</p>
</div>
<p>We will represent each action (file) as a feature vector. The same script also shows the code to extract the feature vectors from each action. To extract the features, a reference point in the skeleton is selected, in this case the spine (joint <span class="math inline">\(3\)</span>). Then, for each time frame, the distance between all joints (excluding the reference point) and the reference point is calculated. Finally, for each distance, the <em>mean</em>, <em>min</em>, and <em>max</em> are computed across all time frames. Since there are <span class="math inline">\(19\)</span> joints (excluding the spine), we end up with <span class="math inline">\(19*3=57\)</span> features. Figure <a href="mixed-models.html#fig:sklFeatures">9.3</a> shows how the final dataset looks like. Only showing the first <span class="math inline">\(4\)</span> features out of the <span class="math inline">\(57\)</span> and user id and labels.</p>
<div class="figure" style="text-align: center"><span id="fig:sklFeatures"></span>
<img src="images/skl_features.png" alt="First rows of the skeleton dataset after feature extraction showing the first 4 features." width="60%" />
<p class="caption">
Figure 9.3: First rows of the skeleton dataset after feature extraction showing the first 4 features.
</p>
</div>

<div class="rmdgoodpractice">
The following examples assume that the file <em>dataset.csv</em> with the extracted features already exsits in the <code>skeleton_actions/</code> directory. To generate this file, run the feature extraction code in the script <code>preprocess_skeleton_actions.R</code>.
</div>

<p>Once the dataset in a suitable format, we can proceed to <strong>train our mixed model</strong>. The script containing the full code for training the different types of models is <code>classify_skeleton_actions.R</code>. This script makes use of the <em>dataset.csv</em> file.</p>
<p>First, the auxiliary functions are loaded because we will use the <code>normalize()</code> function to normalize the data. We will use a Random Forest for the classification and the <code>caret</code> package to compute the performance metrics.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="mixed-models.html#cb168-1"></a><span class="kw">source</span>(<span class="kw">file.path</span>(<span class="st">&quot;..&quot;</span>,<span class="st">&quot;auxiliary_functions&quot;</span>,<span class="st">&quot;globals.R&quot;</span>))</span>
<span id="cb168-2"><a href="mixed-models.html#cb168-2"></a><span class="kw">source</span>(<span class="kw">file.path</span>(<span class="st">&quot;..&quot;</span>,<span class="st">&quot;auxiliary_functions&quot;</span>,<span class="st">&quot;functions.R&quot;</span>))</span>
<span id="cb168-3"><a href="mixed-models.html#cb168-3"></a><span class="kw">library</span>(randomForest)</span>
<span id="cb168-4"><a href="mixed-models.html#cb168-4"></a><span class="kw">library</span>(caret)</span>
<span id="cb168-5"><a href="mixed-models.html#cb168-5"></a></span>
<span id="cb168-6"><a href="mixed-models.html#cb168-6"></a><span class="co"># Path to the csv file containing the extracted features.</span></span>
<span id="cb168-7"><a href="mixed-models.html#cb168-7"></a><span class="co"># preprocess_skeleton_actins.R contains</span></span>
<span id="cb168-8"><a href="mixed-models.html#cb168-8"></a><span class="co"># the code used to extract the features.</span></span>
<span id="cb168-9"><a href="mixed-models.html#cb168-9"></a>filepath &lt;-<span class="st"> </span><span class="kw">file.path</span>(datasets_path,</span>
<span id="cb168-10"><a href="mixed-models.html#cb168-10"></a>                      <span class="st">&quot;skeleton_actions&quot;</span>,</span>
<span id="cb168-11"><a href="mixed-models.html#cb168-11"></a>                      <span class="st">&quot;dataset.csv&quot;</span>)</span>
<span id="cb168-12"><a href="mixed-models.html#cb168-12"></a><span class="co"># Load dataset.</span></span>
<span id="cb168-13"><a href="mixed-models.html#cb168-13"></a>dataset &lt;-<span class="st"> </span><span class="kw">read.csv</span>(filepath, <span class="dt">stringsAsFactors =</span> T)</span>
<span id="cb168-14"><a href="mixed-models.html#cb168-14"></a></span>
<span id="cb168-15"><a href="mixed-models.html#cb168-15"></a><span class="co"># Extract unique labels.</span></span>
<span id="cb168-16"><a href="mixed-models.html#cb168-16"></a>unique.actions &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">unique</span>(dataset<span class="op">$</span>label))</span>
<span id="cb168-17"><a href="mixed-models.html#cb168-17"></a></span>
<span id="cb168-18"><a href="mixed-models.html#cb168-18"></a><span class="co"># Print the unique labels.</span></span>
<span id="cb168-19"><a href="mixed-models.html#cb168-19"></a><span class="kw">print</span>(unique.actions)</span>
<span id="cb168-20"><a href="mixed-models.html#cb168-20"></a><span class="co">#&gt;  [1] &quot;a1&quot;  &quot;a10&quot; &quot;a11&quot; &quot;a12&quot; &quot;a13&quot; &quot;a14&quot; &quot;a15&quot; &quot;a16&quot; &quot;a17&quot;</span></span>
<span id="cb168-21"><a href="mixed-models.html#cb168-21"></a><span class="co">#&gt; [10] &quot;a18&quot; &quot;a19&quot; &quot;a2&quot;  &quot;a20&quot; &quot;a21&quot; &quot;a22&quot; &quot;a23&quot; &quot;a24&quot; &quot;a25&quot;</span></span>
<span id="cb168-22"><a href="mixed-models.html#cb168-22"></a><span class="co">#&gt; [19] &quot;a26&quot; &quot;a27&quot; &quot;a3&quot;  &quot;a4&quot;  &quot;a5&quot;  &quot;a6&quot;  &quot;a7&quot;  &quot;a8&quot;  &quot;a9&quot; </span></span></code></pre></div>
<p>The <code>unique.actions</code> variable stores the name of all actions. We will need it later to define the levels of the factor object. Next, we generate <span class="math inline">\(10\)</span> folds and define some variables to store the performance metrics including the <em>accuracy</em>, <em>recall</em>, and <em>precision</em>. In each iteration during cross-validation, we will compute and store those performance metrics.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="mixed-models.html#cb169-1"></a>k &lt;-<span class="st"> </span><span class="dv">10</span> <span class="co"># Number of folds.</span></span>
<span id="cb169-2"><a href="mixed-models.html#cb169-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb169-3"><a href="mixed-models.html#cb169-3"></a>folds &lt;-<span class="st"> </span><span class="kw">sample</span>(k, <span class="kw">nrow</span>(dataset), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb169-4"><a href="mixed-models.html#cb169-4"></a>accuracies &lt;-<span class="st"> </span><span class="ot">NULL</span>; recalls &lt;-<span class="st"> </span><span class="ot">NULL</span>; precisions &lt;-<span class="st"> </span><span class="ot">NULL</span></span></code></pre></div>
<p>In the next code snippet, the actual cross-validation is performed. This is just the usual cross-validation procedure. The <code>normalize()</code> function defined in the auxiliary functions is used to normalize the data by only learning the parameters from the train set and applying them to the test set. Then, the actual Random Forest is fitted with the train set. One thing to note here is that the <code>userid</code> field is removed: <code>trainset[,-1]</code> since we are not using users’ information in the mixed model. Then, predictions on the test set are obtained and the accuracy, recall, and precision are computed during each iteration.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="mixed-models.html#cb170-1"></a><span class="co"># Perform k-fold cross-validation.</span></span>
<span id="cb170-2"><a href="mixed-models.html#cb170-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb170-3"><a href="mixed-models.html#cb170-3"></a>  </span>
<span id="cb170-4"><a href="mixed-models.html#cb170-4"></a>  trainset &lt;-<span class="st"> </span>dataset[<span class="kw">which</span>(folds <span class="op">!=</span><span class="st"> </span>i,),]</span>
<span id="cb170-5"><a href="mixed-models.html#cb170-5"></a>  testset &lt;-<span class="st"> </span>dataset[<span class="kw">which</span>(folds <span class="op">==</span><span class="st"> </span>i,),]</span>
<span id="cb170-6"><a href="mixed-models.html#cb170-6"></a>  </span>
<span id="cb170-7"><a href="mixed-models.html#cb170-7"></a>  <span class="co">#Normalize.</span></span>
<span id="cb170-8"><a href="mixed-models.html#cb170-8"></a>  res &lt;-<span class="st"> </span><span class="kw">normalize</span>(trainset, testset)</span>
<span id="cb170-9"><a href="mixed-models.html#cb170-9"></a>  trainset &lt;-<span class="st"> </span>res<span class="op">$</span>train</span>
<span id="cb170-10"><a href="mixed-models.html#cb170-10"></a>  testset &lt;-<span class="st"> </span>res<span class="op">$</span>test</span>
<span id="cb170-11"><a href="mixed-models.html#cb170-11"></a>    </span>
<span id="cb170-12"><a href="mixed-models.html#cb170-12"></a>  rf &lt;-<span class="st"> </span><span class="kw">randomForest</span>(label <span class="op">~</span>., trainset[,<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb170-13"><a href="mixed-models.html#cb170-13"></a>  preds.rf &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">predict</span>(rf,</span>
<span id="cb170-14"><a href="mixed-models.html#cb170-14"></a>                                   <span class="dt">newdata =</span> testset[,<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb170-15"><a href="mixed-models.html#cb170-15"></a>  groundTruth &lt;-<span class="st"> </span><span class="kw">as.character</span>(testset<span class="op">$</span>label)</span>
<span id="cb170-16"><a href="mixed-models.html#cb170-16"></a>  cm.rf &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(<span class="kw">factor</span>(preds.rf,</span>
<span id="cb170-17"><a href="mixed-models.html#cb170-17"></a>                                  <span class="dt">levels =</span> unique.actions),</span>
<span id="cb170-18"><a href="mixed-models.html#cb170-18"></a>                           <span class="kw">factor</span>(groundTruth,</span>
<span id="cb170-19"><a href="mixed-models.html#cb170-19"></a>                                  <span class="dt">levels =</span> unique.actions))</span>
<span id="cb170-20"><a href="mixed-models.html#cb170-20"></a>  </span>
<span id="cb170-21"><a href="mixed-models.html#cb170-21"></a>  accuracies &lt;-<span class="st"> </span><span class="kw">c</span>(accuracies, cm.rf<span class="op">$</span>overall[<span class="st">&quot;Accuracy&quot;</span>])</span>
<span id="cb170-22"><a href="mixed-models.html#cb170-22"></a>  metrics &lt;-<span class="st"> </span><span class="kw">colMeans</span>(cm.rf<span class="op">$</span>byClass[,<span class="kw">c</span>(<span class="st">&quot;Recall&quot;</span>,</span>
<span id="cb170-23"><a href="mixed-models.html#cb170-23"></a>                                       <span class="st">&quot;Specificity&quot;</span>,</span>
<span id="cb170-24"><a href="mixed-models.html#cb170-24"></a>                                       <span class="st">&quot;Precision&quot;</span>,</span>
<span id="cb170-25"><a href="mixed-models.html#cb170-25"></a>                                       <span class="st">&quot;F1&quot;</span>)],</span>
<span id="cb170-26"><a href="mixed-models.html#cb170-26"></a>                      <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb170-27"><a href="mixed-models.html#cb170-27"></a>  recalls &lt;-<span class="st"> </span><span class="kw">c</span>(recalls, metrics[<span class="st">&quot;Recall&quot;</span>])</span>
<span id="cb170-28"><a href="mixed-models.html#cb170-28"></a>  precisions &lt;-<span class="st"> </span><span class="kw">c</span>(precisions, metrics[<span class="st">&quot;Precision&quot;</span>])</span>
<span id="cb170-29"><a href="mixed-models.html#cb170-29"></a>}</span></code></pre></div>
<p>Finally, the average performance across folds of each of the metrics is printed.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="mixed-models.html#cb171-1"></a><span class="co"># Print performance metrics.</span></span>
<span id="cb171-2"><a href="mixed-models.html#cb171-2"></a><span class="kw">mean</span>(accuracies)</span>
<span id="cb171-3"><a href="mixed-models.html#cb171-3"></a><span class="co">#&gt; [1] 0.9277258</span></span>
<span id="cb171-4"><a href="mixed-models.html#cb171-4"></a><span class="kw">mean</span>(recalls)</span>
<span id="cb171-5"><a href="mixed-models.html#cb171-5"></a><span class="co">#&gt; [1] 0.9372515</span></span>
<span id="cb171-6"><a href="mixed-models.html#cb171-6"></a><span class="kw">mean</span>(precisions)</span>
<span id="cb171-7"><a href="mixed-models.html#cb171-7"></a><span class="co">#&gt; [1] 0.9208455</span></span></code></pre></div>
<p>The results look promising with an average <em>accuracy</em> of <span class="math inline">\(92.7\%\)</span>, a <em>recall</em> of <span class="math inline">\(93.7\%\)</span>, and a <em>precision</em> of <span class="math inline">\(92\%\)</span>. One important thing to remember is that the mixed model assumes that the training data contains instances belonging to users in the test set. Thus, the model already knows a little bit about the users in the test set.</p>
<p>Imagine that now you want to estimate what would be the performance of the model in a situation where a completely new user is shown to the model, that is, the model does not know anything about this user. We can model these situations using a <strong>user-independent model</strong> which is the topic of the next section.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-rmatlab">
<p>Bengtsson, Henrik. 2018. <em>R.matlab: Read and Write Mat Files and Call Matlab from Within R</em>. <a href="https://CRAN.R-project.org/package=R.matlab">https://CRAN.R-project.org/package=R.matlab</a>.</p>
</div>
<div id="ref-chen2015utd">
<p>Chen, Chen, Roozbeh Jafari, and Nasser Kehtarnavaz. 2015. “UTD-Mhad: A Multimodal Dataset for Human Action Recognition Utilizing a Depth Camera and a Wearable Inertial Sensor.” In <em>2015 Ieee International Conference on Image Processing (Icip)</em>, 168–72. IEEE.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiuser.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="user-independent-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
