<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.4 Multi-view Stacking for Home Tasks Recognition | Behavior Analysis with Machine Learning and R</title>
  <meta name="description" content="3.4 Multi-view Stacking for Home Tasks Recognition | Behavior Analysis with Machine Learning and R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="3.4 Multi-view Stacking for Home Tasks Recognition | Behavior Analysis with Machine Learning and R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="3.4 Multi-view Stacking for Home Tasks Recognition | Behavior Analysis with Machine Learning and R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.4 Multi-view Stacking for Home Tasks Recognition | Behavior Analysis with Machine Learning and R" />
  
  <meta name="twitter:description" content="3.4 Multi-view Stacking for Home Tasks Recognition | Behavior Analysis with Machine Learning and R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Enrique Garcia Ceja" />


<meta name="date" content="2020-09-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stacked-generalization.html"/>
<link rel="next" href="SummaryEnsemble.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/d3-4.9.0/d3.min.js"></script>
<script src="libs/d3-tip-0.7.1/index-min.js"></script>
<link href="libs/d3panels-1.4.9/d3panels.min.css" rel="stylesheet" />
<script src="libs/d3panels-1.4.9/d3panels.min.js"></script>
<script src="libs/qtlcharts_iplotCorr-0.11.6/iplotCorr.js"></script>
<script src="libs/qtlcharts_iplotCorr-0.11.6/iplotCorr_noscat.js"></script>
<script src="libs/iplotCorr-binding-0.11.6/iplotCorr.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-178679335-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-178679335-1', { 'anonymize_ip': true });
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="#">Behavior Analysis with Machine Learning and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#supplemental-material"><i class="fa fa-check"></i>Supplemental Material</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html"><i class="fa fa-check"></i><b>1.1</b> What is Machine Learning?</a></li>
<li class="chapter" data-level="1.2" data-path="taxonomy.html"><a href="taxonomy.html"><i class="fa fa-check"></i><b>1.2</b> Types of Machine Learning</a></li>
<li class="chapter" data-level="1.3" data-path="terminology.html"><a href="terminology.html"><i class="fa fa-check"></i><b>1.3</b> Terminology</a><ul>
<li class="chapter" data-level="1.3.1" data-path="terminology.html"><a href="terminology.html#tables"><i class="fa fa-check"></i><b>1.3.1</b> Tables</a></li>
<li class="chapter" data-level="1.3.2" data-path="terminology.html"><a href="terminology.html#variable-types"><i class="fa fa-check"></i><b>1.3.2</b> Variable Types</a></li>
<li class="chapter" data-level="1.3.3" data-path="terminology.html"><a href="terminology.html#predictive-models"><i class="fa fa-check"></i><b>1.3.3</b> Predictive Models</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="pipeline.html"><a href="pipeline.html"><i class="fa fa-check"></i><b>1.4</b> Data Analysis Pipeline</a></li>
<li class="chapter" data-level="1.5" data-path="trainingeval.html"><a href="trainingeval.html"><i class="fa fa-check"></i><b>1.5</b> Evaluating Predictive Models</a></li>
<li class="chapter" data-level="1.6" data-path="simple-classification-example.html"><a href="simple-classification-example.html"><i class="fa fa-check"></i><b>1.6</b> Simple Classification Example</a><ul>
<li class="chapter" data-level="1.6.1" data-path="simple-classification-example.html"><a href="simple-classification-example.html#k-fold-cross-validation-example"><i class="fa fa-check"></i><b>1.6.1</b> K-fold Cross-Validation Example</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="simple-regression-example.html"><a href="simple-regression-example.html"><i class="fa fa-check"></i><b>1.7</b> Simple Regression Example</a></li>
<li class="chapter" data-level="1.8" data-path="underfitting-and-overfitting.html"><a href="underfitting-and-overfitting.html"><i class="fa fa-check"></i><b>1.8</b> Underfitting and Overfitting</a></li>
<li class="chapter" data-level="1.9" data-path="bias-and-variance.html"><a href="bias-and-variance.html"><i class="fa fa-check"></i><b>1.9</b> Bias and Variance</a></li>
<li class="chapter" data-level="1.10" data-path="SummaryIntro.html"><a href="SummaryIntro.html"><i class="fa fa-check"></i><b>1.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>2</b> Predicting Behavior with Classification Models</a><ul>
<li class="chapter" data-level="2.1" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html"><i class="fa fa-check"></i><b>2.1</b> <em>k</em>-nearest Neighbors</a><ul>
<li class="chapter" data-level="2.1.1" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#indoor-location-with-wi-fi-signals"><i class="fa fa-check"></i><b>2.1.1</b> Indoor Location with Wi-Fi Signals</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="performance-metrics.html"><a href="performance-metrics.html"><i class="fa fa-check"></i><b>2.2</b> Performance Metrics</a></li>
<li class="chapter" data-level="2.3" data-path="decision-trees.html"><a href="decision-trees.html"><i class="fa fa-check"></i><b>2.3</b> Decision Trees</a><ul>
<li class="chapter" data-level="2.3.1" data-path="decision-trees.html"><a href="decision-trees.html#activityRecognition"><i class="fa fa-check"></i><b>2.3.1</b> Activity Recognition with Smartphones</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="dynamic-time-warping.html"><a href="dynamic-time-warping.html"><i class="fa fa-check"></i><b>2.4</b> Dynamic Time Warping</a><ul>
<li class="chapter" data-level="2.4.1" data-path="dynamic-time-warping.html"><a href="dynamic-time-warping.html#sechandgestures"><i class="fa fa-check"></i><b>2.4.1</b> Hand Gesture Recognition</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summaryClassification.html"><a href="summaryClassification.html"><i class="fa fa-check"></i><b>2.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ensemble.html"><a href="ensemble.html"><i class="fa fa-check"></i><b>3</b> Predicting Behavior with Ensemble Learning</a><ul>
<li class="chapter" data-level="3.1" data-path="bagging.html"><a href="bagging.html"><i class="fa fa-check"></i><b>3.1</b> Bagging</a><ul>
<li class="chapter" data-level="3.1.1" data-path="bagging.html"><a href="bagging.html#activity-recognition-with-bagging"><i class="fa fa-check"></i><b>3.1.1</b> Activity recognition with Bagging</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>3.2</b> Random Forest</a></li>
<li class="chapter" data-level="3.3" data-path="stacked-generalization.html"><a href="stacked-generalization.html"><i class="fa fa-check"></i><b>3.3</b> Stacked Generalization</a></li>
<li class="chapter" data-level="3.4" data-path="multiviewhometasks.html"><a href="multiviewhometasks.html"><i class="fa fa-check"></i><b>3.4</b> Multi-view Stacking for Home Tasks Recognition</a></li>
<li class="chapter" data-level="3.5" data-path="SummaryEnsemble.html"><a href="SummaryEnsemble.html"><i class="fa fa-check"></i><b>3.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="edavis.html"><a href="edavis.html"><i class="fa fa-check"></i><b>4</b> Exploring and Visualizing Behavioral Data</a><ul>
<li class="chapter" data-level="4.1" data-path="talking-with-field-experts.html"><a href="talking-with-field-experts.html"><i class="fa fa-check"></i><b>4.1</b> Talking with Field Experts</a></li>
<li class="chapter" data-level="4.2" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>4.2</b> Summary Statistics</a></li>
<li class="chapter" data-level="4.3" data-path="class-distributions.html"><a href="class-distributions.html"><i class="fa fa-check"></i><b>4.3</b> Class Distributions</a></li>
<li class="chapter" data-level="4.4" data-path="user-class-sparsity-matrix.html"><a href="user-class-sparsity-matrix.html"><i class="fa fa-check"></i><b>4.4</b> User-Class Sparsity Matrix</a></li>
<li class="chapter" data-level="4.5" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>4.5</b> Boxplots</a></li>
<li class="chapter" data-level="4.6" data-path="correlation-plots.html"><a href="correlation-plots.html"><i class="fa fa-check"></i><b>4.6</b> Correlation Plots</a><ul>
<li class="chapter" data-level="4.6.1" data-path="correlation-plots.html"><a href="correlation-plots.html#interactive-correlation-plots"><i class="fa fa-check"></i><b>4.6.1</b> Interactive Correlation Plots</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="timeseries.html"><a href="timeseries.html"><i class="fa fa-check"></i><b>4.7</b> Timeseries</a><ul>
<li class="chapter" data-level="4.7.1" data-path="timeseries.html"><a href="timeseries.html#interactive-timeseries"><i class="fa fa-check"></i><b>4.7.1</b> Interactive Timeseries</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html"><i class="fa fa-check"></i><b>4.8</b> Multidimensional Scaling (MDS)</a></li>
<li class="chapter" data-level="4.9" data-path="heatmaps.html"><a href="heatmaps.html"><i class="fa fa-check"></i><b>4.9</b> Heatmaps</a></li>
<li class="chapter" data-level="4.10" data-path="automated-eda.html"><a href="automated-eda.html"><i class="fa fa-check"></i><b>4.10</b> Automated EDA</a></li>
<li class="chapter" data-level="4.11" data-path="SummaryExploratory.html"><a href="SummaryExploratory.html"><i class="fa fa-check"></i><b>4.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="preprocessing.html"><a href="preprocessing.html"><i class="fa fa-check"></i><b>5</b> Preprocessing Behavioral Data</a><ul>
<li class="chapter" data-level="5.1" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>5.1</b> Missing Values</a><ul>
<li class="chapter" data-level="5.1.1" data-path="missing-values.html"><a href="missing-values.html#imputation"><i class="fa fa-check"></i><b>5.1.1</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="smoothing.html"><a href="smoothing.html"><i class="fa fa-check"></i><b>5.2</b> Smoothing</a></li>
<li class="chapter" data-level="5.3" data-path="normalization.html"><a href="normalization.html"><i class="fa fa-check"></i><b>5.3</b> Normalization</a></li>
<li class="chapter" data-level="5.4" data-path="imbalanced-classes.html"><a href="imbalanced-classes.html"><i class="fa fa-check"></i><b>5.4</b> Imbalanced Classes</a><ul>
<li class="chapter" data-level="5.4.1" data-path="imbalanced-classes.html"><a href="imbalanced-classes.html#random-oversampling"><i class="fa fa-check"></i><b>5.4.1</b> Random Oversampling</a></li>
<li class="chapter" data-level="5.4.2" data-path="imbalanced-classes.html"><a href="imbalanced-classes.html#smote"><i class="fa fa-check"></i><b>5.4.2</b> SMOTE</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="infoinjection.html"><a href="infoinjection.html"><i class="fa fa-check"></i><b>5.5</b> Information Injection</a></li>
<li class="chapter" data-level="5.6" data-path="one-hot-encoding.html"><a href="one-hot-encoding.html"><i class="fa fa-check"></i><b>5.6</b> One-hot Encoding</a></li>
<li class="chapter" data-level="5.7" data-path="SummaryPreprocessing.html"><a href="SummaryPreprocessing.html"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="unsupervised.html"><a href="unsupervised.html"><i class="fa fa-check"></i><b>6</b> Discovering Behaviors with Unsupervised Learning</a><ul>
<li class="chapter" data-level="6.1" data-path="k-means-clustering.html"><a href="k-means-clustering.html"><i class="fa fa-check"></i><b>6.1</b> K-means clustering</a><ul>
<li class="chapter" data-level="6.1.1" data-path="k-means-clustering.html"><a href="k-means-clustering.html#studentresponses"><i class="fa fa-check"></i><b>6.1.1</b> Grouping Student Responses</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="the-silhouette-index.html"><a href="the-silhouette-index.html"><i class="fa fa-check"></i><b>6.2</b> The Silhouette Index</a></li>
<li class="chapter" data-level="6.3" data-path="associationrules.html"><a href="associationrules.html"><i class="fa fa-check"></i><b>6.3</b> Mining Association Rules</a><ul>
<li class="chapter" data-level="6.3.1" data-path="associationrules.html"><a href="associationrules.html#finding-rules-for-criminal-behavior"><i class="fa fa-check"></i><b>6.3.1</b> Finding Rules for Criminal Behavior</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="SummaryUnsupervised.html"><a href="SummaryUnsupervised.html"><i class="fa fa-check"></i><b>6.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="representations.html"><a href="representations.html"><i class="fa fa-check"></i><b>7</b> Encoding Behavioral Data</a><ul>
<li class="chapter" data-level="7.1" data-path="feature-vectors.html"><a href="feature-vectors.html"><i class="fa fa-check"></i><b>7.1</b> Feature Vectors</a></li>
<li class="chapter" data-level="7.2" data-path="sectimeseries.html"><a href="sectimeseries.html"><i class="fa fa-check"></i><b>7.2</b> Timeseries</a></li>
<li class="chapter" data-level="7.3" data-path="transactions.html"><a href="transactions.html"><i class="fa fa-check"></i><b>7.3</b> Transactions</a></li>
<li class="chapter" data-level="7.4" data-path="images.html"><a href="images.html"><i class="fa fa-check"></i><b>7.4</b> Images</a></li>
<li class="chapter" data-level="7.5" data-path="recurrence-plots.html"><a href="recurrence-plots.html"><i class="fa fa-check"></i><b>7.5</b> Recurrence Plots</a><ul>
<li class="chapter" data-level="7.5.1" data-path="recurrence-plots.html"><a href="recurrence-plots.html#computing-recurence-plots"><i class="fa fa-check"></i><b>7.5.1</b> Computing Recurence Plots</a></li>
<li class="chapter" data-level="7.5.2" data-path="recurrence-plots.html"><a href="recurrence-plots.html#recurrence-plots-of-hand-gestures"><i class="fa fa-check"></i><b>7.5.2</b> Recurrence Plots of Hand Gestures</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="bag-of-words.html"><a href="bag-of-words.html"><i class="fa fa-check"></i><b>7.6</b> Bag-of-Words</a><ul>
<li class="chapter" data-level="7.6.1" data-path="bag-of-words.html"><a href="bag-of-words.html#bow-for-complex-activities."><i class="fa fa-check"></i><b>7.6.1</b> BoW for Complex Activities.</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="graphs.html"><a href="graphs.html"><i class="fa fa-check"></i><b>7.7</b> Graphs</a><ul>
<li class="chapter" data-level="7.7.1" data-path="graphs.html"><a href="graphs.html#complex-activities-as-graphs"><i class="fa fa-check"></i><b>7.7.1</b> Complex Activities as Graphs</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="SummaryRepresentations.html"><a href="SummaryRepresentations.html"><i class="fa fa-check"></i><b>7.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="deeplearning.html"><a href="deeplearning.html"><i class="fa fa-check"></i><b>8</b> Predicting Behavior with Deep Learning</a><ul>
<li class="chapter" data-level="8.1" data-path="ann.html"><a href="ann.html"><i class="fa fa-check"></i><b>8.1</b> Introduction to Artificial Neural Networks</a><ul>
<li class="chapter" data-level="8.1.1" data-path="ann.html"><a href="ann.html#sigmoid-and-relu-units"><i class="fa fa-check"></i><b>8.1.1</b> Sigmoid and ReLU Units</a></li>
<li class="chapter" data-level="8.1.2" data-path="ann.html"><a href="ann.html#assembling-units-into-layers"><i class="fa fa-check"></i><b>8.1.2</b> Assembling Units into Layers</a></li>
<li class="chapter" data-level="8.1.3" data-path="ann.html"><a href="ann.html#deep-neural-networks"><i class="fa fa-check"></i><b>8.1.3</b> Deep Neural Networks</a></li>
<li class="chapter" data-level="8.1.4" data-path="ann.html"><a href="ann.html#learning-the-parameters"><i class="fa fa-check"></i><b>8.1.4</b> Learning the Parameters</a></li>
<li class="chapter" data-level="8.1.5" data-path="ann.html"><a href="ann.html#parameter-learning-example-in-r"><i class="fa fa-check"></i><b>8.1.5</b> Parameter Learning Example in R</a></li>
<li class="chapter" data-level="8.1.6" data-path="ann.html"><a href="ann.html#stochastic-gradient-descent"><i class="fa fa-check"></i><b>8.1.6</b> Stochastic Gradient Descent</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="keras-and-tensorflow-with-r.html"><a href="keras-and-tensorflow-with-r.html"><i class="fa fa-check"></i><b>8.2</b> Keras and TensorFlow with R</a><ul>
<li class="chapter" data-level="8.2.1" data-path="keras-and-tensorflow-with-r.html"><a href="keras-and-tensorflow-with-r.html#keras-example"><i class="fa fa-check"></i><b>8.2.1</b> Keras Example</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="classification-with-neural-networks.html"><a href="classification-with-neural-networks.html"><i class="fa fa-check"></i><b>8.3</b> Classification with Neural Networks</a><ul>
<li class="chapter" data-level="8.3.1" data-path="classification-with-neural-networks.html"><a href="classification-with-neural-networks.html#classification-of-electromyography-signals"><i class="fa fa-check"></i><b>8.3.1</b> Classification of Electromyography Signals</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>8.4</b> Overfitting</a><ul>
<li class="chapter" data-level="8.4.1" data-path="overfitting.html"><a href="overfitting.html#early-stopping"><i class="fa fa-check"></i><b>8.4.1</b> Early Stopping</a></li>
<li class="chapter" data-level="8.4.2" data-path="overfitting.html"><a href="overfitting.html#dropout"><i class="fa fa-check"></i><b>8.4.2</b> Dropout</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="fine-tuning-a-neural-network.html"><a href="fine-tuning-a-neural-network.html"><i class="fa fa-check"></i><b>8.5</b> Fine-Tuning a Neural Network</a></li>
<li class="chapter" data-level="8.6" data-path="cnns.html"><a href="cnns.html"><i class="fa fa-check"></i><b>8.6</b> Convolutional Neural Networks</a><ul>
<li class="chapter" data-level="8.6.1" data-path="cnns.html"><a href="cnns.html#convolutions"><i class="fa fa-check"></i><b>8.6.1</b> Convolutions</a></li>
<li class="chapter" data-level="8.6.2" data-path="cnns.html"><a href="cnns.html#pooling-operations"><i class="fa fa-check"></i><b>8.6.2</b> Pooling Operations</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="cnns-with-keras.html"><a href="cnns-with-keras.html"><i class="fa fa-check"></i><b>8.7</b> CNNs with Keras</a><ul>
<li class="chapter" data-level="8.7.1" data-path="cnns-with-keras.html"><a href="cnns-with-keras.html#example-1"><i class="fa fa-check"></i><b>8.7.1</b> Example 1</a></li>
<li class="chapter" data-level="8.7.2" data-path="cnns-with-keras.html"><a href="cnns-with-keras.html#example-2"><i class="fa fa-check"></i><b>8.7.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="cnnSmile.html"><a href="cnnSmile.html"><i class="fa fa-check"></i><b>8.8</b> Smiles Detection with a CNN</a></li>
<li class="chapter" data-level="8.9" data-path="SummaryDeepLearning.html"><a href="SummaryDeepLearning.html"><i class="fa fa-check"></i><b>8.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multiuser.html"><a href="multiuser.html"><i class="fa fa-check"></i><b>9</b> Multi-User Validation</a><ul>
<li class="chapter" data-level="9.1" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i><b>9.1</b> Mixed Models</a><ul>
<li class="chapter" data-level="9.1.1" data-path="mixed-models.html"><a href="mixed-models.html#skeleton-action-recognition-with-mixed-models"><i class="fa fa-check"></i><b>9.1.1</b> Skeleton Action Recognition with Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="user-independent-models.html"><a href="user-independent-models.html"><i class="fa fa-check"></i><b>9.2</b> User-Independent Models</a></li>
<li class="chapter" data-level="9.3" data-path="user-dependent-models.html"><a href="user-dependent-models.html"><i class="fa fa-check"></i><b>9.3</b> User-Dependent Models</a></li>
<li class="chapter" data-level="9.4" data-path="user-adaptive-models.html"><a href="user-adaptive-models.html"><i class="fa fa-check"></i><b>9.4</b> User-Adaptive Models</a><ul>
<li class="chapter" data-level="9.4.1" data-path="user-adaptive-models.html"><a href="user-adaptive-models.html#transfer-learning"><i class="fa fa-check"></i><b>9.4.1</b> Transfer Learning</a></li>
<li class="chapter" data-level="9.4.2" data-path="user-adaptive-models.html"><a href="user-adaptive-models.html#a-user-adaptive-model-for-activity-recognition"><i class="fa fa-check"></i><b>9.4.2</b> A User-Adaptive Model for Activity Recognition</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="SummaryMultiUser.html"><a href="SummaryMultiUser.html"><i class="fa fa-check"></i><b>9.5</b> Summary</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendixInstall.html"><a href="appendixInstall.html"><i class="fa fa-check"></i><b>A</b> Setup Your Environment</a><ul>
<li class="chapter" data-level="A.1" data-path="installing-the-datasets.html"><a href="installing-the-datasets.html"><i class="fa fa-check"></i><b>A.1</b> Installing the Datasets</a></li>
<li class="chapter" data-level="A.2" data-path="installing-the-examples-source-code.html"><a href="installing-the-examples-source-code.html"><i class="fa fa-check"></i><b>A.2</b> Installing the Examples Source Code</a></li>
<li class="chapter" data-level="A.3" data-path="installing-keras-and-tensorflow-.html"><a href="installing-keras-and-tensorflow-.html"><i class="fa fa-check"></i><b>A.3</b> Installing Keras and TensorFlow.</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendixDatasets.html"><a href="appendixDatasets.html"><i class="fa fa-check"></i><b>B</b> Datasets</a><ul>
<li class="chapter" data-level="B.1" data-path="complex-activities.html"><a href="complex-activities.html"><i class="fa fa-check"></i><b>B.1</b> COMPLEX ACTIVITIES</a></li>
<li class="chapter" data-level="B.2" data-path="depresjon.html"><a href="depresjon.html"><i class="fa fa-check"></i><b>B.2</b> DEPRESJON</a></li>
<li class="chapter" data-level="B.3" data-path="electromyography.html"><a href="electromyography.html"><i class="fa fa-check"></i><b>B.3</b> ELECTROMYOGRAPHY</a></li>
<li class="chapter" data-level="B.4" data-path="hand-gestures.html"><a href="hand-gestures.html"><i class="fa fa-check"></i><b>B.4</b> HAND GESTURES</a></li>
<li class="chapter" data-level="B.5" data-path="home-tasks.html"><a href="home-tasks.html"><i class="fa fa-check"></i><b>B.5</b> HOME TASKS</a></li>
<li class="chapter" data-level="B.6" data-path="homicide-reports.html"><a href="homicide-reports.html"><i class="fa fa-check"></i><b>B.6</b> HOMICIDE REPORTS</a></li>
<li class="chapter" data-level="B.7" data-path="indoor-location.html"><a href="indoor-location.html"><i class="fa fa-check"></i><b>B.7</b> INDOOR LOCATION</a></li>
<li class="chapter" data-level="B.8" data-path="sheep-goats.html"><a href="sheep-goats.html"><i class="fa fa-check"></i><b>B.8</b> SHEEP GOATS</a></li>
<li class="chapter" data-level="B.9" data-path="skeleton-actions.html"><a href="skeleton-actions.html"><i class="fa fa-check"></i><b>B.9</b> SKELETON ACTIONS</a></li>
<li class="chapter" data-level="B.10" data-path="smartphone-activities.html"><a href="smartphone-activities.html"><i class="fa fa-check"></i><b>B.10</b> SMARTPHONE ACTIVITIES</a></li>
<li class="chapter" data-level="B.11" data-path="smiles.html"><a href="smiles.html"><i class="fa fa-check"></i><b>B.11</b> SMILES</a></li>
<li class="chapter" data-level="B.12" data-path="students-mental-health.html"><a href="students-mental-health.html"><i class="fa fa-check"></i><b>B.12</b> STUDENTS’ MENTAL HEALTH</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="citing-this-book.html"><a href="citing-this-book.html"><i class="fa fa-check"></i>Citing this Book</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Behavior Analysis with Machine Learning and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiviewhometasks" class="section level2">
<h2><span class="header-section-number">3.4</span> Multi-view Stacking for Home Tasks Recognition</h2>

<div class="rmdfolder">
<code>stacking_algorithms.R</code> <code>stacking_activities.R</code>
</div>

<p><strong>Multi-view learning</strong> refers to the case when an instance can be characterized by two or more independent ‘views’. For example, one can extract features for webpage classification from a webpage’s text but also from the links pointing to it. Usually, there is the assumption that the views are independent and each is sufficient to solve the problem. Then, why combine them? In many cases, each different view provides additional and complementary information, thus, allowing to train better models.</p>
<p>The simplest thing one can do is to extract features from each view, aggregate them, and train a single model. This approach usually works well but it has some limitations. Each view may have different statistical properties, thus, different types of models may be needed for each view. When aggregating features from all views, new variable correlations may be introduced which could impact the performance. Another limitation is that features need to be in the same format (feature vectors, images, etc.), so they can be aggregated.</p>
<p>For video classification, we could have two views. One represented by sequences of images, and the other one by the corresponding audio. For the video part, we could encode the features as the images themselves, i.e., matrices. Then, a Convolutional Neural Network (covered in chapter <a href="deeplearning.html#deeplearning">8</a>) could be trained directly from those images. For the audio part, statistical features can be extracted and stored into normal feature vectors. In this case, the two representations (views) are different. One is a matrix and the other one a one-dimensional feature vector. Combining them to train a single classifier could be problematic given the nature of the views and their different encoding formats. Instead, we can train two models, one for each view and then combine the results. This is precisely the idea of <em>Multi-view Stacking</em> <span class="citation">(Garcia-Ceja, Galván-Tejada, and Brena <a href="#ref-garcia2018multiview" role="doc-biblioref">2018</a>)</span>. Train a different model for each view and combine the outputs like in <em>Stacking</em>.</p>
<p>Here, <em>Multi-view Stacking</em> will be demonstrated using the <em>HOME TASKS</em> dataset. This dataset was collected from two sources. Acceleration and audio. The acceleration was recorded with a wrist-band watch and the audio using a cellphone. This dataset consists of <span class="math inline">\(7\)</span> common home tasks: <em>‘mop floor’</em>, <em>‘sweep floor’</em>, <em>‘type on computer keyboard’</em>, <em>‘brush teeth’</em>, <em>‘wash hands’</em>, <em>‘eat chips’</em>, and <em>‘watch t.v.’</em>. Three volunteers performed each activity for approximately <span class="math inline">\(3\)</span> minutes.</p>
<p>The acceleration and audio signals were segmented into <span class="math inline">\(3\)</span> sec. windows. From each window, different features were extracted. From the acceleration, <span class="math inline">\(16\)</span> features were extracted from the <span class="math inline">\(3\)</span> axes (<span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span>,<span class="math inline">\(z\)</span>) such as mean, standard deviation, maximum values, mean magnitude, area under the curve, etc. From the audio signals, <span class="math inline">\(12\)</span> features were extracted, namely, Mel Frequency Cepstral Coefficients (MFCCs). To preserve volunteers’ privacy, the original audio was not released. The dataset already contains the extracted features from acceleration and audio. The first column is the label.</p>
<p>In order to implement <em>Multi-view Stacking</em>, two Random Forests will be trained, one for each view (acceleration and audio). The predicted outputs will be stacked to form the new training set <span class="math inline">\(D&#39;\)</span> and a Random Forest trained with <span class="math inline">\(D&#39;\)</span> will act as the <em>meta-learner</em>.</p>
<p>The next code snippet taken from <code>stacking_algorithms.R</code> shows the multi-view stacking function implemented in R.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="multiviewhometasks.html#cb53-1"></a>mvstacking &lt;-<span class="st"> </span><span class="cf">function</span>(D, v1cols, v2cols, <span class="dt">k =</span> <span class="dv">10</span>){</span>
<span id="cb53-2"><a href="multiviewhometasks.html#cb53-2"></a>  </span>
<span id="cb53-3"><a href="multiviewhometasks.html#cb53-3"></a>  <span class="co"># Generate folds for internal cross-validation.</span></span>
<span id="cb53-4"><a href="multiviewhometasks.html#cb53-4"></a>  folds &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>k, <span class="dt">size =</span> <span class="kw">nrow</span>(D), <span class="dt">replace =</span> T)</span>
<span id="cb53-5"><a href="multiviewhometasks.html#cb53-5"></a>  </span>
<span id="cb53-6"><a href="multiviewhometasks.html#cb53-6"></a>  trueLabels &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb53-7"><a href="multiviewhometasks.html#cb53-7"></a>  predicted.v1 &lt;-<span class="st"> </span><span class="ot">NULL</span> <span class="co"># predicted labels with view 1</span></span>
<span id="cb53-8"><a href="multiviewhometasks.html#cb53-8"></a>  predicted.v2 &lt;-<span class="st"> </span><span class="ot">NULL</span> <span class="co"># predicted labels with view 2</span></span>
<span id="cb53-9"><a href="multiviewhometasks.html#cb53-9"></a>  probs.v1 &lt;-<span class="st"> </span><span class="ot">NULL</span> <span class="co"># predicted probabilities with view 1</span></span>
<span id="cb53-10"><a href="multiviewhometasks.html#cb53-10"></a>  probs.v2 &lt;-<span class="st"> </span><span class="ot">NULL</span> <span class="co"># predicted probabilities with view 2</span></span>
<span id="cb53-11"><a href="multiviewhometasks.html#cb53-11"></a></span>
<span id="cb53-12"><a href="multiviewhometasks.html#cb53-12"></a>  <span class="co"># Perform internal cross-validation.</span></span>
<span id="cb53-13"><a href="multiviewhometasks.html#cb53-13"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb53-14"><a href="multiviewhometasks.html#cb53-14"></a>    </span>
<span id="cb53-15"><a href="multiviewhometasks.html#cb53-15"></a>    train &lt;-<span class="st"> </span>D[folds <span class="op">!=</span><span class="st"> </span>i, ]</span>
<span id="cb53-16"><a href="multiviewhometasks.html#cb53-16"></a>    test &lt;-<span class="st"> </span>D[folds <span class="op">==</span><span class="st"> </span>i, ]</span>
<span id="cb53-17"><a href="multiviewhometasks.html#cb53-17"></a>    trueLabels &lt;-<span class="st"> </span><span class="kw">c</span>(trueLabels, <span class="kw">as.character</span>(test<span class="op">$</span>label))</span>
<span id="cb53-18"><a href="multiviewhometasks.html#cb53-18"></a>    </span>
<span id="cb53-19"><a href="multiviewhometasks.html#cb53-19"></a>    <span class="co"># Train learner with view 1 and make predictions.</span></span>
<span id="cb53-20"><a href="multiviewhometasks.html#cb53-20"></a>    m.v1 &lt;-<span class="st"> </span><span class="kw">randomForest</span>(label <span class="op">~</span>.,</span>
<span id="cb53-21"><a href="multiviewhometasks.html#cb53-21"></a>                         train[,<span class="kw">c</span>(<span class="st">&quot;label&quot;</span>,v1cols)], <span class="dt">nt =</span> <span class="dv">100</span>)</span>
<span id="cb53-22"><a href="multiviewhometasks.html#cb53-22"></a>    raw.v1 &lt;-<span class="st"> </span><span class="kw">predict</span>(m.v1, <span class="dt">newdata =</span> test[,v1cols], <span class="dt">type =</span> <span class="st">&quot;prob&quot;</span>)</span>
<span id="cb53-23"><a href="multiviewhometasks.html#cb53-23"></a>    probs.v1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(probs.v1, raw.v1)</span>
<span id="cb53-24"><a href="multiviewhometasks.html#cb53-24"></a>    pred.v1 &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">predict</span>(m.v1,</span>
<span id="cb53-25"><a href="multiviewhometasks.html#cb53-25"></a>                                    <span class="dt">newdata =</span> test[,v1cols],</span>
<span id="cb53-26"><a href="multiviewhometasks.html#cb53-26"></a>                                    <span class="dt">type =</span> <span class="st">&quot;class&quot;</span>))</span>
<span id="cb53-27"><a href="multiviewhometasks.html#cb53-27"></a>    predicted.v1 &lt;-<span class="st"> </span><span class="kw">c</span>(predicted.v1, pred.v1)</span>
<span id="cb53-28"><a href="multiviewhometasks.html#cb53-28"></a>    </span>
<span id="cb53-29"><a href="multiviewhometasks.html#cb53-29"></a>    <span class="co"># Train learner with view 2 and make predictions.</span></span>
<span id="cb53-30"><a href="multiviewhometasks.html#cb53-30"></a>    m.v2 &lt;-<span class="st"> </span><span class="kw">randomForest</span>(label <span class="op">~</span>.,</span>
<span id="cb53-31"><a href="multiviewhometasks.html#cb53-31"></a>                         train[,<span class="kw">c</span>(<span class="st">&quot;label&quot;</span>,v2cols)], <span class="dt">nt =</span> <span class="dv">100</span>)</span>
<span id="cb53-32"><a href="multiviewhometasks.html#cb53-32"></a>    raw.v2 &lt;-<span class="st"> </span><span class="kw">predict</span>(m.v2, <span class="dt">newdata =</span> test[,v2cols], <span class="dt">type =</span> <span class="st">&quot;prob&quot;</span>)</span>
<span id="cb53-33"><a href="multiviewhometasks.html#cb53-33"></a>    probs.v2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(probs.v2, raw.v2)</span>
<span id="cb53-34"><a href="multiviewhometasks.html#cb53-34"></a>    pred.v2 &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">predict</span>(m.v2,</span>
<span id="cb53-35"><a href="multiviewhometasks.html#cb53-35"></a>                                    <span class="dt">newdata =</span> test[,v2cols],</span>
<span id="cb53-36"><a href="multiviewhometasks.html#cb53-36"></a>                                    <span class="dt">type =</span> <span class="st">&quot;class&quot;</span>))</span>
<span id="cb53-37"><a href="multiviewhometasks.html#cb53-37"></a>    predicted.v2 &lt;-<span class="st"> </span><span class="kw">c</span>(predicted.v2, pred.v2)</span>
<span id="cb53-38"><a href="multiviewhometasks.html#cb53-38"></a>  }</span>
<span id="cb53-39"><a href="multiviewhometasks.html#cb53-39"></a>  </span>
<span id="cb53-40"><a href="multiviewhometasks.html#cb53-40"></a>  <span class="co"># Build first-order learners with all data.</span></span>
<span id="cb53-41"><a href="multiviewhometasks.html#cb53-41"></a>  learnerV1 &lt;-<span class="st"> </span><span class="kw">randomForest</span>(label <span class="op">~</span>.,</span>
<span id="cb53-42"><a href="multiviewhometasks.html#cb53-42"></a>                            D[,<span class="kw">c</span>(<span class="st">&quot;label&quot;</span>,v1cols)], <span class="dt">nt =</span> <span class="dv">100</span>)</span>
<span id="cb53-43"><a href="multiviewhometasks.html#cb53-43"></a>  learnerV2 &lt;-<span class="st"> </span><span class="kw">randomForest</span>(label <span class="op">~</span>.,</span>
<span id="cb53-44"><a href="multiviewhometasks.html#cb53-44"></a>                            D[,<span class="kw">c</span>(<span class="st">&quot;label&quot;</span>,v2cols)], <span class="dt">nt =</span> <span class="dv">100</span>)</span>
<span id="cb53-45"><a href="multiviewhometasks.html#cb53-45"></a>    </span>
<span id="cb53-46"><a href="multiviewhometasks.html#cb53-46"></a>  <span class="co"># Construct meta-features.</span></span>
<span id="cb53-47"><a href="multiviewhometasks.html#cb53-47"></a>  metaFeatures &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">label =</span> trueLabels,</span>
<span id="cb53-48"><a href="multiviewhometasks.html#cb53-48"></a>                             ((probs.v1 <span class="op">+</span><span class="st"> </span>probs.v2) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>),</span>
<span id="cb53-49"><a href="multiviewhometasks.html#cb53-49"></a>                             <span class="dt">pred1 =</span> predicted.v1,</span>
<span id="cb53-50"><a href="multiviewhometasks.html#cb53-50"></a>                             <span class="dt">pred2 =</span> predicted.v2)</span>
<span id="cb53-51"><a href="multiviewhometasks.html#cb53-51"></a></span>
<span id="cb53-52"><a href="multiviewhometasks.html#cb53-52"></a>  <span class="co">#train meta-learner</span></span>
<span id="cb53-53"><a href="multiviewhometasks.html#cb53-53"></a>  metalearner &lt;-<span class="st"> </span><span class="kw">randomForest</span>(label <span class="op">~</span>.,</span>
<span id="cb53-54"><a href="multiviewhometasks.html#cb53-54"></a>                              metaFeatures, <span class="dt">nt =</span> <span class="dv">100</span>)</span>
<span id="cb53-55"><a href="multiviewhometasks.html#cb53-55"></a>  </span>
<span id="cb53-56"><a href="multiviewhometasks.html#cb53-56"></a>  res &lt;-<span class="st"> </span><span class="kw">structure</span>(<span class="kw">list</span>(<span class="dt">metalearner=</span>metalearner,</span>
<span id="cb53-57"><a href="multiviewhometasks.html#cb53-57"></a>                        <span class="dt">learnerV1=</span>learnerV1,</span>
<span id="cb53-58"><a href="multiviewhometasks.html#cb53-58"></a>                        <span class="dt">learnerV2=</span>learnerV2,</span>
<span id="cb53-59"><a href="multiviewhometasks.html#cb53-59"></a>                        <span class="dt">v1cols =</span> v1cols,</span>
<span id="cb53-60"><a href="multiviewhometasks.html#cb53-60"></a>                        <span class="dt">v2cols =</span> v2cols),</span>
<span id="cb53-61"><a href="multiviewhometasks.html#cb53-61"></a>                   <span class="dt">class =</span> <span class="st">&quot;mvstacking&quot;</span>)</span>
<span id="cb53-62"><a href="multiviewhometasks.html#cb53-62"></a>  </span>
<span id="cb53-63"><a href="multiviewhometasks.html#cb53-63"></a>  <span class="kw">return</span>(res)</span>
<span id="cb53-64"><a href="multiviewhometasks.html#cb53-64"></a>}</span></code></pre></div>
<p>The first argument <code>D</code> is a data frame containing the training data. <code>v1cols</code> and <code>v2cols</code> are the column names of the two views. Finally, argument <code>k</code> specifies the number of folds for the internal cross-validation to avoid overfitting (Steps <span class="math inline">\(2\)</span> and <span class="math inline">\(3\)</span> as described in the generalized stacking procedure).</p>
<p>The function iterates through each fold and trains a Random Forest with the train data for each of the two views. Within each iteration, the trained models are used to predict the labels and probabilities on the internal test set. Predicted labels and probabilities on the internal test sets are concatenated across all folds (<code>predicted.v1</code>, <code>predicted.v2</code>).</p>
<p>After cross-validation, the meta-features are generated by creating a data frame with the predictions of each view. Additionally, the average of class probabilities is added as a meta-feature. The true labels are also added. The purpose of cross-validation was to avoid overfitting but at the end, we do not want to waste data so both learners are re-trained with all data <code>D</code>.</p>
<p>Finally, the <em>meta-learner</em> which is also a Random Forest is trained with the <em>meta-features</em> data frame. A list with all the required information to make predictions is created. This includes first-level learners, the meta-learner, and the column names for each view so we know how to divide the data frame into two views at prediction time.</p>
<p>The following code snippet shows the implementation for making predictions using a trained stacking model.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="multiviewhometasks.html#cb54-1"></a>predict.mvstacking &lt;-<span class="st"> </span><span class="cf">function</span>(object, newdata){</span>
<span id="cb54-2"><a href="multiviewhometasks.html#cb54-2"></a>  </span>
<span id="cb54-3"><a href="multiviewhometasks.html#cb54-3"></a>  <span class="co"># Predict probabilities with view 1.</span></span>
<span id="cb54-4"><a href="multiviewhometasks.html#cb54-4"></a>  raw.v1 &lt;-<span class="st"> </span><span class="kw">predict</span>(object<span class="op">$</span>learnerV1,</span>
<span id="cb54-5"><a href="multiviewhometasks.html#cb54-5"></a>                    <span class="dt">newdata =</span> newdata[,object<span class="op">$</span>v1cols],</span>
<span id="cb54-6"><a href="multiviewhometasks.html#cb54-6"></a>                    <span class="dt">type =</span> <span class="st">&quot;prob&quot;</span>)</span>
<span id="cb54-7"><a href="multiviewhometasks.html#cb54-7"></a>  </span>
<span id="cb54-8"><a href="multiviewhometasks.html#cb54-8"></a>  <span class="co"># Predict classes with view 1.</span></span>
<span id="cb54-9"><a href="multiviewhometasks.html#cb54-9"></a>  pred.v1 &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">predict</span>(object<span class="op">$</span>learnerV1,</span>
<span id="cb54-10"><a href="multiviewhometasks.html#cb54-10"></a>                                  <span class="dt">newdata =</span> newdata[,object<span class="op">$</span>v1cols],</span>
<span id="cb54-11"><a href="multiviewhometasks.html#cb54-11"></a>                                  <span class="dt">type =</span> <span class="st">&quot;class&quot;</span>))</span>
<span id="cb54-12"><a href="multiviewhometasks.html#cb54-12"></a>  </span>
<span id="cb54-13"><a href="multiviewhometasks.html#cb54-13"></a>  <span class="co"># Predict probabilities with view 2.</span></span>
<span id="cb54-14"><a href="multiviewhometasks.html#cb54-14"></a>  raw.v2 &lt;-<span class="st"> </span><span class="kw">predict</span>(object<span class="op">$</span>learnerV2,</span>
<span id="cb54-15"><a href="multiviewhometasks.html#cb54-15"></a>                    <span class="dt">newdata =</span> newdata[,object<span class="op">$</span>v2cols],</span>
<span id="cb54-16"><a href="multiviewhometasks.html#cb54-16"></a>                    <span class="dt">type =</span> <span class="st">&quot;prob&quot;</span>)</span>
<span id="cb54-17"><a href="multiviewhometasks.html#cb54-17"></a>  </span>
<span id="cb54-18"><a href="multiviewhometasks.html#cb54-18"></a>  <span class="co"># Predict classes with view 2.</span></span>
<span id="cb54-19"><a href="multiviewhometasks.html#cb54-19"></a>  pred.v2 &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">predict</span>(object<span class="op">$</span>learnerV2,</span>
<span id="cb54-20"><a href="multiviewhometasks.html#cb54-20"></a>                                  <span class="dt">newdata =</span> newdata[,object<span class="op">$</span>v2cols],</span>
<span id="cb54-21"><a href="multiviewhometasks.html#cb54-21"></a>                                  <span class="dt">type =</span> <span class="st">&quot;class&quot;</span>))</span>
<span id="cb54-22"><a href="multiviewhometasks.html#cb54-22"></a></span>
<span id="cb54-23"><a href="multiviewhometasks.html#cb54-23"></a>  <span class="co"># Build meta-features</span></span>
<span id="cb54-24"><a href="multiviewhometasks.html#cb54-24"></a>  metaFeatures &lt;-<span class="st"> </span><span class="kw">data.frame</span>(((raw.v1 <span class="op">+</span><span class="st"> </span>raw.v2) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>),</span>
<span id="cb54-25"><a href="multiviewhometasks.html#cb54-25"></a>                             <span class="dt">pred1 =</span> pred.v1,</span>
<span id="cb54-26"><a href="multiviewhometasks.html#cb54-26"></a>                             <span class="dt">pred2 =</span> pred.v2)</span>
<span id="cb54-27"><a href="multiviewhometasks.html#cb54-27"></a></span>
<span id="cb54-28"><a href="multiviewhometasks.html#cb54-28"></a>  <span class="co"># Set levels on factors to avoid errors in randomForest predict.</span></span>
<span id="cb54-29"><a href="multiviewhometasks.html#cb54-29"></a>  <span class="kw">levels</span>(metaFeatures<span class="op">$</span>pred1) &lt;-<span class="st"> </span>object<span class="op">$</span>metalearner<span class="op">$</span>classes</span>
<span id="cb54-30"><a href="multiviewhometasks.html#cb54-30"></a>  <span class="kw">levels</span>(metaFeatures<span class="op">$</span>pred2) &lt;-<span class="st"> </span>object<span class="op">$</span>metalearner<span class="op">$</span>classes</span>
<span id="cb54-31"><a href="multiviewhometasks.html#cb54-31"></a>  </span>
<span id="cb54-32"><a href="multiviewhometasks.html#cb54-32"></a>  predictions &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">predict</span>(object<span class="op">$</span>metalearner,</span>
<span id="cb54-33"><a href="multiviewhometasks.html#cb54-33"></a>                                      <span class="dt">newdata =</span> metaFeatures),</span>
<span id="cb54-34"><a href="multiviewhometasks.html#cb54-34"></a>                              <span class="dt">type=</span><span class="st">&quot;class&quot;</span>)</span>
<span id="cb54-35"><a href="multiviewhometasks.html#cb54-35"></a>  </span>
<span id="cb54-36"><a href="multiviewhometasks.html#cb54-36"></a>  <span class="kw">return</span>(predictions)</span>
<span id="cb54-37"><a href="multiviewhometasks.html#cb54-37"></a>}</span></code></pre></div>
<p>The <code>object</code> parameter is the trained model and <code>newdata</code> is a data frame from which we want to make the predictions. First, labels and probabilities are predicted using the two views. Then, a data frame with the <em>meta-features</em> is assembled with the predicted label and the averaged probabilities. Finally, the <em>meta-learner</em> is used to predict the final classes using the <em>meta-features</em>.</p>
<p>The script <code>stacking_activities.R</code> shows how to use our <code>mvstacking()</code> function. With the following two lines we can train and make predictions.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="multiviewhometasks.html#cb55-1"></a>m.stacking &lt;-<span class="st"> </span><span class="kw">mvstacking</span>(trainset, v1cols, v2cols, <span class="dt">k =</span> <span class="dv">10</span>)</span>
<span id="cb55-2"><a href="multiviewhometasks.html#cb55-2"></a>pred.stacking &lt;-<span class="st"> </span><span class="kw">predict</span>(m.stacking, <span class="dt">newdata =</span> testset[,<span class="op">-</span><span class="dv">1</span>])</span></code></pre></div>
<p>The script performs <span class="math inline">\(10\)</span>-fold cross-validation and for the sake of comparison, it builds three models. One with only audio features, one with only acceleration features, and the Multi-view Stacking one combining both types of features.</p>
<p>Table <a href="multiviewhometasks.html#tab:stackingResults">3.1</a> shows the results for each view and with Multi-view Stacking. Clearly, combining both views with Multi-view Stacking achieved the best results compared to using a single view.</p>
<table>
<caption><span id="tab:stackingResults">Table 3.1: </span>Stacking results.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Accuracy</th>
<th align="right">Recall</th>
<th align="right">Specificity</th>
<th align="right">Precision</th>
<th align="right">F1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Audio</td>
<td align="right">0.8463203</td>
<td align="right">0.8413690</td>
<td align="right">0.9741266</td>
<td align="right">0.8487849</td>
<td align="right">0.8438718</td>
</tr>
<tr class="even">
<td align="left">Accelerometer</td>
<td align="right">0.8585859</td>
<td align="right">0.8493635</td>
<td align="right">0.9764988</td>
<td align="right">0.8548481</td>
<td align="right">0.8511572</td>
</tr>
<tr class="odd">
<td align="left">Multi-view Stacking</td>
<td align="right">0.9393939</td>
<td align="right">0.9349011</td>
<td align="right">0.9899275</td>
<td align="right">0.9371645</td>
<td align="right">0.9358082</td>
</tr>
</tbody>
</table>
<div class="figure" style="text-align: center"><span id="fig:stackingCMs"></span>
<img src="images/stacking_cm.png" alt="Confusion matrices." width="100%" />
<p class="caption">
Figure 3.6: Confusion matrices.
</p>
</div>
<p>Figure <a href="multiviewhometasks.html#fig:stackingCMs">3.6</a> shows the resulting confusion matrices for the three cases. By looking at the recall (anti-diagonal) of the individual classes, it seems that audio features are better at recognizing some activities like <em>‘sweep’</em> and <em>‘mop floor’</em> whereas the accelerometer features are better for classifying <em>‘eat chips’</em>, <em>‘wash hands’</em>, <em>‘type on keyboard’</em>, etc. thus, those two views are somehow complementary. All recall values when using Multi-view Stacking are higher than any of the other views.</p>

</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-garcia2018multiview">
<p>Garcia-Ceja, Enrique, Carlos E Galván-Tejada, and Ramon Brena. 2018. “Multi-View Stacking for Activity Recognition with Sound and Accelerometer Data.” <em>Information Fusion</em> 40: 45–56.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stacked-generalization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="SummaryEnsemble.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
