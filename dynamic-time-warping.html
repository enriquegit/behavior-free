<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.4 Dynamic Time Warping | Behavior Analysis with Machine Learning and R</title>
  <meta name="description" content="2.4 Dynamic Time Warping | Behavior Analysis with Machine Learning and R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="2.4 Dynamic Time Warping | Behavior Analysis with Machine Learning and R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="2.4 Dynamic Time Warping | Behavior Analysis with Machine Learning and R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.4 Dynamic Time Warping | Behavior Analysis with Machine Learning and R" />
  
  <meta name="twitter:description" content="2.4 Dynamic Time Warping | Behavior Analysis with Machine Learning and R teaches you how to train machine learning models in the R programming language to make sense of behavioral data collected with sensors and stored in electronic records. This book introduces machine learning concepts and algorithms applied to a diverse set of behavior analysis problems by focusing on practical aspects. Some of the topics include how to: Build supervised models to predict indoor locations based on Wi-Fi signals, recognize physical activities from smartphone sensors, use unsupervised learning to discover criminal behavioral patterns, build deep learning models to analyze electromyography signals, CNNs to detect smiles in images and much more." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Enrique Garcia Ceja" />


<meta name="date" content="2020-09-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="decision-trees.html"/>
<link rel="next" href="summaryClassification.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/d3-4.9.0/d3.min.js"></script>
<script src="libs/d3-tip-0.7.1/index-min.js"></script>
<link href="libs/d3panels-1.4.9/d3panels.min.css" rel="stylesheet" />
<script src="libs/d3panels-1.4.9/d3panels.min.js"></script>
<script src="libs/qtlcharts_iplotCorr-0.11.6/iplotCorr.js"></script>
<script src="libs/qtlcharts_iplotCorr-0.11.6/iplotCorr_noscat.js"></script>
<script src="libs/iplotCorr-binding-0.11.6/iplotCorr.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-178679335-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-178679335-1', { 'anonymize_ip': true });
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="#">Behavior Analysis with Machine Learning and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#supplemental-material"><i class="fa fa-check"></i>Supplemental Material</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html"><i class="fa fa-check"></i><b>1.1</b> What is Machine Learning?</a></li>
<li class="chapter" data-level="1.2" data-path="taxonomy.html"><a href="taxonomy.html"><i class="fa fa-check"></i><b>1.2</b> Types of Machine Learning</a></li>
<li class="chapter" data-level="1.3" data-path="terminology.html"><a href="terminology.html"><i class="fa fa-check"></i><b>1.3</b> Terminology</a><ul>
<li class="chapter" data-level="1.3.1" data-path="terminology.html"><a href="terminology.html#tables"><i class="fa fa-check"></i><b>1.3.1</b> Tables</a></li>
<li class="chapter" data-level="1.3.2" data-path="terminology.html"><a href="terminology.html#variable-types"><i class="fa fa-check"></i><b>1.3.2</b> Variable Types</a></li>
<li class="chapter" data-level="1.3.3" data-path="terminology.html"><a href="terminology.html#predictive-models"><i class="fa fa-check"></i><b>1.3.3</b> Predictive Models</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="pipeline.html"><a href="pipeline.html"><i class="fa fa-check"></i><b>1.4</b> Data Analysis Pipeline</a></li>
<li class="chapter" data-level="1.5" data-path="trainingeval.html"><a href="trainingeval.html"><i class="fa fa-check"></i><b>1.5</b> Evaluating Predictive Models</a></li>
<li class="chapter" data-level="1.6" data-path="simple-classification-example.html"><a href="simple-classification-example.html"><i class="fa fa-check"></i><b>1.6</b> Simple Classification Example</a><ul>
<li class="chapter" data-level="1.6.1" data-path="simple-classification-example.html"><a href="simple-classification-example.html#k-fold-cross-validation-example"><i class="fa fa-check"></i><b>1.6.1</b> K-fold Cross-Validation Example</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="simple-regression-example.html"><a href="simple-regression-example.html"><i class="fa fa-check"></i><b>1.7</b> Simple Regression Example</a></li>
<li class="chapter" data-level="1.8" data-path="underfitting-and-overfitting.html"><a href="underfitting-and-overfitting.html"><i class="fa fa-check"></i><b>1.8</b> Underfitting and Overfitting</a></li>
<li class="chapter" data-level="1.9" data-path="bias-and-variance.html"><a href="bias-and-variance.html"><i class="fa fa-check"></i><b>1.9</b> Bias and Variance</a></li>
<li class="chapter" data-level="1.10" data-path="SummaryIntro.html"><a href="SummaryIntro.html"><i class="fa fa-check"></i><b>1.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>2</b> Predicting Behavior with Classification Models</a><ul>
<li class="chapter" data-level="2.1" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html"><i class="fa fa-check"></i><b>2.1</b> <em>k</em>-nearest Neighbors</a><ul>
<li class="chapter" data-level="2.1.1" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#indoor-location-with-wi-fi-signals"><i class="fa fa-check"></i><b>2.1.1</b> Indoor Location with Wi-Fi Signals</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="performance-metrics.html"><a href="performance-metrics.html"><i class="fa fa-check"></i><b>2.2</b> Performance Metrics</a></li>
<li class="chapter" data-level="2.3" data-path="decision-trees.html"><a href="decision-trees.html"><i class="fa fa-check"></i><b>2.3</b> Decision Trees</a><ul>
<li class="chapter" data-level="2.3.1" data-path="decision-trees.html"><a href="decision-trees.html#activityRecognition"><i class="fa fa-check"></i><b>2.3.1</b> Activity Recognition with Smartphones</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="dynamic-time-warping.html"><a href="dynamic-time-warping.html"><i class="fa fa-check"></i><b>2.4</b> Dynamic Time Warping</a><ul>
<li class="chapter" data-level="2.4.1" data-path="dynamic-time-warping.html"><a href="dynamic-time-warping.html#sechandgestures"><i class="fa fa-check"></i><b>2.4.1</b> Hand Gesture Recognition</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summaryClassification.html"><a href="summaryClassification.html"><i class="fa fa-check"></i><b>2.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ensemble.html"><a href="ensemble.html"><i class="fa fa-check"></i><b>3</b> Predicting Behavior with Ensemble Learning</a><ul>
<li class="chapter" data-level="3.1" data-path="bagging.html"><a href="bagging.html"><i class="fa fa-check"></i><b>3.1</b> Bagging</a><ul>
<li class="chapter" data-level="3.1.1" data-path="bagging.html"><a href="bagging.html#activity-recognition-with-bagging"><i class="fa fa-check"></i><b>3.1.1</b> Activity recognition with Bagging</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>3.2</b> Random Forest</a></li>
<li class="chapter" data-level="3.3" data-path="stacked-generalization.html"><a href="stacked-generalization.html"><i class="fa fa-check"></i><b>3.3</b> Stacked Generalization</a></li>
<li class="chapter" data-level="3.4" data-path="multiviewhometasks.html"><a href="multiviewhometasks.html"><i class="fa fa-check"></i><b>3.4</b> Multi-view Stacking for Home Tasks Recognition</a></li>
<li class="chapter" data-level="3.5" data-path="SummaryEnsemble.html"><a href="SummaryEnsemble.html"><i class="fa fa-check"></i><b>3.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="edavis.html"><a href="edavis.html"><i class="fa fa-check"></i><b>4</b> Exploring and Visualizing Behavioral Data</a><ul>
<li class="chapter" data-level="4.1" data-path="talking-with-field-experts.html"><a href="talking-with-field-experts.html"><i class="fa fa-check"></i><b>4.1</b> Talking with Field Experts</a></li>
<li class="chapter" data-level="4.2" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>4.2</b> Summary Statistics</a></li>
<li class="chapter" data-level="4.3" data-path="class-distributions.html"><a href="class-distributions.html"><i class="fa fa-check"></i><b>4.3</b> Class Distributions</a></li>
<li class="chapter" data-level="4.4" data-path="user-class-sparsity-matrix.html"><a href="user-class-sparsity-matrix.html"><i class="fa fa-check"></i><b>4.4</b> User-Class Sparsity Matrix</a></li>
<li class="chapter" data-level="4.5" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>4.5</b> Boxplots</a></li>
<li class="chapter" data-level="4.6" data-path="correlation-plots.html"><a href="correlation-plots.html"><i class="fa fa-check"></i><b>4.6</b> Correlation Plots</a><ul>
<li class="chapter" data-level="4.6.1" data-path="correlation-plots.html"><a href="correlation-plots.html#interactive-correlation-plots"><i class="fa fa-check"></i><b>4.6.1</b> Interactive Correlation Plots</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="timeseries.html"><a href="timeseries.html"><i class="fa fa-check"></i><b>4.7</b> Timeseries</a><ul>
<li class="chapter" data-level="4.7.1" data-path="timeseries.html"><a href="timeseries.html#interactive-timeseries"><i class="fa fa-check"></i><b>4.7.1</b> Interactive Timeseries</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="multidimensional-scaling-mds.html"><a href="multidimensional-scaling-mds.html"><i class="fa fa-check"></i><b>4.8</b> Multidimensional Scaling (MDS)</a></li>
<li class="chapter" data-level="4.9" data-path="heatmaps.html"><a href="heatmaps.html"><i class="fa fa-check"></i><b>4.9</b> Heatmaps</a></li>
<li class="chapter" data-level="4.10" data-path="automated-eda.html"><a href="automated-eda.html"><i class="fa fa-check"></i><b>4.10</b> Automated EDA</a></li>
<li class="chapter" data-level="4.11" data-path="SummaryExploratory.html"><a href="SummaryExploratory.html"><i class="fa fa-check"></i><b>4.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="preprocessing.html"><a href="preprocessing.html"><i class="fa fa-check"></i><b>5</b> Preprocessing Behavioral Data</a><ul>
<li class="chapter" data-level="5.1" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>5.1</b> Missing Values</a><ul>
<li class="chapter" data-level="5.1.1" data-path="missing-values.html"><a href="missing-values.html#imputation"><i class="fa fa-check"></i><b>5.1.1</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="smoothing.html"><a href="smoothing.html"><i class="fa fa-check"></i><b>5.2</b> Smoothing</a></li>
<li class="chapter" data-level="5.3" data-path="normalization.html"><a href="normalization.html"><i class="fa fa-check"></i><b>5.3</b> Normalization</a></li>
<li class="chapter" data-level="5.4" data-path="imbalanced-classes.html"><a href="imbalanced-classes.html"><i class="fa fa-check"></i><b>5.4</b> Imbalanced Classes</a><ul>
<li class="chapter" data-level="5.4.1" data-path="imbalanced-classes.html"><a href="imbalanced-classes.html#random-oversampling"><i class="fa fa-check"></i><b>5.4.1</b> Random Oversampling</a></li>
<li class="chapter" data-level="5.4.2" data-path="imbalanced-classes.html"><a href="imbalanced-classes.html#smote"><i class="fa fa-check"></i><b>5.4.2</b> SMOTE</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="infoinjection.html"><a href="infoinjection.html"><i class="fa fa-check"></i><b>5.5</b> Information Injection</a></li>
<li class="chapter" data-level="5.6" data-path="one-hot-encoding.html"><a href="one-hot-encoding.html"><i class="fa fa-check"></i><b>5.6</b> One-hot Encoding</a></li>
<li class="chapter" data-level="5.7" data-path="SummaryPreprocessing.html"><a href="SummaryPreprocessing.html"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="unsupervised.html"><a href="unsupervised.html"><i class="fa fa-check"></i><b>6</b> Discovering Behaviors with Unsupervised Learning</a><ul>
<li class="chapter" data-level="6.1" data-path="k-means-clustering.html"><a href="k-means-clustering.html"><i class="fa fa-check"></i><b>6.1</b> K-means clustering</a><ul>
<li class="chapter" data-level="6.1.1" data-path="k-means-clustering.html"><a href="k-means-clustering.html#studentresponses"><i class="fa fa-check"></i><b>6.1.1</b> Grouping Student Responses</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="the-silhouette-index.html"><a href="the-silhouette-index.html"><i class="fa fa-check"></i><b>6.2</b> The Silhouette Index</a></li>
<li class="chapter" data-level="6.3" data-path="associationrules.html"><a href="associationrules.html"><i class="fa fa-check"></i><b>6.3</b> Mining Association Rules</a><ul>
<li class="chapter" data-level="6.3.1" data-path="associationrules.html"><a href="associationrules.html#finding-rules-for-criminal-behavior"><i class="fa fa-check"></i><b>6.3.1</b> Finding Rules for Criminal Behavior</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="SummaryUnsupervised.html"><a href="SummaryUnsupervised.html"><i class="fa fa-check"></i><b>6.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="representations.html"><a href="representations.html"><i class="fa fa-check"></i><b>7</b> Encoding Behavioral Data</a><ul>
<li class="chapter" data-level="7.1" data-path="feature-vectors.html"><a href="feature-vectors.html"><i class="fa fa-check"></i><b>7.1</b> Feature Vectors</a></li>
<li class="chapter" data-level="7.2" data-path="sectimeseries.html"><a href="sectimeseries.html"><i class="fa fa-check"></i><b>7.2</b> Timeseries</a></li>
<li class="chapter" data-level="7.3" data-path="transactions.html"><a href="transactions.html"><i class="fa fa-check"></i><b>7.3</b> Transactions</a></li>
<li class="chapter" data-level="7.4" data-path="images.html"><a href="images.html"><i class="fa fa-check"></i><b>7.4</b> Images</a></li>
<li class="chapter" data-level="7.5" data-path="recurrence-plots.html"><a href="recurrence-plots.html"><i class="fa fa-check"></i><b>7.5</b> Recurrence Plots</a><ul>
<li class="chapter" data-level="7.5.1" data-path="recurrence-plots.html"><a href="recurrence-plots.html#computing-recurence-plots"><i class="fa fa-check"></i><b>7.5.1</b> Computing Recurence Plots</a></li>
<li class="chapter" data-level="7.5.2" data-path="recurrence-plots.html"><a href="recurrence-plots.html#recurrence-plots-of-hand-gestures"><i class="fa fa-check"></i><b>7.5.2</b> Recurrence Plots of Hand Gestures</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="bag-of-words.html"><a href="bag-of-words.html"><i class="fa fa-check"></i><b>7.6</b> Bag-of-Words</a><ul>
<li class="chapter" data-level="7.6.1" data-path="bag-of-words.html"><a href="bag-of-words.html#bow-for-complex-activities."><i class="fa fa-check"></i><b>7.6.1</b> BoW for Complex Activities.</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="graphs.html"><a href="graphs.html"><i class="fa fa-check"></i><b>7.7</b> Graphs</a><ul>
<li class="chapter" data-level="7.7.1" data-path="graphs.html"><a href="graphs.html#complex-activities-as-graphs"><i class="fa fa-check"></i><b>7.7.1</b> Complex Activities as Graphs</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="SummaryRepresentations.html"><a href="SummaryRepresentations.html"><i class="fa fa-check"></i><b>7.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="deeplearning.html"><a href="deeplearning.html"><i class="fa fa-check"></i><b>8</b> Predicting Behavior with Deep Learning</a><ul>
<li class="chapter" data-level="8.1" data-path="ann.html"><a href="ann.html"><i class="fa fa-check"></i><b>8.1</b> Introduction to Artificial Neural Networks</a><ul>
<li class="chapter" data-level="8.1.1" data-path="ann.html"><a href="ann.html#sigmoid-and-relu-units"><i class="fa fa-check"></i><b>8.1.1</b> Sigmoid and ReLU Units</a></li>
<li class="chapter" data-level="8.1.2" data-path="ann.html"><a href="ann.html#assembling-units-into-layers"><i class="fa fa-check"></i><b>8.1.2</b> Assembling Units into Layers</a></li>
<li class="chapter" data-level="8.1.3" data-path="ann.html"><a href="ann.html#deep-neural-networks"><i class="fa fa-check"></i><b>8.1.3</b> Deep Neural Networks</a></li>
<li class="chapter" data-level="8.1.4" data-path="ann.html"><a href="ann.html#learning-the-parameters"><i class="fa fa-check"></i><b>8.1.4</b> Learning the Parameters</a></li>
<li class="chapter" data-level="8.1.5" data-path="ann.html"><a href="ann.html#parameter-learning-example-in-r"><i class="fa fa-check"></i><b>8.1.5</b> Parameter Learning Example in R</a></li>
<li class="chapter" data-level="8.1.6" data-path="ann.html"><a href="ann.html#stochastic-gradient-descent"><i class="fa fa-check"></i><b>8.1.6</b> Stochastic Gradient Descent</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="keras-and-tensorflow-with-r.html"><a href="keras-and-tensorflow-with-r.html"><i class="fa fa-check"></i><b>8.2</b> Keras and TensorFlow with R</a><ul>
<li class="chapter" data-level="8.2.1" data-path="keras-and-tensorflow-with-r.html"><a href="keras-and-tensorflow-with-r.html#keras-example"><i class="fa fa-check"></i><b>8.2.1</b> Keras Example</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="classification-with-neural-networks.html"><a href="classification-with-neural-networks.html"><i class="fa fa-check"></i><b>8.3</b> Classification with Neural Networks</a><ul>
<li class="chapter" data-level="8.3.1" data-path="classification-with-neural-networks.html"><a href="classification-with-neural-networks.html#classification-of-electromyography-signals"><i class="fa fa-check"></i><b>8.3.1</b> Classification of Electromyography Signals</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>8.4</b> Overfitting</a><ul>
<li class="chapter" data-level="8.4.1" data-path="overfitting.html"><a href="overfitting.html#early-stopping"><i class="fa fa-check"></i><b>8.4.1</b> Early Stopping</a></li>
<li class="chapter" data-level="8.4.2" data-path="overfitting.html"><a href="overfitting.html#dropout"><i class="fa fa-check"></i><b>8.4.2</b> Dropout</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="fine-tuning-a-neural-network.html"><a href="fine-tuning-a-neural-network.html"><i class="fa fa-check"></i><b>8.5</b> Fine-Tuning a Neural Network</a></li>
<li class="chapter" data-level="8.6" data-path="cnns.html"><a href="cnns.html"><i class="fa fa-check"></i><b>8.6</b> Convolutional Neural Networks</a><ul>
<li class="chapter" data-level="8.6.1" data-path="cnns.html"><a href="cnns.html#convolutions"><i class="fa fa-check"></i><b>8.6.1</b> Convolutions</a></li>
<li class="chapter" data-level="8.6.2" data-path="cnns.html"><a href="cnns.html#pooling-operations"><i class="fa fa-check"></i><b>8.6.2</b> Pooling Operations</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="cnns-with-keras.html"><a href="cnns-with-keras.html"><i class="fa fa-check"></i><b>8.7</b> CNNs with Keras</a><ul>
<li class="chapter" data-level="8.7.1" data-path="cnns-with-keras.html"><a href="cnns-with-keras.html#example-1"><i class="fa fa-check"></i><b>8.7.1</b> Example 1</a></li>
<li class="chapter" data-level="8.7.2" data-path="cnns-with-keras.html"><a href="cnns-with-keras.html#example-2"><i class="fa fa-check"></i><b>8.7.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="cnnSmile.html"><a href="cnnSmile.html"><i class="fa fa-check"></i><b>8.8</b> Smiles Detection with a CNN</a></li>
<li class="chapter" data-level="8.9" data-path="SummaryDeepLearning.html"><a href="SummaryDeepLearning.html"><i class="fa fa-check"></i><b>8.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multiuser.html"><a href="multiuser.html"><i class="fa fa-check"></i><b>9</b> Multi-User Validation</a><ul>
<li class="chapter" data-level="9.1" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i><b>9.1</b> Mixed Models</a><ul>
<li class="chapter" data-level="9.1.1" data-path="mixed-models.html"><a href="mixed-models.html#skeleton-action-recognition-with-mixed-models"><i class="fa fa-check"></i><b>9.1.1</b> Skeleton Action Recognition with Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="user-independent-models.html"><a href="user-independent-models.html"><i class="fa fa-check"></i><b>9.2</b> User-Independent Models</a></li>
<li class="chapter" data-level="9.3" data-path="user-dependent-models.html"><a href="user-dependent-models.html"><i class="fa fa-check"></i><b>9.3</b> User-Dependent Models</a></li>
<li class="chapter" data-level="9.4" data-path="user-adaptive-models.html"><a href="user-adaptive-models.html"><i class="fa fa-check"></i><b>9.4</b> User-Adaptive Models</a><ul>
<li class="chapter" data-level="9.4.1" data-path="user-adaptive-models.html"><a href="user-adaptive-models.html#transfer-learning"><i class="fa fa-check"></i><b>9.4.1</b> Transfer Learning</a></li>
<li class="chapter" data-level="9.4.2" data-path="user-adaptive-models.html"><a href="user-adaptive-models.html#a-user-adaptive-model-for-activity-recognition"><i class="fa fa-check"></i><b>9.4.2</b> A User-Adaptive Model for Activity Recognition</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="SummaryMultiUser.html"><a href="SummaryMultiUser.html"><i class="fa fa-check"></i><b>9.5</b> Summary</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendixInstall.html"><a href="appendixInstall.html"><i class="fa fa-check"></i><b>A</b> Setup Your Environment</a><ul>
<li class="chapter" data-level="A.1" data-path="installing-the-datasets.html"><a href="installing-the-datasets.html"><i class="fa fa-check"></i><b>A.1</b> Installing the Datasets</a></li>
<li class="chapter" data-level="A.2" data-path="installing-the-examples-source-code.html"><a href="installing-the-examples-source-code.html"><i class="fa fa-check"></i><b>A.2</b> Installing the Examples Source Code</a></li>
<li class="chapter" data-level="A.3" data-path="installing-keras-and-tensorflow-.html"><a href="installing-keras-and-tensorflow-.html"><i class="fa fa-check"></i><b>A.3</b> Installing Keras and TensorFlow.</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendixDatasets.html"><a href="appendixDatasets.html"><i class="fa fa-check"></i><b>B</b> Datasets</a><ul>
<li class="chapter" data-level="B.1" data-path="complex-activities.html"><a href="complex-activities.html"><i class="fa fa-check"></i><b>B.1</b> COMPLEX ACTIVITIES</a></li>
<li class="chapter" data-level="B.2" data-path="depresjon.html"><a href="depresjon.html"><i class="fa fa-check"></i><b>B.2</b> DEPRESJON</a></li>
<li class="chapter" data-level="B.3" data-path="electromyography.html"><a href="electromyography.html"><i class="fa fa-check"></i><b>B.3</b> ELECTROMYOGRAPHY</a></li>
<li class="chapter" data-level="B.4" data-path="hand-gestures.html"><a href="hand-gestures.html"><i class="fa fa-check"></i><b>B.4</b> HAND GESTURES</a></li>
<li class="chapter" data-level="B.5" data-path="home-tasks.html"><a href="home-tasks.html"><i class="fa fa-check"></i><b>B.5</b> HOME TASKS</a></li>
<li class="chapter" data-level="B.6" data-path="homicide-reports.html"><a href="homicide-reports.html"><i class="fa fa-check"></i><b>B.6</b> HOMICIDE REPORTS</a></li>
<li class="chapter" data-level="B.7" data-path="indoor-location.html"><a href="indoor-location.html"><i class="fa fa-check"></i><b>B.7</b> INDOOR LOCATION</a></li>
<li class="chapter" data-level="B.8" data-path="sheep-goats.html"><a href="sheep-goats.html"><i class="fa fa-check"></i><b>B.8</b> SHEEP GOATS</a></li>
<li class="chapter" data-level="B.9" data-path="skeleton-actions.html"><a href="skeleton-actions.html"><i class="fa fa-check"></i><b>B.9</b> SKELETON ACTIONS</a></li>
<li class="chapter" data-level="B.10" data-path="smartphone-activities.html"><a href="smartphone-activities.html"><i class="fa fa-check"></i><b>B.10</b> SMARTPHONE ACTIVITIES</a></li>
<li class="chapter" data-level="B.11" data-path="smiles.html"><a href="smiles.html"><i class="fa fa-check"></i><b>B.11</b> SMILES</a></li>
<li class="chapter" data-level="B.12" data-path="students-mental-health.html"><a href="students-mental-health.html"><i class="fa fa-check"></i><b>B.12</b> STUDENTS’ MENTAL HEALTH</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="citing-this-book.html"><a href="citing-this-book.html"><i class="fa fa-check"></i>Citing this Book</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Behavior Analysis with Machine Learning and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dynamic-time-warping" class="section level2">
<h2><span class="header-section-number">2.4</span> Dynamic Time Warping</h2>

<div class="rmdfolder">
<code>dtw_example.R</code>
</div>

<p>In the previous activity recognition example, we used the extracted features represented as feature vectors to train the classifiers instead of using the raw data. This can lead to temporal information loss. In the previous example, we could classify the activities with reasonable accuracy since the extracted features were able to retain enough information from the raw data. However, in some cases, the need to retain temporal information is crucial. For example, in hand signature recognition, one needs to check if a query signature matches one of the signatures from a database. The signatures need to have an almost exact match to authenticate a user, i.e, they need to look very similar. If we represent each signature as a feature vector, it can turn out that two signatures have very similar feature vectors even though they look completely different. For example, Figure <a href="dynamic-time-warping.html#fig:correlations">2.12</a> shows four datasets. They look very different but they all have the same correlation of <span class="math inline">\(0.816\)</span><a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>.</p>
<div class="figure" style="text-align: center"><span id="fig:correlations"></span>
<img src="images/correlations.png" alt="Four datasets with the same correlation of 0.816." width="90%" />
<p class="caption">
Figure 2.12: Four datasets with the same correlation of 0.816.
</p>
</div>
<p>To avoid this potential issue, we can also include time-dependent information into our models by keeping the order of the data points. Another issue is that two time series that belong to the same class will still have some differences. Every time the same person signs a document the signature will vary a bit. In the same way, when we pronounce a word, sometimes we emphasize some letters or speak at different speeds. Figure <a href="dynamic-time-warping.html#fig:verygood">2.13</a> shows two versions of the sentence “very good”. In the second one (bottom) the speaker emphasizes the “e” and as a result, the two sentences are not aligned in time anymore but they have the same meaning.</p>
<div class="figure" style="text-align: center"><span id="fig:verygood"></span>
<img src="images/verygood.png" alt="Time shift example between two sentences." width="30%" />
<p class="caption">
Figure 2.13: Time shift example between two sentences.
</p>
</div>
<p>If we wanted to compare two sequences we could use the well known Euclidean distance. However since the two sequences may not be aligned in time, the result could be misleading. To account for this “time-shift” effect in time series data we can use <em>Dynamic Time Warping</em> (DTW) <span class="citation">(Sakoe et al. <a href="#ref-sakoe1990dynamic" role="doc-biblioref">1990</a>)</span> when comparing two time series. DTW is a method that:</p>
<ul>
<li>Finds an optimal match between two given time-dependent sequences.</li>
<li>Computes the dissimilarity between the sequences.</li>
<li>Finds the optimal deformation of one of the sequences onto the other.</li>
</ul>
<p>Another advantage of DTW is that the time series do not need to be of the same length. Suppose we have two time series, a <em>query</em>, and a <em>reference</em> we want to compare with:</p>
<p><span class="math display">\[\begin{align*}
query&amp;=(2,2,2,4,4,3)\\
ref&amp;=(2,2,3,3,2)
\end{align*}\]</span></p>
<p>The first thing to note is that both sequences differ in length. Figure <a href="dynamic-time-warping.html#fig:queryref">2.14</a> shows a plot with the two sequences. The <em>query</em> is the solid line. It can be seen that the <em>query</em> seems to be shifted to the right one position with respect to the <em>reference</em>. The plot also shows the resulting alignment after applying the DTW algorithm (dashed lines between the sequences). The resulting distance between the sequences is <span class="math inline">\(3\)</span>. In the following, we will see how the problem can be formalized and the steps to compute that final distance of <span class="math inline">\(3\)</span>. Don’t worry if you find the math notation a bit difficult to grasp at this pint. A step by step example will follow which should help to explain how the method works.</p>
<div class="figure" style="text-align: center"><span id="fig:queryref"></span>
<img src="images/query_ref.png" alt="DTW alignment between the query and reference sequences (Solid line is the query)." width="100%" />
<p class="caption">
Figure 2.14: DTW alignment between the query and reference sequences (Solid line is the query).
</p>
</div>
<p>The problem of aligning two sequences can be formalized as follows <span class="citation">(Rabiner and Juang <a href="#ref-Rabiner1993" role="doc-biblioref">1993</a>)</span>. Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be two sequences:</p>
<p><span class="math display">\[\begin{align*}
X&amp;=(x_1,x_2,\dots,x_{T_x}) \\
Y&amp;=(y_1,y_2,\dots,y_{T_y})
\end{align*}\]</span></p>
<p>where <span class="math inline">\(x_i\)</span> and <span class="math inline">\(y_i\)</span> are vectors. In the previous example, the vectors only have one element since the sequences are <span class="math inline">\(1\)</span>-dimensional but DTW also works with multidimensional sequences. <span class="math inline">\(T_x\)</span> and <span class="math inline">\(T_y\)</span> are the sequences’ lengths. Let</p>
<p><span class="math display">\[\begin{align*}
d(i_x,i_y)
\end{align*}\]</span></p>
<p>be the <em>dissimilarity</em> (distance) between vectors <span class="math inline">\(x_i\)</span> and <span class="math inline">\(y_i\)</span> (e.g., Euclidean distance). Then, <span class="math inline">\(\phi_x\)</span> and <span class="math inline">\(\phi_y\)</span> are the warping functions that relate <span class="math inline">\(i_x\)</span> and <span class="math inline">\(i_y\)</span> to a common axis <span class="math inline">\(k\)</span>:</p>
<p><span class="math display">\[\begin{align*}
i_x&amp;=\phi_x (k), k=1,2,\dots,T \\
i_y&amp;=\phi_y (k), k=1,2,\dots,T.
\end{align*}\]</span></p>
<p>The total dissimilarity between the two sequences is:</p>
<p><span class="math display" id="eq:dtwDissimilarity">\[\begin{equation}
  d_\phi (X,Y) = \sum_{k=1}^T{d\left(\phi_x (k), \phi_y (k)\right)}
  \tag{2.10}
\end{equation}\]</span></p>
<p>The aim is to find the warping function <span class="math inline">\(\phi\)</span> that minimizes the total dissimilarity:</p>
<p><span class="math display" id="eq:dtwmin">\[\begin{equation}
  \operatorname*{min}_{\phi} d_\phi (X,Y)
  \tag{2.11}
\end{equation}\]</span></p>
<p>The solution can be efficiently computed using dynamic programming. Usually, when solving this minimization problem, some constraints are applied:</p>
<ul>
<li><strong>Endpoint constraints.</strong> This constraint makes sure that the first and last elements of each sequence are connected.</li>
</ul>
<p><span class="math display">\[\begin{align*}
\phi_x (1)&amp;=1, \phi_y (1)=1 \\
\phi_x (T)&amp;=T_x, \phi_y (T)=T_y
\end{align*}\]</span></p>
<ul>
<li><strong>Monotonicity.</strong> This constraint allows ‘time to flow’ only from left to right. That is, we can not go back in time.</li>
</ul>
<p><span class="math display">\[\begin{align*}
\phi_x (k+1) \geq \phi_x(k) \\
\phi_y (k+1) \geq \phi_y(k)
\end{align*}\]</span></p>
<ul>
<li><strong>Local constraints.</strong> For example, allow jumps of at most <span class="math inline">\(1\)</span> step.</li>
</ul>
<p><span class="math display">\[\begin{align*}
\phi_x (k+1) - \phi_x(k) \leq 1 \\
\phi_y (k+1) - \phi_y(k) \leq 1
\end{align*}\]</span></p>
<p>Also, it is possible to apply global constraints, other local constraints, and apply different weights to slopes but the three described above are the most common ones. For a comprehensive list of constraints, please see <span class="citation">(Rabiner and Juang <a href="#ref-Rabiner1993" role="doc-biblioref">1993</a>)</span>. Now let’s get back to our example and go through the steps to compute the dissimilarity and warping functions between our query (<span class="math inline">\(Q\)</span>) and reference (<span class="math inline">\(R\)</span>) sequences:</p>
<p><span class="math display">\[\begin{align*}
Q&amp;=(2,2,2,4,4,3) \\
R&amp;=(2,2,3,3,2)
\end{align*}\]</span></p>
<p>The first step is to compute a <em>local cost matrix</em>. This is just a matrix that contains the distance between every pair of points between the two sequences. For this example, we will use the <em>Manhattan distance</em>. Since our sequences are <span class="math inline">\(1\)</span>-dimensional this distance can be computed as the absolute difference <span class="math inline">\(|x_i - y_i|\)</span>. Figure <a href="dynamic-time-warping.html#fig:localCost">2.15</a> shows the resulting local cost matrix.</p>
<div class="figure" style="text-align: center"><span id="fig:localCost"></span>
<img src="images/localCostMatrix.png" alt="Local cost matrix between Q and R." width="50%" />
<p class="caption">
Figure 2.15: Local cost matrix between Q and R.
</p>
</div>
<p>For example, position <span class="math inline">\((1,1)=0\)</span> (<em>row</em>,<em>column</em>) because the first element of <span class="math inline">\(Q\)</span> is <span class="math inline">\(2\)</span> and the first element of <span class="math inline">\(R\)</span> is also <span class="math inline">\(2\)</span>, thus, <span class="math inline">\(|2-2|=0\)</span>. The rest of the matrix is filled in the same way. In dynamic programming, partial results are computed and stored in a table. Figure <a href="dynamic-time-warping.html#fig:dynamicTable">2.16</a> shows the final dynamic programming table computed from the local cost matrix. Initially, this table is empty. We start to fill it from bottom left at position <span class="math inline">\((1,1)\)</span>. From the local cost matrix, the cost at position <span class="math inline">\((1,1)\)</span> is <span class="math inline">\(0\)</span> so the cost at that position in the dynamic programming table is <span class="math inline">\(0\)</span>. Then we can start filling in the contiguous cells. The only direction from which we can arrive at position <span class="math inline">\((1,2)\)</span> is from the west. The cost at position <span class="math inline">\((1,2)\)</span> from the local cost matrix is <span class="math inline">\(0\)</span> and the cost of the <em>minimum</em> of the cell from the west <span class="math inline">\((1,1)\)</span> is also <span class="math inline">\(0\)</span>. So <span class="math inline">\(W:0+0=0\)</span>. For each cell we add the current cost plus the minimum cost when coming from the contiguous cell. The minimum costs are marked with red. For some cells it is possible to arrive from three different directions: S, W, and SW, thus we need to compute the cost when coming from each of those. The final minimum cost at position <span class="math inline">\((5,6)\)</span> is <span class="math inline">\(3\)</span>. Thus, that is the global DTW distance. In the example, it is possible to get the minimum at <span class="math inline">\((5,6)\)</span> when arriving from the south or southwest.</p>
<div class="figure" style="text-align: center"><span id="fig:dynamicTable"></span>
<img src="images/dynamicprogramming.png" alt="Dynamic programming table." width="90%" />
<p class="caption">
Figure 2.16: Dynamic programming table.
</p>
</div>
<p>Once the table is filled in, we can backtrack starting at <span class="math inline">\((5,6)\)</span> to find the warping functions. Figure <a href="dynamic-time-warping.html#fig:warpingResult">2.17</a> shows the final warping functions. Because of the endpoint constraints we know that <span class="math inline">\(\phi_Q(1)=1, \phi_R(1)=1\)</span> and <span class="math inline">\(\phi_Q(6)=6, \phi_R(6)=5\)</span>. Then, from <span class="math inline">\((5,6)\)</span> the minimum contiguous value is <span class="math inline">\(2\)</span> coming from SW, thus <span class="math inline">\(\phi_Q(5)=5, \phi_R(5)=4\)</span> and so on. Note that we could also had chosen to arrive from the south with the same minimum value of <span class="math inline">\(2\)</span> but still this would have resulted in the same overall distance. The dashed line in figure <a href="dynamic-time-warping.html#fig:dynamicTable">2.16</a> shows the full backtracking.</p>
<div class="figure" style="text-align: center"><span id="fig:warpingResult"></span>
<img src="images/warpingResult.png" alt="Resulting warping functions." width="70%" />
<p class="caption">
Figure 2.17: Resulting warping functions.
</p>
</div>
<p>The runtime complexity of DTW is <span class="math inline">\(O(T_x T_y)\)</span> which is the required time to compute the local cost matrix and the dynamic programming table.</p>
<p>In R, the <code>dtw</code> package <span class="citation">(Giorgino <a href="#ref-giorgino2009" role="doc-biblioref">2009</a>)</span> has the function <code>dtw()</code> to compute the DTW distance between two sequences. Let’s use this package to solve the previous example.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="dynamic-time-warping.html#cb36-1"></a><span class="kw">library</span>(<span class="st">&quot;dtw&quot;</span>)</span>
<span id="cb36-2"><a href="dynamic-time-warping.html#cb36-2"></a></span>
<span id="cb36-3"><a href="dynamic-time-warping.html#cb36-3"></a><span class="co"># Sequences from the example</span></span>
<span id="cb36-4"><a href="dynamic-time-warping.html#cb36-4"></a>query &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>)</span>
<span id="cb36-5"><a href="dynamic-time-warping.html#cb36-5"></a>ref &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb36-6"><a href="dynamic-time-warping.html#cb36-6"></a></span>
<span id="cb36-7"><a href="dynamic-time-warping.html#cb36-7"></a><span class="co"># Find dtw distance.</span></span>
<span id="cb36-8"><a href="dynamic-time-warping.html#cb36-8"></a>alignment &lt;-<span class="st"> </span><span class="kw">dtw</span>(query, ref,</span>
<span id="cb36-9"><a href="dynamic-time-warping.html#cb36-9"></a>                 <span class="dt">step =</span> symmetric1, <span class="dt">keep.internals =</span> T)</span></code></pre></div>
<p>The <code>keep.internals = T</code> keeps the input data so it can be accessed later, e.g., for plotting. The cost matrix and final distance can be accessed from the resulting object. The <code>step</code> argument specifies a step pattern. A step pattern describes some of the algorithm constraints such as endpoint and local constraints. In this case, we use <code>symmetric1</code> which applies the constraints explained before. We can access the cost matrix and the final distance <span class="math inline">\(\phi_x\)</span> and <span class="math inline">\(\phi_y\)</span> as follows:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="dynamic-time-warping.html#cb37-1"></a>alignment<span class="op">$</span>localCostMatrix</span>
<span id="cb37-2"><a href="dynamic-time-warping.html#cb37-2"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span id="cb37-3"><a href="dynamic-time-warping.html#cb37-3"></a><span class="co">#&gt; [1,]    0    0    1    1    0</span></span>
<span id="cb37-4"><a href="dynamic-time-warping.html#cb37-4"></a><span class="co">#&gt; [2,]    0    0    1    1    0</span></span>
<span id="cb37-5"><a href="dynamic-time-warping.html#cb37-5"></a><span class="co">#&gt; [3,]    0    0    1    1    0</span></span>
<span id="cb37-6"><a href="dynamic-time-warping.html#cb37-6"></a><span class="co">#&gt; [4,]    2    2    1    1    2</span></span>
<span id="cb37-7"><a href="dynamic-time-warping.html#cb37-7"></a><span class="co">#&gt; [5,]    2    2    1    1    2</span></span>
<span id="cb37-8"><a href="dynamic-time-warping.html#cb37-8"></a><span class="co">#&gt; [6,]    1    1    0    0    1</span></span>
<span id="cb37-9"><a href="dynamic-time-warping.html#cb37-9"></a></span>
<span id="cb37-10"><a href="dynamic-time-warping.html#cb37-10"></a>alignment<span class="op">$</span>distance</span>
<span id="cb37-11"><a href="dynamic-time-warping.html#cb37-11"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb37-12"><a href="dynamic-time-warping.html#cb37-12"></a></span>
<span id="cb37-13"><a href="dynamic-time-warping.html#cb37-13"></a>alignment<span class="op">$</span>index1</span>
<span id="cb37-14"><a href="dynamic-time-warping.html#cb37-14"></a><span class="co">#&gt; [1] 1 2 3 4 5 6</span></span>
<span id="cb37-15"><a href="dynamic-time-warping.html#cb37-15"></a></span>
<span id="cb37-16"><a href="dynamic-time-warping.html#cb37-16"></a>alignment<span class="op">$</span>index2</span>
<span id="cb37-17"><a href="dynamic-time-warping.html#cb37-17"></a><span class="co">#&gt; [1] 1 1 2 3 4 5</span></span></code></pre></div>
<p>The local cost matrix is the same one as in Figure <a href="dynamic-time-warping.html#fig:localCost">2.15</a> but in rotated form. The resulting object also has the dynamic programming table which can be plotted along with the resulting backtracking.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="dynamic-time-warping.html#cb38-1"></a>ccm &lt;-<span class="st"> </span>alignment<span class="op">$</span>costMatrix</span>
<span id="cb38-2"><a href="dynamic-time-warping.html#cb38-2"></a><span class="kw">image</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ccm), <span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(ccm),</span>
<span id="cb38-3"><a href="dynamic-time-warping.html#cb38-3"></a>      ccm, <span class="dt">xlab =</span> <span class="st">&quot;Q&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;R&quot;</span>)</span>
<span id="cb38-4"><a href="dynamic-time-warping.html#cb38-4"></a><span class="kw">text</span>(<span class="kw">row</span>(ccm), <span class="kw">col</span>(ccm), <span class="dt">label =</span> ccm)</span>
<span id="cb38-5"><a href="dynamic-time-warping.html#cb38-5"></a><span class="kw">lines</span>(alignment<span class="op">$</span>index1, alignment<span class="op">$</span>index2)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:backtracking"></span>
<img src="images/backtracking.png" alt="Dynamic programming table and backtracking." width="90%" />
<p class="caption">
Figure 2.18: Dynamic programming table and backtracking.
</p>
</div>
<p>And finally, the aligned sequences can be plotted. The previous Figure <a href="dynamic-time-warping.html#fig:queryref">2.14</a> shows the result of the following command.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="dynamic-time-warping.html#cb39-1"></a><span class="kw">plot</span>(alignment, <span class="dt">type=</span><span class="st">&quot;two&quot;</span>, <span class="dt">off=</span><span class="fl">1.5</span>,</span>
<span id="cb39-2"><a href="dynamic-time-warping.html#cb39-2"></a>     <span class="dt">match.lty=</span><span class="dv">2</span>,</span>
<span id="cb39-3"><a href="dynamic-time-warping.html#cb39-3"></a>     <span class="dt">match.indices=</span><span class="dv">10</span>,</span>
<span id="cb39-4"><a href="dynamic-time-warping.html#cb39-4"></a>     <span class="dt">main=</span><span class="st">&quot;DTW resulting alignment&quot;</span>,</span>
<span id="cb39-5"><a href="dynamic-time-warping.html#cb39-5"></a>     <span class="dt">xlab=</span><span class="st">&quot;time&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;magnitude&quot;</span>)</span></code></pre></div>
<div id="sechandgestures" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Hand Gesture Recognition</h3>

<div class="rmdfolder">
<code>hand_gestures.R</code>, <code>hand_gestures_auxiliary.R</code>
</div>

<p>Gestures are a form of communication. They are often accompanied with speech but can also be used to communicate something independently of speech (like in sign language). Gestures allow us to externalize and emphasize emotions and thoughts. They are based on body movements from arms, hands, fingers, face, head, etc. Gestures can be used as a non-verbal way to identify and study behaviors for different purposes such as for emotion <span class="citation">(De Gelder <a href="#ref-de2006towards" role="doc-biblioref">2006</a>)</span> or for the identification of developmental disorders like autism <span class="citation">(Anzulewicz, Sobota, and Delafield-Butt <a href="#ref-anzulewicz2016toward" role="doc-biblioref">2016</a>)</span>.</p>
<p>Gestures can also be used to develop user-computer interaction applications. The following video shows an example application of gesture recognition for domotics. The application determines the indoor location using <span class="math inline">\(k\)</span>-nn as it was shown in this chapter. The gestures are classified using DTW (I’ll show how to do it in a moment). Based on the location and type of gesture, an specific home appliance is activated. I programmed that app some time ago using the same algorithms presented here.</p>
<iframe src="https://www.youtube.com/embed/47-35YmimN4" width="672" height="400px">
</iframe>
<p>To demonstrate how DTW can be used for hand gesture recognition, we will examine the <em>HAND GESTURES</em> dataset that was collected with a Smartphone using its accelerometer sensor. The data was collected by <span class="math inline">\(10\)</span> individuals who performed <span class="math inline">\(5\)</span> repetitions of <span class="math inline">\(10\)</span> different gestures (<em>‘triangle’</em>, <em>‘square’</em>, <em>‘circle’</em>, <em>‘a’</em>, <em>‘b’</em>, <em>‘c’</em>, <em>‘1’</em>, <em>‘2’</em>, <em>‘3’</em>, <em>‘4’</em>). The sensor is a tri-axial accelerometer that returns values for the <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> axes. The participants were not instructed to hold the smartphone in any particular way. The sampling rate was set at <span class="math inline">\(50\)</span> Hz. To record a gesture, the user presses the phone’s screen with her/his thumb, performs the gesture in the air, and stops pressing the screen after the gesture is complete. Figure <a href="dynamic-time-warping.html#fig:gesturesFigure">2.19</a> shows the start and end positions of the <span class="math inline">\(10\)</span> gestures.</p>
<div class="figure" style="text-align: center"><span id="fig:gesturesFigure"></span>
<img src="images/gestures.png" alt="Paths for the 10 considered gestures." width="40%" />
<p class="caption">
Figure 2.19: Paths for the 10 considered gestures.
</p>
</div>
<p>In order to make the recognition orientation-independent, we can compute the <em>magnitude</em> of the <span class="math inline">\(3\)</span> accelerometer axes. This will provide us with the overall movement patterns regardless of orientation.</p>
<p><span class="math display" id="eq:magnitude">\[\begin{equation}
Magnitude(t) = \sqrt {{a_x}{{(t)}^2} + {a_y}{{(t)}^2} + {a_z}{{(t)}^2}}
\tag{2.12}
\end{equation}\]</span></p>
<p>where <span class="math inline">\({a_x}{{(t)}}\)</span>, <span class="math inline">\({a_y}{{(t)}}\)</span> and <span class="math inline">\({a_z}{{(t)}}\)</span> are the accelerations at time <span class="math inline">\(t\)</span>.</p>
<p>Figure <a href="dynamic-time-warping.html#fig:handGestureMagnitude">2.20</a> shows the raw accelerometer values (dashed lines) for a <em>triangle</em> gesture. The solid line shows the resulting magnitude. This will also simplify things since we will now work with <span class="math inline">\(1\)</span>-dimensional sequences by just using the magnitude instead of the other <span class="math inline">\(3\)</span> axes.</p>
<div class="figure" style="text-align: center"><span id="fig:handGestureMagnitude"></span>
<img src="images/triangle_xyzmagnitude.png" alt="Triangle gesture." width="90%" />
<p class="caption">
Figure 2.20: Triangle gesture.
</p>
</div>
<p>The gestures are stored in text files that contain the <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> recordings. The script <code>hand_gestures_auxiliary.R</code> has some auxiliary functions to preprocess the data. Since the sequences of each gesture are of varying length, storing them as a data frame could be problematic since data frames have fixed sizes. Instead, the <code>gen.instances()</code> function processes the files and returns all hand gestures as a list. This function also computes the magnitude (equation <a href="dynamic-time-warping.html#eq:magnitude">(2.12)</a>). The following code (from <code>hand_gestures.R</code>) calls the <code>gen.instances()</code> function and stores the results in the <code>instances</code> variable which is a list. Then, we select the first and second instances to be the query and the reference.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="dynamic-time-warping.html#cb40-1"></a><span class="co"># Format instances from files.</span></span>
<span id="cb40-2"><a href="dynamic-time-warping.html#cb40-2"></a>instances &lt;-<span class="st"> </span><span class="kw">gen.instances</span>(<span class="st">&quot;../data/hand_gestures/&quot;</span>)</span>
<span id="cb40-3"><a href="dynamic-time-warping.html#cb40-3"></a></span>
<span id="cb40-4"><a href="dynamic-time-warping.html#cb40-4"></a><span class="co"># Use first instance as the query.</span></span>
<span id="cb40-5"><a href="dynamic-time-warping.html#cb40-5"></a>query &lt;-<span class="st"> </span>instances[[<span class="dv">1</span>]]</span>
<span id="cb40-6"><a href="dynamic-time-warping.html#cb40-6"></a></span>
<span id="cb40-7"><a href="dynamic-time-warping.html#cb40-7"></a><span class="co"># Use second instance as the reference.</span></span>
<span id="cb40-8"><a href="dynamic-time-warping.html#cb40-8"></a>ref &lt;-<span class="st"> </span>instances[[<span class="dv">2</span>]]</span></code></pre></div>
<p>Each element in <code>instances</code> is also a list that stores the <em>type</em> and <em>values</em> (magnitude) of each gesture.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="dynamic-time-warping.html#cb41-1"></a><span class="co"># Print their respective classes</span></span>
<span id="cb41-2"><a href="dynamic-time-warping.html#cb41-2"></a><span class="kw">print</span>(query<span class="op">$</span>type)</span>
<span id="cb41-3"><a href="dynamic-time-warping.html#cb41-3"></a><span class="co">#&gt; [1] &quot;1&quot;</span></span>
<span id="cb41-4"><a href="dynamic-time-warping.html#cb41-4"></a></span>
<span id="cb41-5"><a href="dynamic-time-warping.html#cb41-5"></a><span class="kw">print</span>(ref<span class="op">$</span>type)</span>
<span id="cb41-6"><a href="dynamic-time-warping.html#cb41-6"></a><span class="co">#&gt; [1] &quot;1&quot;</span></span></code></pre></div>
<p>Here, the first two instances are of type <em>‘1’</em>. We can also print the magnitude values.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="dynamic-time-warping.html#cb42-1"></a><span class="co"># Print values.</span></span>
<span id="cb42-2"><a href="dynamic-time-warping.html#cb42-2"></a><span class="kw">print</span>(query<span class="op">$</span>values)</span>
<span id="cb42-3"><a href="dynamic-time-warping.html#cb42-3"></a><span class="co">#&gt; [1]  9.167477  9.291464  9.729926  9.901090  ....</span></span></code></pre></div>
<p>In this case, both classes are “1”. We can use the <code>dtw()</code> function to compute the similarity between the <em>query</em> and the <em>reference</em> instance and plot the resulting alignment.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="dynamic-time-warping.html#cb43-1"></a>alignment &lt;-<span class="st"> </span><span class="kw">dtw</span>(query<span class="op">$</span>values, ref<span class="op">$</span>values, <span class="dt">keep =</span> <span class="ot">TRUE</span>)</span>
<span id="cb43-2"><a href="dynamic-time-warping.html#cb43-2"></a></span>
<span id="cb43-3"><a href="dynamic-time-warping.html#cb43-3"></a><span class="co"># Print similarity (distance)</span></span>
<span id="cb43-4"><a href="dynamic-time-warping.html#cb43-4"></a>alignment<span class="op">$</span>distance</span>
<span id="cb43-5"><a href="dynamic-time-warping.html#cb43-5"></a><span class="co">#&gt; [1] 68.56493</span></span>
<span id="cb43-6"><a href="dynamic-time-warping.html#cb43-6"></a></span>
<span id="cb43-7"><a href="dynamic-time-warping.html#cb43-7"></a><span class="co"># Plot result.</span></span>
<span id="cb43-8"><a href="dynamic-time-warping.html#cb43-8"></a><span class="kw">plot</span>(alignment, <span class="dt">type=</span><span class="st">&quot;two&quot;</span>, <span class="dt">off=</span><span class="dv">1</span>, <span class="dt">match.lty=</span><span class="dv">2</span>, <span class="dt">match.indices=</span><span class="dv">40</span>,</span>
<span id="cb43-9"><a href="dynamic-time-warping.html#cb43-9"></a>     <span class="dt">main=</span><span class="st">&quot;DTW resulting alignment&quot;</span>,</span>
<span id="cb43-10"><a href="dynamic-time-warping.html#cb43-10"></a>     <span class="dt">xlab=</span><span class="st">&quot;time&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;magnitude&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:alignmentExample"></span>
<img src="images/alignmentExample.png" alt="Resulting alignment." width="90%" />
<p class="caption">
Figure 2.21: Resulting alignment.
</p>
</div>
<p>To perform the actual classification, we will use our well-known <span class="math inline">\(k\)</span>-nn classifier with <span class="math inline">\(k=1\)</span>. To classify a <em>query instance</em>, we need to compute the DTW distance from it to every other instance in the training set and predict the label from the closest one. We will test the performance using <span class="math inline">\(10\)</span>-fold cross-validation. Since computing all DTW distances takes some time, we can precompute all pairs of distances and store them in a matrix. The auxiliary function does just that <code>matrix.distances()</code>. Since this can take some minutes, the results are saved so we don’t need to wait again.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="dynamic-time-warping.html#cb44-1"></a>D &lt;-<span class="st"> </span><span class="kw">matrix.distances</span>(instances)</span>
<span id="cb44-2"><a href="dynamic-time-warping.html#cb44-2"></a></span>
<span id="cb44-3"><a href="dynamic-time-warping.html#cb44-3"></a><span class="co"># Save results.</span></span>
<span id="cb44-4"><a href="dynamic-time-warping.html#cb44-4"></a><span class="kw">save</span>(D, <span class="dt">file=</span><span class="st">&quot;D.RData&quot;</span>)</span></code></pre></div>
<p>The <code>matrix.distances()</code> returns a list. The first element is an array with the gestures’ classes and the second element is the actual distance matrix. The elements in the diagonal are set to <code>Inf</code> to signal that we don’t want to take into account the dissimilarity between a gesture with itself.</p>
<p>For convenience, this matrix is already stored in the file <code>D.RData</code> located this chapter’s code directory. The following code performs the <span class="math inline">\(10\)</span>-fold cross-validation and computes the performance results.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="dynamic-time-warping.html#cb45-1"></a><span class="co"># Load the DTW distances matrix.</span></span>
<span id="cb45-2"><a href="dynamic-time-warping.html#cb45-2"></a><span class="kw">load</span>(<span class="st">&quot;D.RData&quot;</span>)</span>
<span id="cb45-3"><a href="dynamic-time-warping.html#cb45-3"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb45-4"><a href="dynamic-time-warping.html#cb45-4"></a>k &lt;-<span class="st"> </span><span class="dv">10</span> <span class="co"># Number of folds.</span></span>
<span id="cb45-5"><a href="dynamic-time-warping.html#cb45-5"></a>folds &lt;-<span class="st"> </span><span class="kw">sample</span>(k, <span class="dt">size =</span> <span class="kw">length</span>(D[[<span class="dv">1</span>]]), <span class="dt">replace =</span> T)</span>
<span id="cb45-6"><a href="dynamic-time-warping.html#cb45-6"></a>predictions &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb45-7"><a href="dynamic-time-warping.html#cb45-7"></a>groundTruth &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb45-8"><a href="dynamic-time-warping.html#cb45-8"></a></span>
<span id="cb45-9"><a href="dynamic-time-warping.html#cb45-9"></a><span class="co"># Implement k-nn with k=1.</span></span>
<span id="cb45-10"><a href="dynamic-time-warping.html#cb45-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb45-11"><a href="dynamic-time-warping.html#cb45-11"></a>  </span>
<span id="cb45-12"><a href="dynamic-time-warping.html#cb45-12"></a>  trainSet &lt;-<span class="st"> </span><span class="kw">which</span>(folds <span class="op">!=</span><span class="st"> </span>i)</span>
<span id="cb45-13"><a href="dynamic-time-warping.html#cb45-13"></a>  testSet &lt;-<span class="st"> </span><span class="kw">which</span>(folds <span class="op">==</span><span class="st"> </span>i)</span>
<span id="cb45-14"><a href="dynamic-time-warping.html#cb45-14"></a>  train.labels &lt;-<span class="st"> </span>D[[<span class="dv">1</span>]][trainSet]</span>
<span id="cb45-15"><a href="dynamic-time-warping.html#cb45-15"></a>  </span>
<span id="cb45-16"><a href="dynamic-time-warping.html#cb45-16"></a>  <span class="cf">for</span>(query <span class="cf">in</span> testSet){</span>
<span id="cb45-17"><a href="dynamic-time-warping.html#cb45-17"></a>    </span>
<span id="cb45-18"><a href="dynamic-time-warping.html#cb45-18"></a>    type &lt;-<span class="st"> </span>D[[<span class="dv">1</span>]][query]</span>
<span id="cb45-19"><a href="dynamic-time-warping.html#cb45-19"></a>    distances &lt;-<span class="st"> </span>D[[<span class="dv">2</span>]][query, ][trainSet]</span>
<span id="cb45-20"><a href="dynamic-time-warping.html#cb45-20"></a>    </span>
<span id="cb45-21"><a href="dynamic-time-warping.html#cb45-21"></a>    <span class="co"># Return the closest one.</span></span>
<span id="cb45-22"><a href="dynamic-time-warping.html#cb45-22"></a>    nn &lt;-<span class="st"> </span><span class="kw">sort</span>(distances, <span class="dt">index.return =</span> T)<span class="op">$</span>ix[<span class="dv">1</span>]</span>
<span id="cb45-23"><a href="dynamic-time-warping.html#cb45-23"></a>    pred &lt;-<span class="st"> </span>train.labels[nn]</span>
<span id="cb45-24"><a href="dynamic-time-warping.html#cb45-24"></a>    predictions &lt;-<span class="st"> </span><span class="kw">c</span>(predictions, pred)</span>
<span id="cb45-25"><a href="dynamic-time-warping.html#cb45-25"></a>    groundTruth &lt;-<span class="st"> </span><span class="kw">c</span>(groundTruth, type)</span>
<span id="cb45-26"><a href="dynamic-time-warping.html#cb45-26"></a>    </span>
<span id="cb45-27"><a href="dynamic-time-warping.html#cb45-27"></a>  }</span>
<span id="cb45-28"><a href="dynamic-time-warping.html#cb45-28"></a>} <span class="co"># end of for</span></span></code></pre></div>
<p>The line <code>distances &lt;- D[[2]][query, ][trainSet]</code> retrieves the pre-computed distances between the test <em>query</em> and all gestures in the train set. Then, those distances are sorted in ascending order and the class from the closest one is used as the prediction. Finally, we can compute the performance.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="dynamic-time-warping.html#cb46-1"></a>cm &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(<span class="kw">factor</span>(predictions),</span>
<span id="cb46-2"><a href="dynamic-time-warping.html#cb46-2"></a>                      <span class="kw">factor</span>(groundTruth))</span>
<span id="cb46-3"><a href="dynamic-time-warping.html#cb46-3"></a></span>
<span id="cb46-4"><a href="dynamic-time-warping.html#cb46-4"></a><span class="co"># Compute performance metrics per class.</span></span>
<span id="cb46-5"><a href="dynamic-time-warping.html#cb46-5"></a>cm<span class="op">$</span>byClass[,<span class="kw">c</span>(<span class="st">&quot;Recall&quot;</span>, <span class="st">&quot;Specificity&quot;</span>, <span class="st">&quot;Precision&quot;</span>, <span class="st">&quot;F1&quot;</span>)]</span>
<span id="cb46-6"><a href="dynamic-time-warping.html#cb46-6"></a><span class="co">#&gt;                   Recall Specificity Precision        F1</span></span>
<span id="cb46-7"><a href="dynamic-time-warping.html#cb46-7"></a><span class="co">#&gt; Class: 1            0.84   0.9911111 0.9130435 0.8750000</span></span>
<span id="cb46-8"><a href="dynamic-time-warping.html#cb46-8"></a><span class="co">#&gt; Class: 2            0.84   0.9866667 0.8750000 0.8571429</span></span>
<span id="cb46-9"><a href="dynamic-time-warping.html#cb46-9"></a><span class="co">#&gt; Class: 3            0.96   0.9911111 0.9230769 0.9411765</span></span>
<span id="cb46-10"><a href="dynamic-time-warping.html#cb46-10"></a><span class="co">#&gt; Class: 4            0.98   0.9933333 0.9423077 0.9607843</span></span>
<span id="cb46-11"><a href="dynamic-time-warping.html#cb46-11"></a><span class="co">#&gt; Class: a            0.78   0.9733333 0.7647059 0.7722772</span></span>
<span id="cb46-12"><a href="dynamic-time-warping.html#cb46-12"></a><span class="co">#&gt; Class: b            0.76   0.9955556 0.9500000 0.8444444</span></span>
<span id="cb46-13"><a href="dynamic-time-warping.html#cb46-13"></a><span class="co">#&gt; Class: c            0.90   1.0000000 1.0000000 0.9473684</span></span>
<span id="cb46-14"><a href="dynamic-time-warping.html#cb46-14"></a><span class="co">#&gt; Class: circleLeft   0.78   0.9622222 0.6964286 0.7358491</span></span>
<span id="cb46-15"><a href="dynamic-time-warping.html#cb46-15"></a><span class="co">#&gt; Class: square       1.00   0.9977778 0.9803922 0.9900990</span></span>
<span id="cb46-16"><a href="dynamic-time-warping.html#cb46-16"></a><span class="co">#&gt; Class: triangle     0.92   0.9711111 0.7796610 0.8440367</span></span>
<span id="cb46-17"><a href="dynamic-time-warping.html#cb46-17"></a></span>
<span id="cb46-18"><a href="dynamic-time-warping.html#cb46-18"></a><span class="co"># Overall performance metrics</span></span>
<span id="cb46-19"><a href="dynamic-time-warping.html#cb46-19"></a><span class="kw">colMeans</span>(cm<span class="op">$</span>byClass[,<span class="kw">c</span>(<span class="st">&quot;Recall&quot;</span>, <span class="st">&quot;Specificity&quot;</span>,</span>
<span id="cb46-20"><a href="dynamic-time-warping.html#cb46-20"></a>                       <span class="st">&quot;Precision&quot;</span>, <span class="st">&quot;F1&quot;</span>)])</span>
<span id="cb46-21"><a href="dynamic-time-warping.html#cb46-21"></a><span class="co">#&gt;     Recall Specificity   Precision          F1 </span></span>
<span id="cb46-22"><a href="dynamic-time-warping.html#cb46-22"></a><span class="co">#&gt;  0.8760000   0.9862222   0.8824616   0.8768178 </span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:gesturesCM"></span>
<img src="images/gesturesCM.png" alt="Confusion matrix for hand gestures' predictions." width="90%" />
<p class="caption">
Figure 2.22: Confusion matrix for hand gestures’ predictions.
</p>
</div>
<p>The overall recall was <span class="math inline">\(0.87\)</span> which is not bad. From the confusion matrix, we can see that the class <em>‘a’</em> was often confused with <em>‘circleLeft’</em> and vice versa. This makes sense since both have similar motions (see Figure <a href="dynamic-time-warping.html#fig:gesturesFigure">2.19</a>). Also, <em>‘b’</em> was often confused with <em>‘circleLeft’</em>. The <em>‘square’</em> class was always correctly classified. This example demonstrated how DTW can be used with <span class="math inline">\(k\)</span>-nn to recognize hand gestures.</p>
<!-- ## Baseline Classifiers -->
<!-- ## Other Classification Models -->
<!-- ### Nearest Centroid -->
<!-- ### Naive Bayes -->
<!-- ### Neural Networks -->

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-anzulewicz2016toward">
<p>Anzulewicz, Anna, Krzysztof Sobota, and Jonathan T Delafield-Butt. 2016. “Toward the Autism Motor Signature: Gesture Patterns During Smart Tablet Gameplay Identify Children with Autism.” <em>Scientific Reports</em> 6 (1): 1–13.</p>
</div>
<div id="ref-de2006towards">
<p>De Gelder, Beatrice. 2006. “Towards the Neurobiology of Emotional Body Language.” <em>Nature Reviews Neuroscience</em> 7 (3): 242–49.</p>
</div>
<div id="ref-giorgino2009">
<p>Giorgino, Toni. 2009. “Computing and Visualizing Dynamic Time Warping Alignments in R: The dtw Package.” <em>Journal of Statistical Software</em> 31 (7): 1–24.</p>
</div>
<div id="ref-Rabiner1993">
<p>Rabiner, Lawrence, and Biing-Hwang Juang. 1993. <em>Fundamentals of Speech Recognition</em>. Prentice hall.</p>
</div>
<div id="ref-sakoe1990dynamic">
<p>Sakoe, Hiroaki, Seibi Chiba, A Waibel, and KF Lee. 1990. “Dynamic Programming Algorithm Optimization for Spoken Word Recognition.” <em>Readings in Speech Recognition</em> 159: 224.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p><a href="https://commons.wikimedia.org/wiki/File:Anscombe%27s_quartet_3.svg" class="uri">https://commons.wikimedia.org/wiki/File:Anscombe%27s_quartet_3.svg</a><a href="dynamic-time-warping.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="decision-trees.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summaryClassification.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
